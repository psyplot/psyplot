<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>psyplot.project &mdash; psyplot 1.4.2+21.g131e7dc documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/psyplot.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> psyplot
            <img src="../../_static/psyplot.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.4.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About psyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://psyplot.github.io/examples/">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Subprojects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accessors.html">xarray Accessors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">Psyplot plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command line usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../develop/index.html">Developers guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contributing to psyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/psyplot.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../todos.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">psyplot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
          <li><a href="../psyplot.html">psyplot</a> &raquo;</li>
      <li>psyplot.project</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for psyplot.project</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Project module of the psyplot Package.</span>

<span class="sd">This module contains the :class:`Project` class that serves as the main</span>
<span class="sd">part of the psyplot API. One instance of the :class:`Project` class serves as</span>
<span class="sd">coordinator of multiple plots and can be distributed into subprojects that</span>
<span class="sd">keep reference to the main project without holding all array instances</span>

<span class="sd">Furthermore this module contains an easy pyplot-like API to the current</span>
<span class="sd">subproject.&quot;&quot;&quot;</span>

<span class="c1"># Disclaimer</span>
<span class="c1"># ----------</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2021 Helmholtz-Zentrum Hereon</span>
<span class="c1"># Copyright (C) 2020-2021 Helmholtz-Zentrum Geesthacht</span>
<span class="c1"># Copyright (C) 2016-2021 University of Lausanne</span>
<span class="c1">#</span>
<span class="c1"># This file is part of psyplot and is released under the GNU LGPL-3.O license.</span>
<span class="c1"># See COPYING and COPYING.LESSER in the root of the repository for full</span>
<span class="c1"># licensing details.</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License version 3.0 as</span>
<span class="c1"># published by the Free Software Foundation.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU LGPL-3.0 license for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU LGPL-3.0 license</span>
<span class="c1"># along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">osp</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="k">as</span> <span class="n">_deepcopy</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">import_module</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">cycle</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">islice</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span><span class="p">,</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">xarray</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.figure</span> <span class="k">as</span> <span class="nn">mfig</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">psyplot</span>
<span class="kn">from</span> <span class="nn">psyplot</span> <span class="kn">import</span> <span class="n">rcParams</span><span class="p">,</span> <span class="n">get_versions</span>
<span class="kn">import</span> <span class="nn">psyplot.utils</span> <span class="k">as</span> <span class="nn">utils</span>
<span class="kn">from</span> <span class="nn">psyplot.config.rcsetup</span> <span class="kn">import</span> <span class="n">get_configdir</span><span class="p">,</span> <span class="n">psyplot_fname</span>
<span class="kn">from</span> <span class="nn">psyplot.warning</span> <span class="kn">import</span> <span class="n">warn</span><span class="p">,</span> <span class="n">critical</span>
<span class="kn">from</span> <span class="nn">psyplot.docstring</span> <span class="kn">import</span> <span class="n">docstrings</span><span class="p">,</span> <span class="n">dedent</span><span class="p">,</span> <span class="n">safe_modulo</span>
<span class="kn">import</span> <span class="nn">psyplot.data</span> <span class="k">as</span> <span class="nn">psyd</span>
<span class="kn">from</span> <span class="nn">psyplot.data</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ArrayList</span><span class="p">,</span> <span class="n">open_dataset</span><span class="p">,</span> <span class="n">open_mfdataset</span><span class="p">,</span> <span class="n">_MissingModule</span><span class="p">,</span>
    <span class="n">to_netcdf</span><span class="p">,</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">CFDecoder</span><span class="p">,</span> <span class="n">safe_list</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">psyplot.plotter</span> <span class="kn">import</span> <span class="n">unique_everseen</span><span class="p">,</span> <span class="n">Plotter</span>
<span class="kn">from</span> <span class="nn">psyplot.compat.pycompat</span> <span class="kn">import</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">getcwd</span><span class="p">,</span>
                                     <span class="n">get_default_value</span> <span class="k">as</span> <span class="n">_get_default_value</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cdo</span> <span class="kn">import</span> <span class="n">Cdo</span> <span class="k">as</span> <span class="n">_CdoBase</span><span class="p">,</span> <span class="n">CDO_PY_VERSION</span> <span class="k">as</span> <span class="n">cdo_version</span>
    <span class="n">with_cdo</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">cdo_version</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">cdo_version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]))</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">Cdo</span> <span class="o">=</span> <span class="n">_MissingModule</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">with_cdo</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">cdo_version</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">try</span><span class="p">:</span>  <span class="c1"># try import show_colormaps for convenience</span>
    <span class="kn">from</span> <span class="nn">psy_simple.colors</span> <span class="kn">import</span> <span class="n">show_colormaps</span><span class="p">,</span> <span class="n">get_cmap</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;project.import_seaborn&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">_sns</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;project.import_seaborn&#39;</span><span class="p">]:</span>
            <span class="k">raise</span>
        <span class="n">_sns</span> <span class="o">=</span> <span class="n">_MissingModule</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">_open_projects</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of open projects</span>
<span class="n">_current_project</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># current main project</span>
<span class="n">_current_subproject</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># current subproject</span>

<span class="c1"># the informations on the psyplot and plugin versions</span>
<span class="n">_versions</span> <span class="o">=</span> <span class="n">get_versions</span><span class="p">(</span><span class="n">requirements</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">_concat_dim_default</span> <span class="o">=</span> <span class="n">_get_default_value</span><span class="p">(</span><span class="n">xarray</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">,</span> <span class="s1">&#39;concat_dim&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_update_versions</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Update :attr:`_versions` with the registered plotter methods&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">pm_name</span> <span class="ow">in</span> <span class="n">plot</span><span class="o">.</span><span class="n">_plot_methods</span><span class="p">:</span>
        <span class="n">pm</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">pm_name</span><span class="p">)</span>
        <span class="n">plugin</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">_plugin</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">plugin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">plugin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_versions</span> <span class="ow">and</span>
                <span class="n">pm</span><span class="o">.</span><span class="n">module</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">):</span>
            <span class="n">_versions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_versions</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">==</span> <span class="n">plugin</span><span class="p">))</span>


<div class="viewcode-block" id="multiple_subplots"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.multiple_subplots">[docs]</a><span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;multiple_subplots&#39;</span><span class="p">)</span>
<span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
<span class="k">def</span> <span class="nf">multiple_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxplots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">for_maps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to create subplots.</span>

<span class="sd">    This function creates so many subplots on so many figures until the</span>
<span class="sd">    specified number `n` is reached.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows: int</span>
<span class="sd">        The number of subplots per rows</span>
<span class="sd">    cols: int</span>
<span class="sd">        The number of subplots per column</span>
<span class="sd">    maxplots: int</span>
<span class="sd">        The number of subplots per figure (if None, it will be row*cols)</span>
<span class="sd">    n: int</span>
<span class="sd">        number of subplots to create</span>
<span class="sd">    delete: bool</span>
<span class="sd">        If True, the additional subplots per figure are deleted</span>
<span class="sd">    for_maps: bool</span>
<span class="sd">        If True this is a simple shortcut for setting</span>
<span class="sd">        ``subplot_kw=dict(projection=cartopy.crs.PlateCarree())`` and is</span>
<span class="sd">        useful if you want to use the :attr:`~ProjectPlotter.mapplot`,</span>
<span class="sd">        :attr:`~ProjectPlotter.mapvector` or</span>
<span class="sd">        :attr:`~ProjectPlotter.mapcombined` plotting methods</span>
<span class="sd">    ``*args`` and ``**kwargs``</span>
<span class="sd">        anything that is passed to the :func:`matplotlib.pyplot.subplots`</span>
<span class="sd">        function</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        list of maplotlib.axes.SubplotBase instances&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">maxplots</span> <span class="o">=</span> <span class="n">maxplots</span> <span class="ow">or</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="nb">min</span><span class="p">(</span><span class="mf">8.</span><span class="o">*</span><span class="n">cols</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="mf">6.5</span><span class="o">*</span><span class="n">rows</span><span class="p">,</span> <span class="mi">12</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">for_maps</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
        <span class="n">subplot_kw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;subplot_kw&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">subplot_kw</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">maxplots</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[:</span><span class="n">maxplots</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iax</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxplots</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">):</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">iax</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># got a single subplot</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">ax</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">maxplots</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">delete</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ax2</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">:]:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">axes</span></div>


<span class="k">def</span> <span class="nf">_is_slice</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_only_main</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call the given `func` only from the main project&quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<span class="k">def</span> <span class="nf">_first_main</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call the given `func` with the same arguments but after the function</span>
<span class="sd">    of the main project&quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<div class="viewcode-block" id="Project"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project">[docs]</a><span class="k">class</span> <span class="nc">Project</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A manager of multiple interactive data projects&quot;&quot;&quot;</span>

    <span class="n">_main</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_registered_plotters</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1">#: registered plotter identifiers</span>

    <span class="c1">#: signal to be emiitted when the current main and/or subproject changes</span>
    <span class="n">oncpchange</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;oncpchange&#39;</span><span class="p">,</span> <span class="n">cls_signal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># block the signals of this class</span>
    <span class="n">block_signals</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">_TempBool</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`Project`. The main project of this subproject&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="nd">@main</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plotting instance of this :class:`Project`. See the</span>
<span class="sd">        :class:`ProjectPlotter` class for method documentations&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_fmtos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An iterator over formatoption objects</span>

<span class="sd">        Contains only the formatoption whose keys are in all plotters in this</span>
<span class="sd">        list&quot;&quot;&quot;</span>
        <span class="n">plotters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">plotters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">p0</span><span class="o">.</span><span class="n">_fmtos</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
            <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">plotters</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_csp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean that is True if the project is the current subproject&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">_current_subproject</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean that is True if the project is the current main project&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">_current_project</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">figs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A mapping from figures to data objects with the plotter in this</span>
<span class="sd">        figure&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">DefaultOrderedDict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ret</span><span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A mapping from axes to data objects with the plotter in this axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">DefaultOrderedDict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ret</span><span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`bool`. True if this :class:`Project` is a main project&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:class:`logging.Logger` of this instance&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">logger</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Initializing...&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span>

    <span class="nd">@logger</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">with_plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">with_plotter</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">with_plotter</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">with_plotter</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">ArrayList</span><span class="o">.</span><span class="n">with_plotter</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arr_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Names of the arrays (!not of the variables!) in this list</span>

<span class="sd">        This attribute can be set with an iterable of unique names to change</span>
<span class="sd">        the array names of the data objects in this list.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@arr_names</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">arr_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Got </span><span class="si">%i</span><span class="s2"> unique array names for </span><span class="si">%i</span><span class="s2"> data objects!&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">arr_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_names</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot rename arrays because there are duplicates with the &quot;</span>
                <span class="s2">&quot;main project: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
                        <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">arr_names</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr_names</span><span class="p">)),</span> <span class="p">))</span>
        <span class="k">for</span> <span class="n">arr</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span> <span class="ow">is</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">onupdate</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plotters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of all the plotters in this instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_plotter</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A mapping from dataset numbers to datasets in this list&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_ds_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span><span class="n">ds_description</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">])))}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dsnames_map</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary from the dataset numbers in this list to their</span>
<span class="sd">        filenames&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;fname&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_ds_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span>
                <span class="n">ds_description</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;fname&#39;</span><span class="p">]),</span> <span class="n">ds_description</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fname&#39;</span><span class="p">}))}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dsnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The set of dataset names in this instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dsnames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">())</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(ArrayList.parameters)s</span>
<span class="sd">        main: Project</span>
<span class="sd">            The main project this subproject belongs to (or None if this</span>
<span class="sd">            project is the main project)</span>
<span class="sd">        num: int</span>
<span class="sd">            The number of the project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot</span> <span class="o">=</span> <span class="n">ProjectPlotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ds_counter</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_signals</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project._register_plotter&#39;</span><span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">_register_plotter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span>
                          <span class="n">plotter_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a plotter in the :class:`Project` class to easy access it</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        identifier: str</span>
<span class="sd">            Name of the attribute that is used to filter for the instances</span>
<span class="sd">            belonging to this plotter</span>
<span class="sd">        module: str</span>
<span class="sd">            The module from where to import the `plotter_name`</span>
<span class="sd">        plotter_name: str</span>
<span class="sd">            The name of the plotter class in `module`</span>
<span class="sd">        plotter_cls: type</span>
<span class="sd">            The imported class of `plotter_name`. If None, it will be imported</span>
<span class="sd">            when it is needed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotter_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># plotter has already been imported</span>
            <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">plotter_cls</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">import_module</span><span class="p">(</span><span class="n">module</span><span class="p">),</span> <span class="n">plotter_name</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_x</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;List of data arrays that are plotted by :class:`</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">`&quot;</span>
            <span class="s2">&quot; plotters&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">)))</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_registered_plotters</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">)</span>

<div class="viewcode-block" id="Project.disable"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.disable">[docs]</a>    <span class="k">def</span> <span class="nf">disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disables the plotters in this list&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
                <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Project.enable"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.enable">[docs]</a>    <span class="k">def</span> <span class="nf">enable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
                <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project._load_preset&#39;</span><span class="p">,</span>
                              <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Notes&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_load_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a preset from disk</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        preset: str or dict</span>
<span class="sd">            The filename or identifier of a preset. If the given `preset` is</span>
<span class="sd">            the path to an existing yaml file, it will be loaded. Otherwise we</span>
<span class="sd">            look up the `preset` in the psyplot configuration directory (see</span>
<span class="sd">            :func:`~psyplot.config.rcsetup.get_configdir`).</span>
<span class="sd">            If a dictionary is provided, we assume that this is the preset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The loaded preset</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        An identifier is the filename without extension. If you want to list</span>
<span class="sd">        the available presets, run ``psyplot -lp`` from the command-line&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">preset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">_resolve_preset_path</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;presets.trusted&#39;</span><span class="p">]:</span>
                <span class="n">loader</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">Loader</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loader</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">yaml</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">ConstructorError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">note</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                        <span class="s1">&#39; You might want to add it to the trusted presets &#39;</span>
                        <span class="s1">&#39;via</span><span class="se">\n\n</span><span class="s1">psy.rcParams[&quot;presets.trusted&quot;].append(&quot;</span><span class="si">{}</span><span class="s1">&quot;)</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;and run this method again. To permanently store &#39;</span>
                        <span class="s1">&#39;this preset, edit the file at</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1"> &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">path</span><span class="p">,</span> <span class="n">psyplot_fname</span><span class="p">())</span>
                    <span class="k">raise</span>

        <span class="k">return</span> <span class="n">config</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_resolve_preset_path</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">osp</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">preset</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">preset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">confdir</span> <span class="o">=</span> <span class="n">get_configdir</span><span class="p">()</span>
            <span class="n">presets_dir</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">confdir</span><span class="p">,</span> <span class="s1">&#39;presets&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">osp</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">presets_dir</span><span class="p">,</span> <span class="n">preset</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">presets_dir</span><span class="p">,</span> <span class="n">preset</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">osp</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">presets_dir</span><span class="p">,</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.yml&#39;</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">presets_dir</span><span class="p">,</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.yml&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">if_exists</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Could not find a preset with name </span><span class="si">{</span><span class="n">preset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">preset</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.yml&#39;</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">presets_dir</span><span class="p">,</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.yml&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">preset</span>

<div class="viewcode-block" id="Project.load_preset"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.load_preset">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">load_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a preset from disk and apply it to the open project.</span>

<span class="sd">        This method loads a preset and updates the corresponding plots</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Project._load_preset.parameters)s</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any other parameter that shall be passed to the</span>
<span class="sd">            :meth:`~psyplot.data.ArrayList.update` method</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        %(Project._load_preset.notes)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
        <span class="n">plotmethods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">_plot_methods</span>
        <span class="n">pm_config</span><span class="p">,</span> <span class="n">defaults</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sort_kwargs</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">plotmethods</span><span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="n">plotmethods</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">pm</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">is_imported</span><span class="p">:</span>
                    <span class="n">sp</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pm</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sp</span><span class="p">:</span>
                        <span class="n">valid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
                        <span class="n">fmts</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">}</span>
                        <span class="n">fmts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pm</span><span class="p">,</span> <span class="p">{}))</span>
                        <span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmts</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_update</span><span class="p">()</span></div>

<div class="viewcode-block" id="Project.extract_fmts_from_preset"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.extract_fmts_from_preset">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_fmts_from_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">plotmethod</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract the formatoptions for a plotmethod from a given preset</span>

<span class="sd">        This method takes the preset and extracts the formatoptions valid for</span>
<span class="sd">        the given plotmethod</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Project._load_preset.parameters)s</span>
<span class="sd">        plotmethod: str</span>
<span class="sd">            The plotmethod to use&quot;&quot;&quot;</span>
        <span class="n">preset</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">_load_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plotmethod</span><span class="o">.</span><span class="n">_method</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">plotmethod</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">plotmethod</span>
            <span class="n">plotmethod</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">_method</span>

        <span class="n">plotmethods</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">_plot_methods</span>
        <span class="n">pm_config</span><span class="p">,</span> <span class="n">defaults</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sort_kwargs</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">plotmethods</span><span class="p">)</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
        <span class="n">fmts</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">}</span>
        <span class="n">fmts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">plotmethod</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="k">return</span> <span class="n">fmts</span></div>


<div class="viewcode-block" id="Project.save_preset"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.save_preset">[docs]</a>    <span class="k">def</span> <span class="nf">save_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_defaults</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the formatoptions of this project as a preset</span>

<span class="sd">        This method takes the formatoptions in the plotters of this project and</span>
<span class="sd">        saves it as a preset file&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">include</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">plotters</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span>
            <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">plotters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">plotter</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">include_defaults</span> <span class="k">else</span> <span class="n">fmto</span><span class="o">.</span><span class="n">changed</span>

        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">preset</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">yaml</span><span class="o">.</span><span class="n">Loader</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">preset</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">plotters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span>

        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">include</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">plotters</span><span class="p">):</span>
                <span class="n">preset</span><span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">value</span>

        <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">_plot_methods</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">pm</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">is_imported</span><span class="p">:</span>
                <span class="n">sp</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pm</span><span class="p">)</span>
                <span class="n">plotters</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">plotters</span>
                <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">preset</span> <span class="ow">and</span> <span class="n">include</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">plotters</span><span class="p">):</span>
                        <span class="n">preset</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">pm</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="n">preset</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_preset_path</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">osp</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">preset</span></div>

<div class="viewcode-block" id="Project.extend"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.extend">[docs]</a>    <span class="nd">@_first_main</span>
    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">len0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">len0</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_csp</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cmp</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">extend</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="o">.</span><span class="n">extend</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Project.append"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.append">[docs]</a>    <span class="nd">@_first_main</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">len0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">len0</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_csp</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cmp</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">append</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="o">.</span><span class="n">append</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="fm">__call__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="o">.</span><span class="fm">__call__</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Project.close"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.close">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.close&#39;</span><span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close this project instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figs: bool</span>
<span class="sd">            Close the figures</span>
<span class="sd">        data: bool</span>
<span class="sd">            delete the arrays from the (main) project</span>
<span class="sd">        ds: bool</span>
<span class="sd">            If True, close the dataset as well</span>
<span class="sd">        remove_only: bool</span>
<span class="sd">            If True and `figs` is True, the figures are not closed but the</span>
<span class="sd">            plotters are removed&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">close_ds</span> <span class="o">=</span> <span class="n">ds</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="k">if</span> <span class="n">figs</span> <span class="ow">and</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">remove_only</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">fmto</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                            <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
                <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># arr not in list</span>
                        <span class="k">pass</span>
            <span class="k">if</span> <span class="n">close_ds</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span>
                               <span class="n">arr</span><span class="o">.</span><span class="n">_get_ds_descriptions</span><span class="p">(</span>
                                    <span class="n">arr</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span><span class="n">ds_description</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">],</span>
                                                   <span class="n">standardize_dims</span><span class="o">=</span><span class="kc">False</span><span class="p">)))]:</span>
                        <span class="n">ds</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="ow">and</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">scp</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cmp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">is_cmp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">)</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;multiple_subplots.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ArrayList.from_dataset.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_kwargs</span><span class="p">(</span><span class="s1">&#39;ArrayList.from_dataset.other_parameters&#39;</span><span class="p">,</span>
                             <span class="n">kwargs</span><span class="o">=</span><span class="s1">&#39;kwargs&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;xarray.open_mfdataset.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;concat_dim&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Project._load_preset.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;preset&#39;</span><span class="p">)</span>

    <span class="nd">@_only_main</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project._add_data&#39;</span><span class="p">,</span>
                              <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;Other Parameters&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Returns&#39;</span><span class="p">])</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="p">{},</span> <span class="n">make_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mf_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">share</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enable_post</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">concat_dim</span><span class="o">=</span><span class="n">_concat_dim_default</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract data from a dataset and visualize it with the given plotter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plotter_cls: type</span>
<span class="sd">            The subclass of :class:`psyplot.plotter.Plotter` to use for</span>
<span class="sd">            visualization</span>
<span class="sd">        filename_or_obj: filename, :class:`xarray.Dataset` or data store</span>
<span class="sd">            The object (or file name) to open. If not a dataset, the</span>
<span class="sd">            :func:`psyplot.data.open_dataset` will be used to open a dataset</span>
<span class="sd">        fmt: dict</span>
<span class="sd">            Formatoptions that shall be when initializing the plot (you can</span>
<span class="sd">            however also specify them as extra keyword arguments)</span>
<span class="sd">        make_plot: bool</span>
<span class="sd">            If True, the data is plotted at the end. Otherwise you have to</span>
<span class="sd">            call the :meth:`psyplot.plotter.Plotter.initialize_plot` method or</span>
<span class="sd">            the :meth:`psyplot.plotter.Plotter.reinit` method by yourself</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        mf_mode: bool</span>
<span class="sd">            If True, the :func:`psyplot.open_mfdataset` method is used.</span>
<span class="sd">            Otherwise we use the :func:`psyplot.open_dataset` method which can</span>
<span class="sd">            open only one single dataset</span>
<span class="sd">        ax: None, tuple (x, y[, z]) or (list of) matplotlib.axes.Axes</span>
<span class="sd">            Specifies the subplots on which to plot the new data objects.</span>

<span class="sd">            - If None, a new figure will be created for each created plotter</span>
<span class="sd">            - If tuple (x, y[, z]), `x` specifies the number of rows, `y` the</span>
<span class="sd">              number of columns and the optional third parameter `z` the</span>
<span class="sd">              maximal number of subplots per figure.</span>
<span class="sd">            - If :class:`matplotlib.axes.Axes` (or list of those, e.g. created</span>
<span class="sd">              by the :func:`matplotlib.pyplot.subplots` function), the data</span>
<span class="sd">              will be plotted on these subplots</span>
<span class="sd">        %(open_dataset.parameters.engine)s</span>
<span class="sd">        %(multiple_subplots.parameters.delete)s</span>
<span class="sd">        share: bool, fmt key or list of fmt keys</span>
<span class="sd">            Determines whether the first created plotter shares it&#39;s</span>
<span class="sd">            formatoptions with the others. If True, all formatoptions are</span>
<span class="sd">            shared. Strings or list of strings specify the keys to share.</span>
<span class="sd">        clear: bool</span>
<span class="sd">            If True, axes are cleared before making the plot. This is only</span>
<span class="sd">            necessary if the `ax` keyword consists of subplots with projection</span>
<span class="sd">            that differs from the one that is needed</span>
<span class="sd">        enable_post: bool</span>
<span class="sd">            If True, the :attr:`~psyplot.plotter.Plotter.post` formatoption is</span>
<span class="sd">            enabled and post processing scripts are allowed. If ``None``, this</span>
<span class="sd">            parameter is set to True if there is a value given for the `post`</span>
<span class="sd">            formatoption in `fmt` or `kwargs`</span>
<span class="sd">        %(xarray.open_mfdataset.parameters.concat_dim)s</span>
<span class="sd">            This parameter only does have an effect if `mf_mode` is True.</span>
<span class="sd">        load: bool</span>
<span class="sd">            If True, load the complete dataset into memory before plotting.</span>
<span class="sd">            This might be useful if the data of other variables in the dataset</span>
<span class="sd">            has to be accessed multiple times, e.g. for unstructured grids.</span>
<span class="sd">        %(ArrayList.from_dataset.parameters.no_base)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ArrayList.from_dataset.other_parameters.no_args_kwargs)s</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any other dimension or formatoption that shall be passed to `dims`</span>
<span class="sd">            or `fmt` respectively.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Project</span>
<span class="sd">            The subproject that contains the new (visualized) data array&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span> <span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mf_mode</span><span class="p">:</span>
                <span class="n">filename_or_obj</span> <span class="o">=</span> <span class="n">open_mfdataset</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span>
                                                 <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
                                                 <span class="n">concat_dim</span><span class="o">=</span><span class="n">concat_dim</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename_or_obj</span> <span class="o">=</span> <span class="n">open_dataset</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span>
                                               <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">load</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="n">filename_or_obj</span>
            <span class="n">filename_or_obj</span> <span class="o">=</span> <span class="n">filename_or_obj</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
            <span class="n">old</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">fmt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
        <span class="n">possible_fmts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
        <span class="n">additional_fmt</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sort_kwargs</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="p">,</span> <span class="n">possible_fmts</span><span class="p">)</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_fmt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">enable_post</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">enable_post</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span>
        <span class="c1"># create the subproject</span>
        <span class="n">sub_project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">sub_project</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">sub_project</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">sub_project</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span><span class="p">)</span>
        <span class="c1"># create the subplots</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_sample_projection</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">multiple_subplots</span><span class="p">(</span>
                <span class="o">*</span><span class="n">ax</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_project</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">proj</span><span class="p">}))</span>
        <span class="k">elif</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">SubplotBase</span><span class="p">,</span>
                                           <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">)):</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">clear</span> <span class="o">=</span> <span class="n">clear</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">proj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">sub_project</span><span class="p">:</span>
            <span class="n">plotter_cls</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">make_plot</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">share</span><span class="p">)</span> <span class="ow">and</span> <span class="n">make_plot</span><span class="p">),</span>
                        <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">,</span>
                        <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable_post</span><span class="o">=</span><span class="n">enable_post</span><span class="p">,</span> <span class="o">**</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">share</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">share</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">share</span> <span class="o">=</span> <span class="n">possible_fmts</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="n">share</span> <span class="o">=</span> <span class="p">[</span><span class="n">share</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">share</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">share</span><span class="p">)</span>
            <span class="n">sub_project</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">share</span><span class="p">(</span>
                <span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">sub_project</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span> <span class="n">keys</span><span class="o">=</span><span class="n">share</span><span class="p">,</span>
                <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">make_plot</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">sub_project</span><span class="p">:</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">reinit</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;auto_draw&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">sub_project</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;auto_show&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sub_project</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">scp</span><span class="p">(</span><span class="n">sub_project</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sub_project</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Overwrites lists __getitem__ by returning subproject if `key` is a</span>
<span class="sd">        slice&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="c1"># return a new project</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># return the item</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">PY2</span><span class="p">:</span>  <span class="c1"># for compatibility to python 2.7</span>
        <span class="k">def</span> <span class="nf">__getslice__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># overwritte to return a subproject</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Project.show"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.show">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">show</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Shows all open figures&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;join_dicts.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;delimiter&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;join_dicts.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;keep_all&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.joined_attrs"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.joined_attrs">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.joined_attrs&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">with_indent</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">joined_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">enhanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">keep_all</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Join the attributes of the arrays in this project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(join_dicts.parameters.delimiter)s</span>
<span class="sd">        enhanced: bool</span>
<span class="sd">            If True, the :meth:`psyplot.plotter.Plotter.get_enhanced_attrs`</span>
<span class="sd">            method is used, otherwise the :attr:`xarray.DataArray.attrs`</span>
<span class="sd">            attribute is used.</span>
<span class="sd">        plot_data: bool</span>
<span class="sd">            It True, use the :attr:`psyplot.plotter.Plotter.plot_data`</span>
<span class="sd">            attribute of the plotters rather than the raw data in this project</span>
<span class="sd">        %(join_dicts.parameters.keep_all)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from the attribute to the joined attributes which are</span>
<span class="sd">            either strings or (if there is only one attribute value), the</span>
<span class="sd">            data type of the corresponding value&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">enhanced</span><span class="p">:</span>
            <span class="n">all_attrs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">get_enhanced_attrs</span><span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="s1">&#39;plot_data&#39;</span> <span class="k">if</span> <span class="n">plot_data</span> <span class="k">else</span> <span class="s1">&#39;data&#39;</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plot_data</span><span class="p">:</span>
                <span class="n">all_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="o">.</span><span class="n">attrs</span>
                             <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">all_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">join_dicts</span><span class="p">(</span><span class="n">all_attrs</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                                <span class="n">keep_all</span><span class="o">=</span><span class="n">keep_all</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.format_string"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.format_string">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.format_string&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">with_indent</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">format_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">use_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">format_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format a string with the attributes in this project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s: str</span>
<span class="sd">            The string that is subject to be formatted</span>
<span class="sd">        use_time: bool</span>
<span class="sd">            If True, formatting strings for the</span>
<span class="sd">            :meth:`datetime.datetime.strftime` are expected to be found in</span>
<span class="sd">            `output` (e.g. ``&#39;%%m&#39;``, ``&#39;%%Y&#39;``, etc.). If so, other formatting</span>
<span class="sd">            strings must be escaped by double ``&#39;%%&#39;`` (e.g. ``&#39;%%%i&#39;``</span>
<span class="sd">            instead of (``&#39;%%i&#39;``))</span>
<span class="sd">        format_args: tuple</span>
<span class="sd">            A tuple of arguments that shall be inserted in `s` via</span>
<span class="sd">            ``s %% format_args``. (There will be no error, when this fails!)</span>
<span class="sd">        %(Project.joined_attrs.parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The formatted string `s`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joined_attrs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_time</span><span class="p">:</span>
            <span class="n">tnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tnames</span><span class="p">()</span>
            <span class="n">tname</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">tnames</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tnames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">time</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">tname</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># assume a valid datetime.datetime instance</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">format_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">safe_modulo</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">format_args</span><span class="p">,</span> <span class="n">print_warning</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">safe_modulo</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Project.format_string.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;use_time&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.export"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.export">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">with_indent</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">concat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">close_pdf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">use_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exports the figures of the project to one or more image files</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        output: str, iterable or matplotlib.backends.backend_pdf.PdfPages</span>
<span class="sd">            if string or list of strings, those define the names of the output</span>
<span class="sd">            files. Otherwise you may provide an instance of</span>
<span class="sd">            :class:`matplotlib.backends.backend_pdf.PdfPages` to save the</span>
<span class="sd">            figures in it.</span>
<span class="sd">            If string (or iterable of strings), attribute names in the</span>
<span class="sd">            xarray.DataArray.attrs attribute as well as index dimensions</span>
<span class="sd">            are replaced by the respective value (see examples below).</span>
<span class="sd">            Furthermore a single format string without key (e.g. %%i, %%s, %%d,</span>
<span class="sd">            etc.) is replaced by a counter.</span>
<span class="sd">        tight: bool</span>
<span class="sd">            If True, it is tried to figure out the tight bbox of the figure</span>
<span class="sd">            (same as bbox_inches=&#39;tight&#39;)</span>
<span class="sd">        concat: bool</span>
<span class="sd">            if True and the output format is `pdf`, all figures are</span>
<span class="sd">            concatenated into one single pdf</span>
<span class="sd">        close_pdf: bool or None</span>
<span class="sd">            If True and the figures are concatenated into one single pdf,</span>
<span class="sd">            the resulting pdf instance is closed. If False it remains open.</span>
<span class="sd">            If None and `output` is a string, it is the same as</span>
<span class="sd">            ``close_pdf=True``, if None and `output` is neither a string nor an</span>
<span class="sd">            iterable, it is the same as ``close_pdf=False``</span>
<span class="sd">        %(Project.format_string.parameters.use_time)s</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any valid keyword for the :func:`matplotlib.pyplot.savefig`</span>
<span class="sd">            function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.backends.backend_pdf.PdfPages or None</span>
<span class="sd">            a PdfPages instance if output is a string and close_pdf is False,</span>
<span class="sd">            otherwise None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Simply save all figures into one single pdf::</span>

<span class="sd">            &gt;&gt;&gt; p = psy.gcp()</span>
<span class="sd">            &gt;&gt;&gt; p.export(&#39;my_plots.pdf&#39;)</span>

<span class="sd">        Save all figures into separate pngs with increasing numbers (e.g.</span>
<span class="sd">        ``&#39;my_plots_1.png&#39;``)::</span>

<span class="sd">            &gt;&gt;&gt; p.export(&#39;my_plots_%%i.png&#39;)</span>

<span class="sd">        Save all figures into separate pngs with the name of the variables</span>
<span class="sd">        shown in each figure (e.g. ``&#39;my_plots_t2m.png&#39;``)::</span>

<span class="sd">            &gt;&gt;&gt; p.export(&#39;my_plots_%%(name)s.png&#39;)</span>

<span class="sd">        Save all figures into separate pngs with the name of the variables</span>
<span class="sd">        shown in each figure and with increasing numbers (e.g.</span>
<span class="sd">        ``&#39;my_plots_1_t2m.png&#39;``)::</span>

<span class="sd">            &gt;&gt;&gt; p.export(&#39;my_plots_%%i_%%(name)s.png&#39;)</span>

<span class="sd">        Specify the names for each figure directly via a list::</span>

<span class="sd">            &gt;&gt;&gt; p.export([&#39;my_plots1.pdf&#39;, &#39;my_plots2.pdf&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
        <span class="k">if</span> <span class="n">tight</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bbox_inches&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>

        <span class="n">not_enough_files_warnings</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Not enough output files specified! </span><span class="si">%i</span><span class="s2"> figures are open &quot;</span>
            <span class="s2">&quot;but only </span><span class="si">%i</span><span class="s2"> filenames have been given! This will cause &quot;</span>
            <span class="s2">&quot;that some figures may be overwritten after being &quot;</span>
            <span class="s2">&quot;exported! Use a pdf instead if you want to save all &quot;</span>
            <span class="s2">&quot;figures or include a &#39;</span><span class="si">%%</span><span class="s2">i&#39; string in the filename to &quot;</span>
            <span class="s2">&quot;avoid duplicates.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>  <span class="c1"># a single string</span>
            <span class="n">out_fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">output</span><span class="p">))[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">out_fmt</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span> <span class="ow">and</span> <span class="n">concat</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">use_time</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">pdf</span> <span class="o">=</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">:</span>
                    <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">close_pdf</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">close_pdf</span><span class="p">:</span>
                    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pdf</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">output</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>  <span class="c1"># a list of strings</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">format_string</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">use_time</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                          <span class="nb">zip</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">output</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
                <span class="n">warn</span><span class="p">(</span><span class="n">not_enough_files_warnings</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">)))</span>
            <span class="n">output</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">fig</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># an instances of matplotlib.backends.backend_pdf.PdfPages</span>
            <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">close_pdf</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Plotter.share.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;Plotter.share.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="s1">&#39;plotters&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.share"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.share">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Share the formatoptions of one plotter with all the others</span>

<span class="sd">        This method shares specified formatoptions from `base` with all the</span>
<span class="sd">        plotters in this instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        base: None, Plotter, xarray.DataArray, InteractiveList, or list of them</span>
<span class="sd">            The source of the plotter that shares its formatoptions with the</span>
<span class="sd">            others. It can be None (then the first instance in this project</span>
<span class="sd">            is used), a :class:`~psyplot.plotter.Plotter` or any data object</span>
<span class="sd">            with a *psy* attribute. If `by` is not None, then it is expected</span>
<span class="sd">            that `base` is a list of data objects for each figure/axes</span>
<span class="sd">        %(Plotter.share.parameters.keys)s</span>
<span class="sd">        by: {&#39;fig&#39;, &#39;figure&#39;, &#39;ax&#39;, &#39;axes&#39;}</span>
<span class="sd">            Share the formatoptions only with the others on the same</span>
<span class="sd">            ``&#39;figure&#39;`` or the same ``&#39;axes&#39;``. In this case, base must either</span>
<span class="sd">            be ``None`` or a list of the types specified for `base`</span>
<span class="sd">        %(Plotter.share.parameters.no_keys|plotters)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        psyplot.plotter.share&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s1">&#39;psy&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">Plotter</span><span class="p">):</span>
                    <span class="n">base</span> <span class="o">=</span> <span class="p">[</span><span class="n">base</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">by</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">]:</span>
                    <span class="n">bases</span> <span class="o">=</span> <span class="p">{</span><span class="n">ax</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span>
                        <span class="n">Project</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">)}</span>
                <span class="k">elif</span> <span class="n">by</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">]:</span>
                    <span class="n">bases</span> <span class="o">=</span> <span class="p">{</span><span class="n">fig</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">fig</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span>
                        <span class="n">Project</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="o">.</span><span class="n">figs</span><span class="p">)}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;*by* must be out of {&#39;fig&#39;, &#39;figure&#39;, &#39;ax&#39;, &#39;axes&#39;}. &quot;</span>
                        <span class="s2">&quot;Not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bases</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">projects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;axes&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs</span>
            <span class="k">for</span> <span class="n">obj</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">projects</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">p</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="n">bases</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plotters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">plotters</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="n">base</span> <span class="o">=</span> <span class="n">plotters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">plotters</span> <span class="o">=</span> <span class="n">plotters</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">Plotter</span><span class="p">):</span>
                <span class="n">base</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s1">&#39;psy&#39;</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span> <span class="s1">&#39;plotter&#39;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
            <span class="n">base</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="n">plotters</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.unshare"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.unshare">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">unshare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unshare the formatoptions of all the plotters in this instance</span>

<span class="sd">        This method uses the :meth:`psyplot.plotter.Plotter.unshare_me`</span>
<span class="sd">        method to release the specified formatoptions in `keys`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.unshare_me.parameters)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        psyplot.plotter.Plotter.unshare, psyplot.plotter.Plotter.unshare_me&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotters</span><span class="p">:</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">unshare_me</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ArrayList.array_info.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="s1">&#39;copy&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.save_project"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.save_project">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.save_project&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">save_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pwd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pack</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save this project to a file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname: str or None</span>
<span class="sd">            If None, the dictionary will be returned. Otherwise the necessary</span>
<span class="sd">            information to load this project via the :meth:`load` method is</span>
<span class="sd">            saved to `fname` using the :mod:`pickle` module</span>
<span class="sd">        pwd: str or None, optional</span>
<span class="sd">            Path to the working directory from where the data can be imported.</span>
<span class="sd">            If None and `fname` is the path to a file, `pwd` is set to the</span>
<span class="sd">            directory of this file. Otherwise the current working directory is</span>
<span class="sd">            used.</span>
<span class="sd">        pack: bool</span>
<span class="sd">            If True, all datasets are packed into the folder of `fname`</span>
<span class="sd">            and will be used if the data is loaded</span>
<span class="sd">        %(ArrayList.array_info.parameters.no_pwd|copy)s</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        You can also store the entire data in the pickled file by setting</span>
<span class="sd">        ``ds_description={&#39;ds&#39;}``&quot;&quot;&quot;</span>
        <span class="c1"># store the figure informatoptions and array informations</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pwd</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pack</span><span class="p">:</span>
            <span class="n">pwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pack</span> <span class="ow">and</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">target_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">target_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">tmp_it</span><span class="p">():</span>
                <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span>
                        <span class="nb">dir</span><span class="o">=</span><span class="n">target_dir</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>

            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;paths&#39;</span><span class="p">,</span> <span class="n">tmp_it</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;copy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">_update_versions</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;figs&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_ProjectLoader</span><span class="o">.</span><span class="n">inspect_figure</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs</span><span class="p">)),</span>
               <span class="s1">&#39;arrays&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span><span class="n">pwd</span><span class="o">=</span><span class="n">pwd</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
               <span class="s1">&#39;versions&#39;</span><span class="p">:</span> <span class="n">_deepcopy</span><span class="p">(</span><span class="n">_versions</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">pack</span> <span class="ow">and</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># we get the filenames out of the results and copy the datasets</span>
            <span class="c1"># there. After that we check the filenames again and force them</span>
            <span class="c1"># to the desired directory</span>
            <span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copyfile</span>
            <span class="n">fnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dsnames</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">]))</span>
            <span class="n">alternative_paths</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;alternative_paths&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">counters</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_rel_paths&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">get_path</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">target_dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">get_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span>
            <span class="k">for</span> <span class="n">ds_fname</span> <span class="ow">in</span> <span class="n">unique_everseen</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">alternative_paths</span><span class="p">,</span> <span class="n">fnames</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">ds_fname</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_remote_url</span><span class="p">(</span><span class="n">ds_fname</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">dst_file</span> <span class="o">=</span> <span class="n">alternative_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">ds_fname</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span>
                        <span class="n">ds_fname</span><span class="p">)))</span>
                <span class="n">orig_dst_file</span> <span class="o">=</span> <span class="n">dst_file</span>
                <span class="k">if</span> <span class="n">counters</span><span class="p">[</span><span class="n">dst_file</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst_file</span><span class="p">)</span> <span class="ow">or</span>
                        <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">samefile</span><span class="p">(</span><span class="n">ds_fname</span><span class="p">,</span> <span class="n">dst_file</span><span class="p">)):</span>
                    <span class="n">dst_file</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">dst_file</span><span class="p">)</span>
                    <span class="n">dst_file</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counters</span><span class="p">[</span><span class="n">orig_dst_file</span><span class="p">])</span> <span class="o">+</span> <span class="n">ext</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst_file</span><span class="p">)</span> <span class="ow">or</span>
                        <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">samefile</span><span class="p">(</span><span class="n">ds_fname</span><span class="p">,</span> <span class="n">dst_file</span><span class="p">)):</span>
                    <span class="n">copyfile</span><span class="p">(</span><span class="n">ds_fname</span><span class="p">,</span> <span class="n">dst_file</span><span class="p">)</span>
                    <span class="n">counters</span><span class="p">[</span><span class="n">orig_dst_file</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">alternative_paths</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">ds_fname</span><span class="p">,</span> <span class="n">get_path</span><span class="p">(</span><span class="n">dst_file</span><span class="p">))</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span>
                <span class="n">pwd</span><span class="o">=</span><span class="n">pwd</span><span class="p">,</span> <span class="n">alternative_paths</span><span class="o">=</span><span class="n">alternative_paths</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># store the plotter settings</span>
        <span class="k">for</span> <span class="n">arr</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">])):</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;ax&#39;</span><span class="p">:</span> <span class="n">_ProjectLoader</span><span class="o">.</span><span class="n">inspect_axes</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="p">),</span>
                <span class="s1">&#39;fmt&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">value2pickle</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">plotter</span><span class="p">},</span>
                <span class="s1">&#39;cls&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
                <span class="s1">&#39;shared&#39;</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">][</span><span class="s1">&#39;ax&#39;</span><span class="p">][</span><span class="s1">&#39;shared&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span>
                <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">ax</span> <span class="o">==</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">][</span><span class="s1">&#39;ax&#39;</span><span class="p">][</span><span class="s1">&#39;sharex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span>
                     <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">ax</span> <span class="o">==</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">][</span><span class="s1">&#39;ax&#39;</span><span class="p">][</span><span class="s1">&#39;sharey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span>
                     <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">ax</span> <span class="o">==</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">shared</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">][</span><span class="s1">&#39;shared&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">plotter</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="p">:</span>
                    <span class="n">shared</span><span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span>
                                        <span class="k">for</span> <span class="n">other_fmto</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Project.keys"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.keys">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the available formatoptions in this project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s&quot;&quot;&quot;</span>

        <span class="k">class</span> <span class="nc">TmpClass</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">TmpClass</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">fmto</span><span class="p">)(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TmpClass</span><span class="o">.</span><span class="n">show_keys</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.summaries"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.summaries">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the available formatoptions and their summaries in this project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s&quot;&quot;&quot;</span>

        <span class="k">class</span> <span class="nc">TmpClass</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">TmpClass</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">fmto</span><span class="p">)(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TmpClass</span><span class="o">.</span><span class="n">show_summaries</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.docs"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.docs">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the available formatoptions in this project and their full docu</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s&quot;&quot;&quot;</span>

        <span class="k">class</span> <span class="nc">TmpClass</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">TmpClass</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">fmto</span><span class="p">)(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TmpClass</span><span class="o">.</span><span class="n">show_docs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Project.from_dataset"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.from_dataset">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">with_indent</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">from_dataset</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct an ArrayList instance from an existing base dataset</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(ArrayList.from_dataset.parameters)s</span>
<span class="sd">        main: Project</span>
<span class="sd">            The main project that this project corresponds to</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ArrayList.from_dataset.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Project</span>
<span class="sd">            The newly created project instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">main</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="n">main</span>
            <span class="n">main</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ArrayList.from_dict.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;pwd&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Project._add_data.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;make_plot&#39;</span><span class="p">)</span>
    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Project._add_data.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.load_project"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.load_project">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.load_project&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">load_project</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">make_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative_axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_post</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">new_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">clear</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a project from a file or dict</span>

<span class="sd">        This classmethod allows to load a project that has been stored using</span>
<span class="sd">        the :meth:`save_project` method and reads all the data and creates the</span>
<span class="sd">        figures.</span>

<span class="sd">        Since the data is stored in external files when saving a project,</span>
<span class="sd">        make sure that the data is accessible under the relative paths</span>
<span class="sd">        as stored in the file `fname` or from the current working directory</span>
<span class="sd">        if `fname` is a dictionary. Alternatively use the `alternative_paths`</span>
<span class="sd">        parameter or the `pwd` parameter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname: str or dict</span>
<span class="sd">            The string might be the path to a file created with the</span>
<span class="sd">            :meth:`save_project` method, or it might be a dictionary from this</span>
<span class="sd">            method</span>
<span class="sd">        %(InteractiveBase.parameters.auto_update)s</span>
<span class="sd">        %(Project._add_data.parameters.make_plot)s</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        alternative_axes: dict, None or list</span>
<span class="sd">            alternative axes instances to use</span>

<span class="sd">            - If it is None, the axes and figures from the saving point will be</span>
<span class="sd">              reproduced.</span>
<span class="sd">            - a dictionary should map from array names in the created</span>
<span class="sd">              project to matplotlib axes instances</span>
<span class="sd">            - a list should contain axes instances that will be used for</span>
<span class="sd">              iteration</span>
<span class="sd">        main: bool, optional</span>
<span class="sd">            If True, a new main project is created and returned.</span>
<span class="sd">            Otherwise (by default default) the data is added to the current</span>
<span class="sd">            main project.</span>
<span class="sd">        encoding: str</span>
<span class="sd">            The encoding to use for loading the project. If None, it is</span>
<span class="sd">            automatically determined by pickle. Note: Set this to ``&#39;latin1&#39;``</span>
<span class="sd">            if using a project created with python2 on python3.</span>
<span class="sd">        enable_post: bool</span>
<span class="sd">            If True, the :attr:`~psyplot.plotter.Plotter.post` formatoption is</span>
<span class="sd">            enabled and post processing scripts are allowed. Do only set this</span>
<span class="sd">            parameter to ``True`` if you know you can trust the information in</span>
<span class="sd">            `fname`</span>
<span class="sd">        new_fig: bool</span>
<span class="sd">            If True (default) and `alternative_axes` is None, new figures are</span>
<span class="sd">            created if the figure already exists</span>
<span class="sd">        %(Project._add_data.parameters.clear)s</span>
<span class="sd">        pwd: str or None, optional</span>
<span class="sd">            Path to the working directory from where the data can be imported.</span>
<span class="sd">            If None and `fname` is the path to a file, `pwd` is set to the</span>
<span class="sd">            directory of this file. Otherwise the current working directory is</span>
<span class="sd">            used.</span>
<span class="sd">        %(ArrayList.from_dict.parameters.no_d|pwd)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ArrayList.from_dict.parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Project</span>
<span class="sd">            The project in state of the saving point&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="kn">import</span> <span class="n">iter_entry_points</span>

        <span class="k">def</span> <span class="nf">get_ax_base</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">alternatives</span><span class="p">):</span>
            <span class="n">ax_base</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax_base</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">alternatives</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">alternatives</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_base</span><span class="p">)</span><span class="o">.</span><span class="n">arr_names</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax_base</span>

        <span class="n">pwd</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">pickle_kws</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">encoding</span> <span class="k">else</span> <span class="p">{</span><span class="s1">&#39;encoding&#39;</span><span class="p">:</span> <span class="n">encoding</span><span class="p">}</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">pickle_kws</span><span class="p">)</span>
            <span class="n">pwd</span> <span class="o">=</span> <span class="n">pwd</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="n">pwd</span> <span class="o">=</span> <span class="n">pwd</span> <span class="ow">or</span> <span class="n">getcwd</span><span class="p">()</span>
        <span class="c1"># check for patches of plugins</span>
        <span class="k">for</span> <span class="n">ep</span> <span class="ow">in</span> <span class="n">iter_entry_points</span><span class="p">(</span><span class="s1">&#39;psyplot&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;patches&#39;</span><span class="p">):</span>
            <span class="n">patches</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">arr_d</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;arrays&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">plotter_cls</span> <span class="o">=</span> <span class="n">arr_d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plotter&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cls&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">plotter_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">plotter_cls</span> <span class="ow">in</span> <span class="n">patches</span><span class="p">:</span>
                    <span class="c1"># apply the patch</span>
                    <span class="n">patches</span><span class="p">[</span><span class="n">plotter_cls</span><span class="p">](</span><span class="n">arr_d</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">],</span>
                                         <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;versions&#39;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">fig_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">alternative_axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fig_dict</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figs&#39;</span><span class="p">,</span> <span class="p">{})):</span>
                <span class="n">orig_num</span> <span class="o">=</span> <span class="n">fig_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">1</span>
                <span class="n">fig_map</span><span class="p">[</span><span class="n">orig_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ProjectLoader</span><span class="o">.</span><span class="n">load_figure</span><span class="p">(</span>
                    <span class="n">fig_dict</span><span class="p">,</span> <span class="n">new_fig</span><span class="o">=</span><span class="n">new_fig</span><span class="p">)</span><span class="o">.</span><span class="n">number</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alternative_axes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">alternative_axes</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">alternative_axes</span><span class="p">))</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">],</span> <span class="n">pwd</span><span class="o">=</span><span class="n">pwd</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main</span><span class="p">:</span>
            <span class="c1"># we create a new project with the project factory to make sure</span>
            <span class="c1"># that everything is handled correctly</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">arr_names</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">arr_names</span>
        <span class="n">sharex</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="n">sharey</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="n">arr_name</span><span class="p">,</span> <span class="n">arr_dict</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">obj</span><span class="p">,</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">arr_names</span><span class="p">,</span>
                            <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">]))):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">arr_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plotter&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">plot_dict</span> <span class="o">=</span> <span class="n">arr_dict</span><span class="p">[</span><span class="s1">&#39;plotter&#39;</span><span class="p">]</span>
            <span class="n">plotter_cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="n">import_module</span><span class="p">(</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;cls&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;cls&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">alternative_axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alternative_axes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">alternative_axes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">alternative_axes</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;ax&#39;</span> <span class="ow">in</span> <span class="n">plot_dict</span><span class="p">:</span>
                <span class="n">already_opened</span> <span class="o">=</span> <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;shared&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">already_opened</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">already_opened</span><span class="p">))]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;shared&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">][</span><span class="s1">&#39;fig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig_map</span><span class="p">[</span>
                        <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharex&#39;</span><span class="p">):</span>
                        <span class="n">sharex</span><span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;sharex&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                            <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">):</span>
                        <span class="n">sharey</span><span class="p">[</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;sharey&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                            <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span><span class="p">)</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">_ProjectLoader</span><span class="o">.</span><span class="n">load_axes</span><span class="p">(</span>
                        <span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">])</span>
            <span class="n">plotter_cls</span><span class="p">(</span>
                <span class="n">arr</span><span class="p">,</span> <span class="n">make_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="n">enable_post</span><span class="o">=</span><span class="n">enable_post</span><span class="p">,</span>
                <span class="o">**</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;fmt&#39;</span><span class="p">])</span>
        <span class="c1"># handle shared x and y-axes</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">sharex</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ax_base</span> <span class="o">=</span> <span class="n">get_ax_base</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax_base</span><span class="o">.</span><span class="n">get_shared_x_axes</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">ax_base</span><span class="p">,</span> <span class="o">*</span><span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">_sharex</span> <span class="o">=</span> <span class="n">ax_base</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">sharey</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ax_base</span> <span class="o">=</span> <span class="n">get_ax_base</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ax_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax_base</span><span class="o">.</span><span class="n">get_shared_y_axes</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">ax_base</span><span class="p">,</span> <span class="o">*</span><span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">_sharey</span> <span class="o">=</span> <span class="n">ax_base</span>
        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">with_plotter</span><span class="p">:</span>
            <span class="n">shared</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;arrays&#39;</span><span class="p">][</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span><span class="p">][</span><span class="s1">&#39;plotter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shared&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">arr_names</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">shared</span><span class="p">):</span>
                <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="n">obj</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">arr_names</span><span class="p">)</span><span class="o">.</span><span class="n">plotters</span><span class="p">,</span>
                                      <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">make_plot</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">plotters</span><span class="p">:</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">reinit</span><span class="p">(</span>
                    <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">clear</span><span class="o">=</span><span class="n">clear</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="n">clear</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
                        <span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_sample_projection</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">draw</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;auto_draw&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">draw</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;auto_show&#39;</span><span class="p">]:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">auto_update</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">auto_update</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lists.auto_update&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">main</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">_main</span> <span class="o">=</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">auto_update</span>
        <span class="n">scp</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Project.scp"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.scp">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;Project.scp&#39;</span><span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">scp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the current project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        project: Project or None</span>
<span class="sd">            The project to set. If it is None, the current subproject is set</span>
<span class="sd">            to empty. If it is a sub project (see:attr:`Project.is_main`),</span>
<span class="sd">            the current subproject is set to this project. Otherwise it</span>
<span class="sd">            replaces the current main project</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        scp: The global version for setting the current project</span>
<span class="sd">        gcp: Returns the current project</span>
<span class="sd">        project: Creates a new project&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_scp</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">gcp</span><span class="p">())</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">project</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">project</span><span class="o">.</span><span class="n">main</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">_current_project</span><span class="p">:</span>
                <span class="n">_scp</span><span class="p">(</span><span class="n">project</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">project</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
            <span class="n">_scp</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_scp</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">project</span><span class="p">[:]</span>
            <span class="n">_scp</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">oncpchange</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span></div>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;Project.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Project.new"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Project.new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new main project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num: int</span>
<span class="sd">            The number of the project</span>
<span class="sd">        %(Project.parameters.no_num)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Project</span>
<span class="sd">            The with the given `num` (if it does not already exist, it is</span>
<span class="sd">            created)</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        scp: Sets the current project</span>
<span class="sd">        gcp: Returns the current project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">scp</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">project</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> Main &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">super</span><span class="p">(</span>
            <span class="n">Project</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span></div>


<span class="k">class</span> <span class="nc">_ProjectLoader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class to inspect a project and reproduce it&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">inspect_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the parameters (heigth, width, etc.) to create a figure</span>

<span class="sd">        This method returns the number of the figure and a dictionary</span>
<span class="sd">        containing the necessary information for the</span>
<span class="sd">        :func:`matplotlib.pyplot.figure` function&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">fig</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
            <span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">(),</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_figheight</span><span class="p">()),</span>
            <span class="s1">&#39;dpi&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span> <span class="o">/</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;_dpi_ratio&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">(),</span>
            <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">(),</span>
            <span class="s1">&#39;frameon&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_frameon</span><span class="p">(),</span>
            <span class="s1">&#39;tight_layout&#39;</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_tight_layout</span><span class="p">(),</span>
            <span class="s1">&#39;subplotpars&#39;</span><span class="p">:</span> <span class="nb">vars</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">subplotpars</span><span class="p">)}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_figure</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">new_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a figure from what is returned by :meth:`inspect_figure`&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">subplotpars</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;subplotpars&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subplotpars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subplotpars</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;validate&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">subplotpars</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_validate&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">subplotpars</span> <span class="o">=</span> <span class="n">mfig</span><span class="o">.</span><span class="n">SubplotParams</span><span class="p">(</span><span class="o">**</span><span class="n">subplotpars</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_fig</span><span class="p">:</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">subplotpars</span><span class="o">=</span><span class="n">subplotpars</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">inspect_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inspect an axes or subplot to get the initialization parameters&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fig&#39;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">number</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;2.0&#39;</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;axisbg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_axis_bgcolor</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># axisbg is depreceated</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;projection&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">proj</span> <span class="o">=</span> <span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="n">proj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;projection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;visible&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;spines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;zorder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;yaxis_inverted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis_inverted</span><span class="p">()</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;xaxis_inverted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis_inverted</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;spines&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;visible&#39;</span><span class="p">]:</span>
                <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;spines&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s1">&#39;get_&#39;</span> <span class="o">+</span> <span class="n">prop</span><span class="p">)()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mfig</span><span class="o">.</span><span class="n">SubplotBase</span><span class="p">):</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">get_topmost_subplotspec</span><span class="p">()</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;grid_spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;subplotspec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">num1</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">num2</span><span class="p">]</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;is_subplot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">]</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;is_subplot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_axes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an axes or subplot from what is returned by</span>
<span class="sd">        :meth:`inspect_axes`&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;projection&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">spines</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;spines&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">invert_yaxis</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;yaxis_inverted&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">invert_xaxis</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xaxis_inverted&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s1">&#39;2.0&#39;</span> <span class="ow">and</span> <span class="s1">&#39;axisbg&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>  <span class="c1"># axisbg is depreceated</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;axisbg&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;2.0&#39;</span> <span class="ow">and</span> <span class="s1">&#39;facecolor&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;axisbg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">proj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">import_module</span><span class="p">(</span><span class="n">proj</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">proj</span><span class="p">[</span><span class="mi">1</span><span class="p">])()</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;is_subplot&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">grid_spec</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;grid_spec&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">subplotspec</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">SubplotSpec</span><span class="p">(</span>
                <span class="n">grid_spec</span><span class="p">,</span> <span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;subplotspec&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">subplotspec</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">invert_xaxis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ret</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ret</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">invert_yaxis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ret</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ret</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ret</span>


<div class="viewcode-block" id="ProjectPlotter"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.ProjectPlotter">[docs]</a><span class="k">class</span> <span class="nc">ProjectPlotter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plotting methods of the :class:`psyplot.project.Project` class&quot;&quot;&quot;</span>

    <span class="c1">#: the base class for new plot methods. Is set below with the</span>
    <span class="c1">#: :class:`PlotterInterface` class</span>
    <span class="n">_plot_method_base_cls</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="n">project</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;ArrayList.from_dataset.parameters&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;default_slice&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_plot_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary with mappings from plot method to their summary&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PlotterInterface</span><span class="p">):</span>
                <span class="n">ret</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_summary</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="ProjectPlotter.show_plot_methods"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.ProjectPlotter.show_plot_methods">[docs]</a>    <span class="k">def</span> <span class="nf">show_plot_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print the plotmethods of this instance&quot;&quot;&quot;</span>
        <span class="n">print_func</span> <span class="o">=</span> <span class="n">PlotterInterface</span><span class="o">.</span><span class="n">_print_func</span>
        <span class="k">if</span> <span class="n">print_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">print_func</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">print_</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">    </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_methods</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">print_func</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;ProjectPlotter._add_data&#39;</span><span class="p">,</span>
                              <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;Other Parameters&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Returns&#39;</span><span class="p">])</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add new plots to the project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Project._add_data.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Project._add_data.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Project._add_data.returns)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this method is just a shortcut to the :meth:`Project._add_data`</span>
        <span class="c1"># method but is reimplemented by subclasses as the</span>
        <span class="c1"># :class:`DatasetPlotter` or the :class:`DataArrayPlotter`</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_add_data</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;ProjectPlotter._register_plotter&#39;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_register_plotter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span>
                          <span class="n">plotter_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">prefer_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">default_slice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_dims</span><span class="o">=</span><span class="p">{},</span>
                          <span class="n">show_examples</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">example_call</span><span class="o">=</span><span class="s2">&quot;filename, name=[&#39;my_variable&#39;], ...&quot;</span><span class="p">,</span>
                          <span class="n">plugin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a plotter for making plots</span>

<span class="sd">        This class method registeres a plot function for the :class:`Project`</span>
<span class="sd">        class under the name of the given `identifier`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Project._register_plotter.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        prefer_list: bool</span>
<span class="sd">            Determines the `prefer_list` parameter in the `from_dataset`</span>
<span class="sd">            method. If True, the plotter is expected to work with instances of</span>
<span class="sd">            :class:`psyplot.InteractiveList` instead of</span>
<span class="sd">            :class:`psyplot.InteractiveArray`.</span>
<span class="sd">        %(ArrayList.from_dataset.parameters.default_slice)s</span>
<span class="sd">        default_dims: dict</span>
<span class="sd">            Default dimensions that shall be used for plotting (e.g.</span>
<span class="sd">            {&#39;x&#39;: slice(None), &#39;y&#39;: slice(None)} for longitude-latitude plots)</span>
<span class="sd">        show_examples: bool, optional</span>
<span class="sd">            If True, examples how to access the plotter documentation are</span>
<span class="sd">            included in class documentation</span>
<span class="sd">        example_call: str, optional</span>
<span class="sd">            The arguments and keyword arguments that shall be included in the</span>
<span class="sd">            example of the generated plot method. This call will then appear as</span>
<span class="sd">            ``&gt;&gt;&gt; psy.plot.%%(identifier)s(%%(example_call)s)`` in the</span>
<span class="sd">            documentation</span>
<span class="sd">        plugin: str</span>
<span class="sd">            The name of the plugin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plotter_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># plotter has already been imported</span>
            <span class="n">docstrings</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.formatoptions&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">full_name</span><span class="p">)]</span> <span class="o">=</span> \
                <span class="n">plotter_cls</span><span class="o">.</span><span class="n">show_keys</span><span class="p">(</span>
                    <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="c1"># include links in sphinx doc</span>
                    <span class="n">include_links</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">doc_str</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Possible formatoptions are</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                       <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">(</span><span class="si">%s</span><span class="s1">.formatoptions)s&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">full_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doc_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="s1">&#39;Open and plot data via :class:`</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">` plotters&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">plotter_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_versions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_versions</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">==</span> <span class="n">plugin</span><span class="p">))</span>

        <span class="k">class</span> <span class="nc">PlotMethod</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_plot_method_base_cls</span><span class="p">):</span>
            <span class="vm">__doc__</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_gen_doc</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span>
                                   <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">,</span> <span class="n">show_examples</span><span class="p">)</span>

            <span class="n">_default_slice</span> <span class="o">=</span> <span class="n">default_slice</span>
            <span class="n">_default_dims</span> <span class="o">=</span> <span class="n">default_dims</span>
            <span class="n">_plotter_cls</span> <span class="o">=</span> <span class="n">plotter_cls</span>
            <span class="n">_prefer_list</span> <span class="o">=</span> <span class="n">prefer_list</span>
            <span class="n">_plugin</span> <span class="o">=</span> <span class="n">plugin</span>

            <span class="n">_summary</span> <span class="o">=</span> <span class="n">summary</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">PlotMethod</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_doc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">,</span>
                 <span class="n">show_examples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the documentation docstring for a PlotMethod&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">%s</span><span class="s2"></span>

<span class="s2">            This plotting method adds data arrays and plots them via</span>
<span class="s2">            :class:`</span><span class="si">%s</span><span class="s2">` plotters</span>

<span class="s2">            To plot data from a netCDF file type::</span>

<span class="s2">                &gt;&gt;&gt; psy.plot.</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)</span>

<span class="s2">            </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">show_examples</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_gen_examples</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_examples</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate examples how to axes the formatoption docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Examples</span>
<span class="s2">            --------</span>
<span class="s2">            To explore the formatoptions and their documentations, use the</span>
<span class="s2">            ``keys``, ``summaries`` and ``docs`` methods. For example::</span>

<span class="s2">                &gt;&gt;&gt; import psyplot.project as psy</span>

<span class="s2">                # show the keys corresponding to a group or multiple</span>
<span class="s2">                # formatopions</span>
<span class="s2">                &gt;&gt;&gt; psy.plot.</span><span class="si">%(id)s</span><span class="s2">.keys(&#39;labels&#39;)</span>

<span class="s2">                # show the summaries of a group of formatoptions or of a</span>
<span class="s2">                # formatoption</span>
<span class="s2">                &gt;&gt;&gt; psy.plot.</span><span class="si">%(id)s</span><span class="s2">.summaries(&#39;title&#39;)</span>

<span class="s2">                # show the full documentation</span>
<span class="s2">                &gt;&gt;&gt; psy.plot.</span><span class="si">%(id)s</span><span class="s2">.docs(&#39;plot&#39;)</span>

<span class="s2">                # or access the documentation via the attribute</span>
<span class="s2">                &gt;&gt;&gt; psy.plot.</span><span class="si">%(id)s</span><span class="s2">.plot&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span></div>


<div class="viewcode-block" id="PlotterInterface"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface">[docs]</a><span class="k">class</span> <span class="nc">PlotterInterface</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for visualizing a data array from an predefined plotter</span>

<span class="sd">    See the :meth:`__call__` method for details on plotting.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_imported</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if the module for this plot method has been imported already&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plotter_cls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The plotter class&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter_cls</span>
        <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;importing </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_name</span>
            <span class="k">if</span> <span class="n">plotter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">mod</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Module </span><span class="si">%r</span><span class="s2"> does not have a </span><span class="si">%r</span><span class="s2"> plotter!&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">mod</span><span class="p">,</span> <span class="n">plotter</span><span class="p">))</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter_cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">plotter</span><span class="p">)</span>
            <span class="n">_versions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_versions</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plugin</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">_prefer_list</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_default_slice</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_default_dims</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">_print_func</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">print_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The function that is used to return a formatoption</span>

<span class="sd">        By default the :func:`print` function is used (i.e. it is printed to</span>
<span class="sd">        the terminal)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_func</span> <span class="ow">or</span> <span class="n">six</span><span class="o">.</span><span class="n">print_</span>

    <span class="nd">@print_func</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">print_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_func</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">project_plotter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">methodname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_project_plotter</span> <span class="o">=</span> <span class="n">project_plotter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_name</span> <span class="o">=</span> <span class="n">plotter_name</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ProjectPlotter._add_data.parameters&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;plotter_cls&#39;</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(ProjectPlotter._add_data.parameters.no_plotter_cls)s</span>
<span class="sd">        %(Project._load_preset.parameters.preset)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ProjectPlotter._add_data.other_parameters)s</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(ProjectPlotter._add_data.returns)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">preset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;preset&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">preset</span><span class="p">:</span>
            <span class="n">preset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_plotter</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_load_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">preset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">preset</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
                    <span class="n">fmt</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_plotter</span><span class="o">.</span><span class="n">_add_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span>
                <span class="p">[(</span><span class="s1">&#39;prefer_list&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefer_list</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;default_slice&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_slice</span><span class="p">)],</span>
                <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_dims</span><span class="p">),</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))))</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_func</span><span class="p">,</span>
                           <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> instance does not have a </span><span class="si">%s</span><span class="s2"> attribute&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_name</span><span class="p">,</span>
                    <span class="n">instance</span><span class="p">))</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Actually not required. We just implement it to ensure the python</span>
<span class="sd">        &quot;help&quot; function works well&quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">()))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">))</span>

<div class="viewcode-block" id="PlotterInterface.keys"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface.keys">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classmethod to return a nice looking table with the given formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        summaries, docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">show_keys</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotterInterface.summaries"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface.summaries">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to print the summaries of the formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        keys, docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">show_summaries</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotterInterface.docs"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface.docs">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to print the full documentations of the formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        keys, docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">show_docs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotterInterface.check_data"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface.check_data">[docs]</a>    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">check_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A validation method for the data shape</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: list of lists of strings</span>
<span class="sd">            The variable names (see the</span>
<span class="sd">            :meth:`~psyplot.plotter.Plotter.check_data` method of the</span>
<span class="sd">            :attr:`plotter_cls` attribute for details)</span>
<span class="sd">        dims: list of dictionaries</span>
<span class="sd">            The dimensions of the arrays. It will be enhanced by the default</span>
<span class="sd">            dimensions of this plot method</span>
<span class="sd">        is_unstructured: bool or list of bool</span>
<span class="sd">            True if the corresponding array is unstructured.</span>
<span class="sd">        decoder: :class:`psyplot.data.CFDecoder`, dict or a list of them</span>
<span class="sd">            The decoders to use per array. Dictionaries are parsed as keyword</span>
<span class="sd">            arguments to the :meth:`psyplot.data.CFDecoder.get_decoder`</span>
<span class="sd">            method</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.check_data.returns)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">]</span>
            <span class="n">decoders</span> <span class="o">=</span> <span class="p">[</span><span class="n">decoder</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
            <span class="n">decoders</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">decoder</span> <span class="k">if</span> <span class="n">decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="p">[</span><span class="n">safe_list</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">decoders</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">decoders</span> <span class="o">=</span> <span class="p">[</span><span class="n">CFDecoder</span><span class="o">.</span><span class="n">get_decoder</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">decoder</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">decoders</span><span class="p">,</span> <span class="n">variables</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">decoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">decoder</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decoder</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">decoders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFDecoder</span><span class="o">.</span><span class="n">get_decoder</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="o">**</span><span class="n">decoder</span><span class="p">)</span>
        <span class="n">default_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_slice</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_slice</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">dim_dict</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
                <span class="n">dims</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">decoders</span><span class="p">)):</span>
            <span class="n">corrected</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="n">correct_dims</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span>
                <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_dims</span><span class="p">),</span>
                <span class="n">dim_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
            <span class="c1"># now use the default slice (we don&#39;t do this before because the</span>
            <span class="c1"># `correct_dims` method doesn&#39;t use &#39;x&#39;, &#39;y&#39;, &#39;z&#39; and &#39;t&#39; (as used</span>
            <span class="c1"># for the _default_dims) if the real dimension name is already in</span>
            <span class="c1"># the dictionary)</span>
            <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">corrected</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">default_slice</span><span class="p">)</span>
            <span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">safe_list</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
                                        <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">corrected</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">_is_slice</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="o">.</span><span class="n">check_data</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="p">[</span><span class="n">decoder</span><span class="o">.</span><span class="n">is_unstructured</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">decoder</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">decoders</span><span class="p">,</span> <span class="n">variables</span><span class="p">)])</span></div></div>


<span class="c1"># set the base class for the :class:`ProjectPlotter` plot methods</span>
<span class="n">ProjectPlotter</span><span class="o">.</span><span class="n">_plot_method_base_cls</span> <span class="o">=</span> <span class="n">PlotterInterface</span>


<div class="viewcode-block" id="DatasetPlotterInterface"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.DatasetPlotterInterface">[docs]</a><span class="k">class</span> <span class="nc">DatasetPlotterInterface</span><span class="p">(</span><span class="n">PlotterInterface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface for the :class:`DatasetPlotter` to a plotter&quot;&quot;&quot;</span>

    <span class="c1"># there are not changes here compared to :class:`PlotterInterface`, except</span>
    <span class="c1"># for a different docstring for the __call__ method</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ProjectPlotter._add_data.parameters&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;plotter_cls&#39;</span><span class="p">,</span> <span class="s1">&#39;filename_or_obj&#39;</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(ProjectPlotter._add_data.parameters.no_plotter_cls|filename_or_obj)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ProjectPlotter._add_data.other_parameters)s</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(ProjectPlotter._add_data.returns)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DatasetPlotterInterface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="DatasetPlotter"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.DatasetPlotter">[docs]</a><span class="k">class</span> <span class="nc">DatasetPlotter</span><span class="p">(</span><span class="n">ProjectPlotter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface between the :class:`xarray.Dataset` and the psyplot project</span>

<span class="sd">    This class can be used to make new plots from a given dataset and add them</span>
<span class="sd">    to the current :func:`psyplot.project`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_plot_method_base_cls</span> <span class="o">=</span> <span class="n">DatasetPlotterInterface</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DatasetPlotter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span> <span class="o">=</span> <span class="n">ds</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;ProjectPlotter._add_data.parameters&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;filename_or_obj&#39;</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s1">&#39;ProjectPlotter._add_data&#39;</span><span class="p">,</span>
                              <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;Other Parameters&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Returns&#39;</span><span class="p">])</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add new plots to the project</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(ProjectPlotter._add_data.parameters.no_filename_or_obj)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(ProjectPlotter._add_data.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(ProjectPlotter._add_data.returns)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this method is just a shortcut to the :meth:`Project._add_data`</span>
        <span class="c1"># method but is reimplemented by subclasses as the</span>
        <span class="c1"># :class:`DatasetPlotter` or the :class:`DataArrayPlotter`</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DatasetPlotter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_add_data</span><span class="p">(</span><span class="n">plotter_cls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ds</span><span class="p">,</span>
                                                     <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_doc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">,</span>
                 <span class="n">show_examples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the documentation docstring for a PlotMethod&quot;&quot;&quot;</span>
        <span class="c1"># leave out the first argument</span>
        <span class="n">example_call</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">example_call</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">%s</span><span class="s2"></span>

<span class="s2">            This plotting method adds data arrays and plots them via</span>
<span class="s2">            :class:`</span><span class="si">%s</span><span class="s2">` plotters</span>

<span class="s2">            To plot a variable in this dataset, type::</span>

<span class="s2">                &gt;&gt;&gt; ds.psy.plot.</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)</span>

<span class="s2">            </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">show_examples</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_gen_examples</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_examples</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate examples how to axes the formatoption docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Examples</span>
<span class="s2">            --------</span>
<span class="s2">            To explore the formatoptions and their documentations, use the</span>
<span class="s2">            ``keys``, ``summaries`` and ``docs`` methods. For example::</span>

<span class="s2">                # show the keys corresponding to a group or multiple</span>
<span class="s2">                # formatopions</span>
<span class="s2">                &gt;&gt;&gt; ds.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.keys(&#39;labels&#39;)</span>

<span class="s2">                # show the summaries of a group of formatoptions or of a</span>
<span class="s2">                # formatoption</span>
<span class="s2">                &gt;&gt;&gt; ds.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.summaries(&#39;title&#39;)</span>

<span class="s2">                # show the full documentation</span>
<span class="s2">                &gt;&gt;&gt; ds.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.docs(&#39;plot&#39;)</span>

<span class="s2">                # or access the documentation via the attribute</span>
<span class="s2">                &gt;&gt;&gt; ds.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.plot&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span></div>


<div class="viewcode-block" id="DataArrayPlotterInterface"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.DataArrayPlotterInterface">[docs]</a><span class="k">class</span> <span class="nc">DataArrayPlotterInterface</span><span class="p">(</span><span class="n">PlotterInterface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface for the :class:`DataArrayPlotter` to a plotter&quot;&quot;&quot;</span>

    <span class="c1"># we reimplement the call method because we do not use the</span>
    <span class="c1"># prefer_list, etc. keywords. And we reimplment the check_data method</span>
    <span class="c1"># because we use the data array directly</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;Plotter.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.parameters.no_data)s</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psyplot.plotter.Plotter</span>
<span class="sd">            The plotter that visualizes the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">checks</span><span class="p">,</span> <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Cannot visualize the data using </span><span class="si">%s</span><span class="s1">! Reasons:</span><span class="se">\n</span><span class="s1">    </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plotter_name</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">    &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">messages</span><span class="p">))))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_plotter</span><span class="o">.</span><span class="n">_add_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="DataArrayPlotterInterface.check_data"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.DataArrayPlotterInterface.check_data">[docs]</a>    <span class="k">def</span> <span class="nf">check_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check whether the plotter of this plot method can visualize the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plotter_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_cls</span>
        <span class="n">da_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_plotter</span><span class="o">.</span><span class="n">_da</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">to_interactive_list</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">plotter_cls</span><span class="o">.</span><span class="n">check_data</span><span class="p">(</span>
            <span class="n">da_list</span><span class="o">.</span><span class="n">all_names</span><span class="p">,</span> <span class="n">da_list</span><span class="o">.</span><span class="n">all_dims</span><span class="p">,</span> <span class="n">da_list</span><span class="o">.</span><span class="n">is_unstructured</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DataArrayPlotter"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.DataArrayPlotter">[docs]</a><span class="k">class</span> <span class="nc">DataArrayPlotter</span><span class="p">(</span><span class="n">ProjectPlotter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface between the :class:`xarray.Dataset` and the psyplot project</span>

<span class="sd">    This class can be used to make new plots from a given dataset and add them</span>
<span class="sd">    to the current :func:`psyplot.project`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_plot_method_base_cls</span> <span class="o">=</span> <span class="n">DataArrayPlotterInterface</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataArrayPlotter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_da</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="s1">&#39;arr&#39;</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualize this data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.parameters.no_data)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psyplot.plotter.Plotter</span>
<span class="sd">            The plotter that visualizes the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># this method is just a shortcut to the :meth:`Project._add_data`</span>
        <span class="c1"># method but is reimplemented by subclasses as the</span>
        <span class="c1"># :class:`DatasetPlotter` or the :class:`DataArrayPlotter`</span>
        <span class="k">return</span> <span class="n">plotter_cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_da</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_doc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">example_call</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">,</span>
                 <span class="n">show_examples</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the documentation docstring for a PlotMethod&quot;&quot;&quot;</span>
        <span class="c1"># leave out the first argument</span>
        <span class="n">example_call</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">example_call</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            </span><span class="si">%s</span><span class="s2"></span>

<span class="s2">            This plotting method visualizes the data via a</span>
<span class="s2">            :class:`</span><span class="si">%s</span><span class="s2">` plotters</span>

<span class="s2">            To plot a variable in this dataset, type::</span>

<span class="s2">                &gt;&gt;&gt; da.psy.plot.</span><span class="si">%s</span><span class="s2">()</span>

<span class="s2">            </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">doc_str</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">show_examples</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_gen_examples</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_gen_examples</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate examples how to axes the formatoption docs&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Examples</span>
<span class="s2">            --------</span>
<span class="s2">            To explore the formatoptions and their documentations, use the</span>
<span class="s2">            ``keys``, ``summaries`` and ``docs`` methods. For example::</span>

<span class="s2">                # show the keys corresponding to a group or multiple</span>
<span class="s2">                # formatopions</span>
<span class="s2">                &gt;&gt;&gt; da.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.keys(&#39;labels&#39;)</span>

<span class="s2">                # show the summaries of a group of formatoptions or of a</span>
<span class="s2">                # formatoption</span>
<span class="s2">                &gt;&gt;&gt; da.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.summaries(&#39;title&#39;)</span>

<span class="s2">                # show the full documentation</span>
<span class="s2">                &gt;&gt;&gt; da.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.docs(&#39;plot&#39;)</span>

<span class="s2">                # or access the documentation via the attribute</span>
<span class="s2">                &gt;&gt;&gt; da.psy.plot.</span><span class="si">%(id)s</span><span class="s2">.plot&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span></div>


<span class="k">if</span> <span class="n">with_cdo</span><span class="p">:</span>
    <span class="n">CDF_MOD_NCREADER</span> <span class="o">=</span> <span class="s1">&#39;xarray&#39;</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s1">&#39;Project._add_data.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;dims&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="s1">&#39;make_plot&#39;</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Cdo"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Cdo">[docs]</a>    <span class="k">class</span> <span class="nc">Cdo</span><span class="p">(</span><span class="n">_CdoBase</span><span class="p">):</span>

        <span class="vm">__doc__</span> <span class="o">=</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Subclass of the original cdo.Cdo class in the cdo.py module</span>

<span class="sd">            Requirements are a working cdo binary and the installed cdo.py</span>
<span class="sd">            python module.</span>

<span class="sd">            For a documentation of an operator, use the python help function,</span>
<span class="sd">            for a list of operators, use the builtin dir function.</span>
<span class="sd">            Further documentation on the operators can be found here:</span>
<span class="sd">            https://code.zmaw.de/projects/cdo/wiki/Cdo%7Brbpy%7D</span>
<span class="sd">            and on the usage of the cdo.py module here:</span>
<span class="sd">            https://code.zmaw.de/projects/cdo</span>

<span class="sd">            For a demonstration script on how cdos are implemented, see the</span>
<span class="sd">            examples of the psyplot package</span>

<span class="sd">            Compared to the original cdo.Cdo class, the following things</span>
<span class="sd">            changed, the default cdf handler is the</span>
<span class="sd">            :func:`psyplot.data.open_dataset` function and the following</span>
<span class="sd">            keywords are implemented for each cdo operator. If any of those is</span>
<span class="sd">            specified, the return will be a subproject (i.e. an instance of</span>
<span class="sd">            :class:`psyplot.project.Project`)</span>

<span class="sd">            Other Parameters</span>
<span class="sd">            ----------------</span>
<span class="sd">            plot_method: str or psyplot.project.PlotterInterface</span>
<span class="sd">                An registered plotting function to plot the data (e.g.</span>
<span class="sd">                `psyplot.project.plot.mapplot` to plot on a map). If ``None``,</span>
<span class="sd">                no plot will be created. In any case, the returned value is a</span>
<span class="sd">                subproject. If string, it must correspond to the attribute of</span>
<span class="sd">                the :class:`psyplot.project.ProjectPlotter` class</span>
<span class="sd">            name: str or list of str</span>
<span class="sd">                The variable names to plot/extract</span>
<span class="sd">            %(Project._add_data.parameters.dims|fmt|ax|make_plot|method)s</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            Calculate the timmean of a 3-dimensional array and plot it on a map</span>
<span class="sd">            using the psy-maps package</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">                cdo = psy.Cdo()</span>
<span class="sd">                sp = cdo.timmean(input=&#39;ifile.nc&#39;, name=&#39;temperature&#39;,</span>
<span class="sd">                                 plot_method=&#39;mapplot&#39;)</span>

<span class="sd">            which is essentially the same as</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">                sp = cdo.timmean(input=&#39;ifile.nc&#39;, name=&#39;temperature&#39;,</span>
<span class="sd">                                 plot_method=psy.plot.mapplot)</span>
<span class="sd">                # and</span>
<span class="sd">                sp = psy.plot.mapplot(</span>
<span class="sd">                    cdo.timmean(input=&#39;ifile.nc&#39;, returnCdf=True),</span>
<span class="sd">                    name=&#39;temperature&#39;, plot_method=psy.plot.mapplot)</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cdo_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;cdfMod&#39;</span><span class="p">,</span> <span class="n">CDF_MOD_NCREADER</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Cdo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cdo_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadCdf</span><span class="p">()</span>

<div class="viewcode-block" id="Cdo.loadCdf"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.Cdo.loadCdf">[docs]</a>        <span class="k">def</span> <span class="nf">loadCdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Load data handler as specified by self.cdfMod&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">cdo_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">open_nc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">open_dataset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdfMod</span> <span class="o">==</span> <span class="n">CDF_MOD_NCREADER</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span> <span class="o">=</span> <span class="n">open_nc</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">super</span><span class="p">(</span><span class="n">Cdo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">loadCdf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">Cdo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">readCdf</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

        <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">my_get</span><span class="p">(</span><span class="n">get</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Wrapper for get method of Cdo class to include several plotters</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="nd">@wraps</span><span class="p">(</span><span class="n">get</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                    <span class="n">added_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;plot_method&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;dims&#39;</span><span class="p">,</span> <span class="s1">&#39;fmt&#39;</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">added_kwargs</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
                        <span class="n">plot_method</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_method&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="n">ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="n">make_plot</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;make_plot&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="n">dims</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;dims&#39;</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="n">method</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;isel&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">cdo_version</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
                            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;returnCdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;returnXDataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">ds</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_method</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                            <span class="n">plot_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">plot_method</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">plot_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">ret</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span>
                                <span class="n">ds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
                            <span class="n">ret</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">ret</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">plot_method</span><span class="p">(</span>
                                <span class="n">ds</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                <span class="n">make_plot</span><span class="o">=</span><span class="n">make_plot</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">get</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">wrapper</span>

            <span class="n">get</span> <span class="o">=</span> <span class="n">my_get</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">Cdo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">method_name</span><span class="p">))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">get</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="gcp"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.gcp">[docs]</a><span class="nd">@dedent</span>
<span class="k">def</span> <span class="nf">gcp</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the current project</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    main: bool</span>
<span class="sd">        If True, the current main project is returned, otherwise the current</span>
<span class="sd">        subproject is returned.</span>
<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scp: Sets the current project</span>
<span class="sd">    project: Creates a new project&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">main</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">project</span><span class="p">()</span> <span class="k">if</span> <span class="n">_current_project</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_current_project</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">_current_subproject</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">_current_subproject</span></div>


<div class="viewcode-block" id="scp"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.scp">[docs]</a><span class="nd">@dedent</span>
<span class="k">def</span> <span class="nf">scp</span><span class="p">(</span><span class="n">project</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the current project</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    %(Project.scp.parameters)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    gcp: Returns the current project</span>
<span class="sd">    project: Creates a new project&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PROJECT_CLS</span><span class="o">.</span><span class="n">scp</span><span class="p">(</span><span class="n">project</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_scp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;scp version that allows a bit more control over whether the project is a</span>
<span class="sd">    main project or not&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_current_subproject</span>
    <span class="k">global</span> <span class="n">_current_project</span>
    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="n">project</span><span class="p">()</span> <span class="k">if</span> <span class="n">main</span> <span class="ow">or</span> <span class="n">_current_project</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
            <span class="n">_current_project</span>
        <span class="n">_current_subproject</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="n">mp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">main</span><span class="p">:</span>
        <span class="n">_current_subproject</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_current_project</span> <span class="o">=</span> <span class="n">p</span>


<div class="viewcode-block" id="project"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.project">[docs]</a><span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
<span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new main project</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num: int</span>
<span class="sd">        The number of the project</span>
<span class="sd">    %(Project.parameters.no_num)s</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Project</span>
<span class="sd">        The with the given `num` (if it does not already exist, it is created)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    scp: Sets the current project</span>
<span class="sd">    gcp: Returns the current project</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">project</span><span class="o">.</span><span class="n">num</span> <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">_open_projects</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_open_projects</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">numbers</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">PROJECT_CLS</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">_open_projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">project</span></div>


<div class="viewcode-block" id="close"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.close">[docs]</a><span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
<span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Close the project</span>

<span class="sd">    This method closes the current project (figures, data and datasets) or the</span>
<span class="sd">    project specified by `num`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    num: int, None or &#39;all&#39;</span>
<span class="sd">        if :class:`int`, it specifies the number of the project, if None, the</span>
<span class="sd">        current subproject is closed, if ``&#39;all&#39;``, all open projects are</span>
<span class="sd">        closed</span>
<span class="sd">    %(Project.close.parameters)s</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Project.close&quot;&quot;&quot;</span>
    <span class="n">kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">figs</span><span class="o">=</span><span class="n">figs</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">remove_only</span><span class="o">=</span><span class="n">remove_only</span><span class="p">)</span>
    <span class="n">cp_num</span> <span class="o">=</span> <span class="n">gcp</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">num</span>
    <span class="n">got_cp</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project</span> <span class="o">=</span> <span class="n">gcp</span><span class="p">()</span>
        <span class="n">scp</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">project</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">_open_projects</span><span class="p">[:]:</span>
            <span class="n">project</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
            <span class="n">got_cp</span> <span class="o">=</span> <span class="n">got_cp</span> <span class="ow">or</span> <span class="n">project</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="n">cp_num</span>
            <span class="k">del</span> <span class="n">_open_projects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">Project</span><span class="p">):</span>
            <span class="n">project</span> <span class="o">=</span> <span class="n">num</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">project</span> <span class="o">=</span> <span class="p">[</span><span class="n">project</span> <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">_open_projects</span>
                       <span class="k">if</span> <span class="n">project</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="n">num</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">project</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_open_projects</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">got_cp</span> <span class="o">=</span> <span class="n">got_cp</span> <span class="ow">or</span> <span class="n">project</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">num</span> <span class="o">==</span> <span class="n">cp_num</span>
    <span class="k">if</span> <span class="n">got_cp</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_open_projects</span><span class="p">:</span>
            <span class="c1"># set last opened project to the current</span>
            <span class="n">scp</span><span class="p">(</span><span class="n">_open_projects</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_scp</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># set the current project to None</span></div>


<span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s1">&#39;Project._register_plotter.parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;plotter_cls&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="register_plotter"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.register_plotter">[docs]</a><span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
<span class="k">def</span> <span class="nf">register_plotter</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">sorter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_func</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">import_plotter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a :class:`psyplot.plotter.Plotter` for the projects</span>

<span class="sd">    This function registers plotters for the :class:`Project` class to allow</span>
<span class="sd">    a dynamical handling of different plotter classes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    %(Project._register_plotter.parameters.no_plotter_cls)s</span>
<span class="sd">    sorter: bool, optional</span>
<span class="sd">        If True, the :class:`Project` class gets a new property with the name</span>
<span class="sd">        of the specified `identifier` which allows you to access the instances</span>
<span class="sd">        that are plotted by the specified `plotter_name`</span>
<span class="sd">    plot_func: bool, optional</span>
<span class="sd">        If True, the :class:`ProjectPlotter` (the class that holds the</span>
<span class="sd">        plotting method for the :class:`Project` class and can be accessed via</span>
<span class="sd">        the :attr:`Project.plot` attribute) gets an additional method to plot</span>
<span class="sd">        via the specified `plotter_name` (see `Other Parameters` below.)</span>
<span class="sd">    import_plotter: bool, optional</span>
<span class="sd">        If True, the plotter is automatically imported, otherwise it is only</span>
<span class="sd">        imported when it is needed. If `import_plotter` is None, then it is</span>
<span class="sd">        determined by the :attr:`psyplot.rcParams` ``&#39;project.auto_import&#39;``</span>
<span class="sd">        item.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    %(ProjectPlotter._register_plotter.other_parameters)s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plotter_cls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">import_plotter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;project.auto_import&#39;</span><span class="p">])</span> <span class="ow">or</span>
                <span class="n">import_plotter</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">plotter_cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">import_module</span><span class="p">(</span><span class="n">module</span><span class="p">),</span> <span class="n">plotter_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">critical</span><span class="p">((</span><span class="s2">&quot;Could not import </span><span class="si">%s</span><span class="s2">!</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">module</span><span class="p">)</span> <span class="o">+</span>
                         <span class="n">e</span><span class="o">.</span><span class="n">message</span> <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">PY2</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">return</span>
    <span class="k">if</span> <span class="n">sorter</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Project class already has a </span><span class="si">%s</span><span class="s2"> attribute&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">)</span>
        <span class="n">Project</span><span class="o">.</span><span class="n">_register_plotter</span><span class="p">(</span>
            <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_func</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ProjectPlotter</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Project class already has a </span><span class="si">%s</span><span class="s2"> attribute&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">)</span>
        <span class="n">ProjectPlotter</span><span class="o">.</span><span class="n">_register_plotter</span><span class="p">(</span>
            <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">DatasetPlotter</span><span class="o">.</span><span class="n">_register_plotter</span><span class="p">(</span>
            <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">DataArrayPlotter</span><span class="o">.</span><span class="n">_register_plotter</span><span class="p">(</span>
            <span class="n">identifier</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="p">,</span> <span class="n">plotter_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">identifier</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">registered_plotters</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span> <span class="n">plotter_name</span><span class="o">=</span><span class="n">plotter_name</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="n">sorter</span><span class="p">,</span>
            <span class="n">plot_func</span><span class="o">=</span><span class="n">plot_func</span><span class="p">,</span> <span class="n">import_plotter</span><span class="o">=</span><span class="n">import_plotter</span><span class="p">))</span>
        <span class="n">registered_plotters</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="unregister_plotter"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.unregister_plotter">[docs]</a><span class="k">def</span> <span class="nf">unregister_plotter</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_func</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unregister a :class:`psyplot.plotter.Plotter` for the projects</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    identifier: str</span>
<span class="sd">        Name of the attribute that is used to filter for the instances</span>
<span class="sd">        belonging to this plotter or to create plots with this plotter</span>
<span class="sd">    sorter: bool</span>
<span class="sd">        If True, the identifier will be unregistered from the :class:`Project`</span>
<span class="sd">        class</span>
<span class="sd">    plot_func: bool</span>
<span class="sd">        If True, the identifier will be unregistered from the</span>
<span class="sd">        :class:`ProjectPlotter` class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">registered_plotters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">sorter</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="n">Project</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;sorter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">plot_func</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ProjectPlotter</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ProjectPlotter</span><span class="p">,</span> <span class="n">DatasetPlotter</span><span class="p">,</span> <span class="n">DataArrayPlotter</span><span class="p">]:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">identifier</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;plot_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">sorter</span> <span class="ow">and</span> <span class="n">plot_func</span><span class="p">:</span>
        <span class="n">registered_plotters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>


<span class="n">registered_plotters</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">_identifier</span><span class="p">,</span> <span class="n">_plotter_settings</span> <span class="ow">in</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;project.plotters&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">register_plotter</span><span class="p">(</span><span class="n">_identifier</span><span class="p">,</span> <span class="o">**</span><span class="n">_plotter_settings</span><span class="p">)</span>


<div class="viewcode-block" id="get_project_nums"><a class="viewcode-back" href="../../api/psyplot.project.html#psyplot.project.get_project_nums">[docs]</a><span class="k">def</span> <span class="nf">get_project_nums</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Returns the project numbers of the open projects&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">num</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">_open_projects</span><span class="p">]</span></div>

<span class="c1">#: :class:`ProjectPlotter` of the current project. See the class documentation</span>
<span class="c1">#: for available plotting methods</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">ProjectPlotter</span><span class="p">()</span>

<span class="c1">#: The project class that is used for creating new projects</span>
<span class="n">PROJECT_CLS</span> <span class="o">=</span> <span class="n">Project</span>

<span class="n">psyplot</span><span class="o">.</span><span class="n">_project_imported</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 Helmholtz-Zentrum Hereon, 2020-2021 Helmholtz-Zentrum Geesthacht, 2016-2021 University of Lausanne.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>