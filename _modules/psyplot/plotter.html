<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>psyplot.plotter &mdash; psyplot  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/nc-table-styles.css?v=d585f46f" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
    <link rel="shortcut icon" href="../../_static/psyplot.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            psyplot
              <img src="../../_static/psyplot.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About psyplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#why-psyplot">Why psyplot?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#what-it-is-and-what-it-is-not">What it is, and what it is not</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../about.html#what-it-is">What it is</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../about.html#what-it-is-not">What it is not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#about-the-author">About the author</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#how-to-install">How to install</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-using-conda">Installation using conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#required-dependencies">Required dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#optional-dependencies">Optional dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#running-the-tests">Running the tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#building-the-docs">Building the docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#uninstallation">Uninstallation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#uninstallation-via-conda">Uninstallation via conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#uninstallation-via-pip">Uninstallation via pip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#initialization-and-interactive-usage">Initialization and interactive usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#choosing-the-dimension">Choosing the dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#configuring-the-appearance-of-the-plot">Configuring the appearance of the plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#controlling-the-update">Controlling the update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#automatic-update">Automatic update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#direct-control-on-formatoption-update">Direct control on formatoption update</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#creating-and-managing-multiple-plots">Creating and managing multiple plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#creating-multiple-plots">Creating multiple plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started.html#slicing-and-filtering-the-project">Slicing and filtering the project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#saving-and-loading-your-project">Saving and loading your project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#using-presets">Using presets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started.html#adding-your-own-script-the-post-formatoption">Adding your own script: The <code class="xref py py-attr docutils literal notranslate"><span class="pre">post</span></code> formatoption</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://psyplot.github.io/examples/">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../configuration.html#the-rcparams">The <code class="docutils literal notranslate"><span class="pre">rcParams</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration.html#default-formatoptions">Default formatoptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">Subprojects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../accessors.html">xarray Accessors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../accessors.html#the-datasetaccessor-dataset-accessor">The <code class="xref py py-class docutils literal notranslate"><span class="pre">DatasetAccessor</span></code> dataset accessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../accessors.html#the-interactivearray-dataarray-accessor">The <code class="xref py py-class docutils literal notranslate"><span class="pre">InteractiveArray</span></code> dataarray accessor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../accessors.html#creating-plots-with-the-dataarray-accessor">Creating plots with the dataarray accessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../accessors.html#updating-plots-and-arrays-with-the-dataarray-accessor">Updating plots and arrays with the dataarray accessor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">Psyplot plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html#existing-plugins">Existing plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugins.html#how-to-exclude-plugins">How to exclude plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../plugins.html#the-psyplot-plugins-environment-variable">The <code class="docutils literal notranslate"><span class="pre">PSYPLOT_PLUGINS</span></code> environment variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins.html#the-psyplot-plotmethods-environment-variable">The <code class="docutils literal notranslate"><span class="pre">PSYPLOT_PLOTMETHODS</span></code> environment variable</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command line usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#positional-arguments">Positional Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#named-arguments">Named Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#info-options">Info options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#output-options">Output options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../develop/index.html">Developers guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../develop/framework.html">The psyplot framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../develop/framework.html#the-project-function">The <code class="xref py py-func docutils literal notranslate"><span class="pre">project()</span></code> function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../develop/framework.html#the-interactivebase-and-the-plotter-classes">The <code class="xref py py-class docutils literal notranslate"><span class="pre">InteractiveBase</span></code> and the <code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code> classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../develop/framework.html#interactive-data-objects">Interactive data objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../develop/framework.html#visualization-objects">Visualization objects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../develop/framework.html#formatoptions">Formatoptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../develop/plugins_guide.html">How to implement your own plotters and plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../develop/plugins_guide.html#creating-plotters">Creating plotters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../develop/plugins_guide.html#interface-for-the-plotter">Interface for the plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../develop/plugins_guide.html#interface-to-the-data">Interface to the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../develop/plugins_guide.html#interfacing-to-other-formatoptions">Interfacing to other formatoptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../develop/plugins_guide.html#creating-new-plugins">Creating new plugins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../develop/plugins_guide.html#creating-a-package-with-the-psyplot-plugin-template">Creating a package with the psyplot-plugin-template</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../develop/plugins_guide.html#rcparams-handling-in-plugins"><code class="docutils literal notranslate"><span class="pre">rcParams</span></code> handling in plugins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribution and development hints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#what-should-i-know-before-i-get-started">What should I know before I get started?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#the-psyplot-framework">The psyplot framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#contributing-in-the-development">Contributing in the development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#helpers">Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#shortcuts-with-make">Shortcuts with make</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#annotating-licenses">Annotating licenses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#fixing-the-docs">Fixing the docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#contributing-to-the-code">Contributing to the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#updating-the-skeleton-for-this-package">Updating the skeleton for this package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/psyplot.html">psyplot package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/psyplot.html#psyplot.get_versions"><code class="docutils literal notranslate"><span class="pre">get_versions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psyplot.html#psyplot.with_gui"><code class="docutils literal notranslate"><span class="pre">with_gui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psyplot.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.config.html">psyplot.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.sphinxext.html">psyplot.sphinxext package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psyplot.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html"><code class="docutils literal notranslate"><span class="pre">AbsoluteTimeDecoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.AbsoluteTimeEncoder"><code class="docutils literal notranslate"><span class="pre">AbsoluteTimeEncoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.ArrayList"><code class="docutils literal notranslate"><span class="pre">ArrayList</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.CFDecoder"><code class="docutils literal notranslate"><span class="pre">CFDecoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.DatasetAccessor"><code class="docutils literal notranslate"><span class="pre">DatasetAccessor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.InteractiveArray"><code class="docutils literal notranslate"><span class="pre">InteractiveArray</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.InteractiveBase"><code class="docutils literal notranslate"><span class="pre">InteractiveBase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.InteractiveList"><code class="docutils literal notranslate"><span class="pre">InteractiveList</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.Signal"><code class="docutils literal notranslate"><span class="pre">Signal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.UGridDecoder"><code class="docutils literal notranslate"><span class="pre">UGridDecoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.decode_absolute_time"><code class="docutils literal notranslate"><span class="pre">decode_absolute_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.encode_absolute_time"><code class="docutils literal notranslate"><span class="pre">encode_absolute_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.get_filename_ds"><code class="docutils literal notranslate"><span class="pre">get_filename_ds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.get_fname_funcs"><code class="docutils literal notranslate"><span class="pre">get_fname_funcs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.get_index_from_coord"><code class="docutils literal notranslate"><span class="pre">get_index_from_coord()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.get_tdata"><code class="docutils literal notranslate"><span class="pre">get_tdata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.open_dataset"><code class="docutils literal notranslate"><span class="pre">open_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.open_mfdataset"><code class="docutils literal notranslate"><span class="pre">open_mfdataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.setup_coords"><code class="docutils literal notranslate"><span class="pre">setup_coords()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.t_patterns"><code class="docutils literal notranslate"><span class="pre">t_patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.to_netcdf"><code class="docutils literal notranslate"><span class="pre">to_netcdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.data.html#psyplot.data.to_slice"><code class="docutils literal notranslate"><span class="pre">to_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.docstring.html"><code class="docutils literal notranslate"><span class="pre">PsyplotDocstringProcessor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.docstring.html#psyplot.docstring.append_original_doc"><code class="docutils literal notranslate"><span class="pre">append_original_doc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.docstring.html#psyplot.docstring.dedent"><code class="docutils literal notranslate"><span class="pre">dedent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.docstring.html#psyplot.docstring.docstrings"><code class="docutils literal notranslate"><span class="pre">docstrings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.docstring.html#psyplot.docstring.indent"><code class="docutils literal notranslate"><span class="pre">indent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.gdal_store.html"><code class="docutils literal notranslate"><span class="pre">GdalStore</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html"><code class="docutils literal notranslate"><span class="pre">BEFOREPLOTTING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption"><code class="docutils literal notranslate"><span class="pre">DictFormatoption</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.END"><code class="docutils literal notranslate"><span class="pre">END</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption"><code class="docutils literal notranslate"><span class="pre">Formatoption</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.FormatoptionMeta"><code class="docutils literal notranslate"><span class="pre">FormatoptionMeta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter"><code class="docutils literal notranslate"><span class="pre">Plotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcDependencies"><code class="docutils literal notranslate"><span class="pre">PostProcDependencies</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcessing"><code class="docutils literal notranslate"><span class="pre">PostProcessing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.PostTiming"><code class="docutils literal notranslate"><span class="pre">PostTiming</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.START"><code class="docutils literal notranslate"><span class="pre">START</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.default_print_func"><code class="docutils literal notranslate"><span class="pre">default_print_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.format_time"><code class="docutils literal notranslate"><span class="pre">format_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.groups"><code class="docutils literal notranslate"><span class="pre">groups</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.plotter.html#psyplot.plotter.is_data_dependent"><code class="docutils literal notranslate"><span class="pre">is_data_dependent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html"><code class="docutils literal notranslate"><span class="pre">DataArrayPlotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.DataArrayPlotterInterface"><code class="docutils literal notranslate"><span class="pre">DataArrayPlotterInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.DatasetPlotter"><code class="docutils literal notranslate"><span class="pre">DatasetPlotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.DatasetPlotterInterface"><code class="docutils literal notranslate"><span class="pre">DatasetPlotterInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.PROJECT_CLS"><code class="docutils literal notranslate"><span class="pre">PROJECT_CLS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.PlotterInterface"><code class="docutils literal notranslate"><span class="pre">PlotterInterface</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.Project"><code class="docutils literal notranslate"><span class="pre">Project</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.ProjectPlotter"><code class="docutils literal notranslate"><span class="pre">ProjectPlotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.close"><code class="docutils literal notranslate"><span class="pre">close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.gcp"><code class="docutils literal notranslate"><span class="pre">gcp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.get_project_nums"><code class="docutils literal notranslate"><span class="pre">get_project_nums()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.multiple_subplots"><code class="docutils literal notranslate"><span class="pre">multiple_subplots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.plot"><code class="docutils literal notranslate"><span class="pre">plot</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.project"><code class="docutils literal notranslate"><span class="pre">project()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.register_plotter"><code class="docutils literal notranslate"><span class="pre">register_plotter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.scp"><code class="docutils literal notranslate"><span class="pre">scp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.project.html#psyplot.project.unregister_plotter"><code class="docutils literal notranslate"><span class="pre">unregister_plotter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html"><code class="docutils literal notranslate"><span class="pre">Defaultdict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.check_key"><code class="docutils literal notranslate"><span class="pre">check_key()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.get_default_value"><code class="docutils literal notranslate"><span class="pre">get_default_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.hashable"><code class="docutils literal notranslate"><span class="pre">hashable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.is_iterable"><code class="docutils literal notranslate"><span class="pre">is_iterable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.is_remote_url"><code class="docutils literal notranslate"><span class="pre">is_remote_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.isstring"><code class="docutils literal notranslate"><span class="pre">isstring()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.join_dicts"><code class="docutils literal notranslate"><span class="pre">join_dicts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.plugin_entrypoints"><code class="docutils literal notranslate"><span class="pre">plugin_entrypoints()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.sort_kwargs"><code class="docutils literal notranslate"><span class="pre">sort_kwargs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.utils.html#psyplot.utils.unique_everseen"><code class="docutils literal notranslate"><span class="pre">unique_everseen()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html"><code class="docutils literal notranslate"><span class="pre">PsyPlotCritical</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.PsyPlotRuntimeWarning"><code class="docutils literal notranslate"><span class="pre">PsyPlotRuntimeWarning</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.PsyPlotWarning"><code class="docutils literal notranslate"><span class="pre">PsyPlotWarning</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.critical"><code class="docutils literal notranslate"><span class="pre">critical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.customwarn"><code class="docutils literal notranslate"><span class="pre">customwarn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.disable_warnings"><code class="docutils literal notranslate"><span class="pre">disable_warnings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psyplot.warning.html#psyplot.warning.warn"><code class="docutils literal notranslate"><span class="pre">warn()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../todos.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-5-1">v1.5.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#added">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-5-0">v1.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id2">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-4-3">v1.4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-4-2">v1.4.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id3">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-4-1">v1.4.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id4">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id5">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-4-0">v1.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id6">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id7">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id8">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-3-2">v1.3.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id9">Fixed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-3-1">v1.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id10">Fixed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-3-0">v1.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id11">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id12">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-2-1">v1.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-2-0">v1.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id13">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#removed">Removed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id14">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-1-0">v1.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id15">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#v1-0-0">v1.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id16">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id17">Changed</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">psyplot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../psyplot.html">psyplot</a></li>
      <li class="breadcrumb-item active">psyplot.plotter</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for psyplot.plotter</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Core package for interactive visualization in the psyplot package</span>

<span class="sd">This package defines the :class:`Plotter` and :class:`Formatoption` classes,</span>
<span class="sd">the core of the visualization in the :mod:`psyplot` package. Each</span>
<span class="sd">:class:`Plotter` combines a set of formatoption keys where each formatoption</span>
<span class="sd">key is represented by a :class:`Formatoption` subclass.&quot;&quot;&quot;</span>

<span class="c1"># SPDX-FileCopyrightText: 2016-2024 University of Lausanne</span>
<span class="c1"># SPDX-FileCopyrightText: 2020-2021 Helmholtz-Zentrum Geesthacht</span>

<span class="c1"># SPDX-FileCopyrightText: 2021-2024 Helmholtz-Zentrum hereon GmbH</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: LGPL-3.0-only</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">groupby</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">starmap</span><span class="p">,</span> <span class="n">tee</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">TextWrapper</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">RLock</span>

<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">datetime64</span><span class="p">,</span> <span class="n">inf</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">timedelta64</span>
<span class="kn">from</span> <span class="nn">xarray.core.formatting</span> <span class="kn">import</span> <span class="n">format_timedelta</span><span class="p">,</span> <span class="n">format_timestamp</span>

<span class="kn">from</span> <span class="nn">psyplot</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">from</span> <span class="nn">psyplot.config.rcsetup</span> <span class="kn">import</span> <span class="n">SubDict</span>
<span class="kn">from</span> <span class="nn">psyplot.data</span> <span class="kn">import</span> <span class="n">CFDecoder</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">,</span> <span class="n">_no_auto_update_getter</span>
<span class="kn">from</span> <span class="nn">psyplot.docstring</span> <span class="kn">import</span> <span class="n">dedent</span><span class="p">,</span> <span class="n">docstrings</span>
<span class="kn">from</span> <span class="nn">psyplot.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Defaultdict</span><span class="p">,</span>
    <span class="n">_temp_bool_prop</span><span class="p">,</span>
    <span class="n">_TempBool</span><span class="p">,</span>
    <span class="n">check_key</span><span class="p">,</span>
    <span class="n">unique_everseen</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">psyplot.warning</span> <span class="kn">import</span> <span class="n">PsyPlotRuntimeWarning</span><span class="p">,</span> <span class="n">warn</span>

<span class="c1">#: the default function to use when printing formatoption infos (the default is</span>
<span class="c1">#: use print or in the gui, use the help explorer)</span>
<span class="n">default_print_func</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">print_</span>


<span class="c1">#: :class:`dict`. Mapping from group to group names</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Data manipulation formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;axes&quot;</span><span class="p">:</span> <span class="s2">&quot;Axes formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="s2">&quot;Label formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;plotting&quot;</span><span class="p">:</span> <span class="s2">&quot;Plot formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;post_processing&quot;</span><span class="p">:</span> <span class="s2">&quot;Post processing formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="s2">&quot;Color coding formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;misc&quot;</span><span class="p">:</span> <span class="s2">&quot;Miscallaneous formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;Axis tick formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="s2">&quot;Vector plot formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;masking&quot;</span><span class="p">:</span> <span class="s2">&quot;Masking formatoptions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;regression&quot;</span><span class="p">:</span> <span class="s2">&quot;Fitting formatoptions&quot;</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_identity</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;identity function to make no validation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object</span>
<span class="sd">        just return the last argument in ``*args``&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<div class="viewcode-block" id="format_time">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.format_time">[docs]</a>
<span class="k">def</span> <span class="nf">format_time</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Formats date values</span>

<span class="sd">    This function formats :class:`datetime.datetime` and</span>
<span class="sd">    :class:`datetime.timedelta` objects (and the corresponding numpy objects)</span>
<span class="sd">    using the :func:`xarray.core.formatting.format_timestamp` and the</span>
<span class="sd">    :func:`xarray.core.formatting.format_timedelta` functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: object</span>
<span class="sd">        The value to format. If not a time object, the value is returned</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str or `x`</span>
<span class="sd">        Either the formatted time object or the initial `x`&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime64</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">format_timestamp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">timedelta64</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">format_timedelta</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="k">else</span> <span class="n">x</span><span class="p">[()]</span>
    <span class="k">return</span> <span class="n">x</span></div>



<div class="viewcode-block" id="is_data_dependent">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.is_data_dependent">[docs]</a>
<span class="k">def</span> <span class="nf">is_data_dependent</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether a formatoption is data dependent</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fmto: Formatoption</span>
<span class="sd">        The :class:`Formatoption` instance to check</span>
<span class="sd">    data: xarray.DataArray</span>
<span class="sd">        The data array to use if the :attr:`~Formatoption.data_dependent`</span>
<span class="sd">        attribute is a callable</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True, if the formatoption depends on the data&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">data_dependent</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fmto</span><span class="o">.</span><span class="n">data_dependent</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fmto</span><span class="o">.</span><span class="n">data_dependent</span></div>



<span class="k">def</span> <span class="nf">_child_property</span><span class="p">(</span><span class="n">childname</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span><span class="p">[</span><span class="n">childname</span><span class="p">])</span>

    <span class="k">return</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">get_x</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">childname</span> <span class="o">+</span> <span class="s2">&quot; Formatoption instance in the plotter&quot;</span>
    <span class="p">)</span>


<div class="viewcode-block" id="FormatoptionMeta">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.FormatoptionMeta">[docs]</a>
<span class="k">class</span> <span class="nc">FormatoptionMeta</span><span class="p">(</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meta class for formatoptions</span>

<span class="sd">    This class serves as a meta class for formatoptions and allows a more</span>
<span class="sd">    efficient docstring generation by using the</span>
<span class="sd">    :attr:`psyplot.docstring.docstrings` when creating a new formatoption</span>
<span class="sd">    class&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">clsname</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign an automatic documentation to the formatoption&quot;&quot;&quot;</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;__doc__&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="s2">&quot;__doc__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">docstrings</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">new_cls</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FormatoptionMeta</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">clsname</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">childname</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span>
            <span class="n">new_cls</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
            <span class="n">new_cls</span><span class="o">.</span><span class="n">dependencies</span><span class="p">,</span>
            <span class="n">new_cls</span><span class="o">.</span><span class="n">connections</span><span class="p">,</span>
            <span class="n">new_cls</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">new_cls</span><span class="p">,</span> <span class="n">childname</span><span class="p">,</span> <span class="n">_child_property</span><span class="p">(</span><span class="n">childname</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">new_cls</span><span class="o">.</span><span class="n">plot_fmt</span><span class="p">:</span>
            <span class="n">new_cls</span><span class="o">.</span><span class="n">data_dependent</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">new_cls</span></div>



<span class="c1"># priority values</span>

<span class="c1">#: Priority value of formatoptions that are updated before the data is loaded.</span>
<span class="n">START</span> <span class="o">=</span> <span class="mi">30</span>
<span class="c1">#: Priority value of formatoptions that are updated before the plot it made.</span>
<span class="n">BEFOREPLOTTING</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1">#: Priority value of formatoptions that are updated at the end.</span>
<span class="n">END</span> <span class="o">=</span> <span class="mi">10</span>


<div class="viewcode-block" id="Formatoption">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption">[docs]</a>
<span class="nd">@six</span><span class="o">.</span><span class="n">add_metaclass</span><span class="p">(</span><span class="n">FormatoptionMeta</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Formatoption</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract formatoption</span>

<span class="sd">    This class serves as an abstract version of an formatoption descriptor</span>
<span class="sd">    that can be used by :class:`~psyplot.plotter.Plotter` instances.&quot;&quot;&quot;</span>

    <span class="n">priority</span> <span class="o">=</span> <span class="n">END</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:class:`int`. Priority value of the the formatoption determining when</span>
<span class="sd">    the formatoption is updated.</span>

<span class="sd">    - 10: at the end (for labels, etc.)</span>
<span class="sd">    - 20: before the plotting (e.g. for colormaps, etc.)</span>
<span class="sd">    - 30: before loading the data (e.g. for lonlatbox)&quot;&quot;&quot;</span>

    <span class="c1">#: :class:`str`. Formatoption key of this class in the</span>
    <span class="c1">#: :class:`~psyplot.plotter.Plotter` class</span>
    <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_plotter</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`~psyplot.plotter.Plotter`. Plotter instance this</span>
<span class="sd">        formatoption belongs to&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span><span class="p">()</span>

    <span class="nd">@plotter</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plotter</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">#: `list of str`. List of formatoptions that have to be updated before this</span>
    <span class="c1">#: one is updated. Those formatoptions are only updated if they exist in</span>
    <span class="c1">#: the update parameters.</span>
    <span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#: `list of str`. List of formatoptions that force an update of this</span>
    <span class="c1">#: formatoption if they are updated.</span>
    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#: `list of str`. Connections to other formatoptions that are (different</span>
    <span class="c1">#: from :attr:`dependencies` and :attr:`children`) not important for the</span>
    <span class="c1">#: update process</span>
    <span class="n">connections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#: `list of str`. List of formatoptions that, if included in the update,</span>
    <span class="c1">#: prevent the update of this formatoption.</span>
    <span class="n">parents</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#: :class:`bool`. Has to be True if the formatoption has a ``make_plot``</span>
    <span class="c1">#: method to make the plot.</span>
    <span class="n">plot_fmt</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: :class:`bool`. True if an update of this formatoption requires a</span>
    <span class="c1">#: clearing of the axes and reinitialization of the plot</span>
    <span class="n">requires_clearing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: :class:`str`. Key of the group name in :data:`groups` of this</span>
    <span class="c1">#: formatoption keyword</span>
    <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;misc&quot;</span>

    <span class="c1">#: :class:`bool` or a callable. This attribute indicates whether this</span>
    <span class="c1">#: :class:`Formatoption` depends on the data and should be updated if the</span>
    <span class="c1">#: data changes. If it is a callable, it must accept one argument: the</span>
    <span class="c1">#: new data. (Note: This is automatically set to True for plot</span>
    <span class="c1">#: formatoptions)</span>
    <span class="n">data_dependent</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: :class:`bool`. True if this formatoption needs an update after the plot</span>
    <span class="c1">#: has changed</span>
    <span class="n">update_after_plot</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: :class:`set` of the :class:`Formatoption` instance that are shared</span>
    <span class="c1">#: with this instance.</span>
    <span class="n">shared</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1">#: int or None. Index that is used in case the plotting data is a</span>
    <span class="c1">#: :class:`psyplot.InteractiveList`</span>
    <span class="n">index_in_list</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">#: :class:`str`. A bit more verbose name than the formatoption key to be</span>
    <span class="c1">#: included in the gui. If None, the key is used in the gui</span>
    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#: Boolean that is True if an update of the formatoption requires a replot</span>
    <span class="n">requires_replot</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`dict` key word arguments that are passed to the</span>
<span class="sd">        initialization of a new instance when accessed from the descriptor&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Project of the plotter of this instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">project</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The axes this Formatoption plots on&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A :class:`threading.Rlock` instance to lock while updating</span>

<span class="sd">        This lock is used when multiple :class:`plotter` instances are</span>
<span class="sd">        updated at the same time while sharing formatoptions.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">RLock</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logger of the plotter&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groupname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Long name of the group this formatoption belongs too.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">groups</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Unknown formatoption group &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">),</span>
                <span class="n">PsyPlotRuntimeWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The original data of the plotter of this formatoption&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The :class:`~psyplot.data.CFDecoder` instance that decodes the</span>
<span class="sd">        :attr:`raw_data`&quot;&quot;&quot;</span>
        <span class="c1"># If the decoder is modified by one of the formatoptions, use this one</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
            <span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ret</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span>
        <span class="n">check</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">check</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">check</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">decoder</span>

    <span class="nd">@decoder</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_decoder</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">any_decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first possible decoder&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">CFDecoder</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The data that is plotted&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">iter_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an iterator over the plot data arrays&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">iter_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an iterator over the original data arrays&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validation method of the formatoption&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">get_vfunc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Could not find a validation function for </span><span class="si">%s</span><span class="s2"> &quot;</span>
                    <span class="s2">&quot;formatoption keyword! No validation will be made!&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">),</span>
                    <span class="n">PsyPlotRuntimeWarning</span><span class="p">,</span>
                    <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span> <span class="o">=</span> <span class="n">_identity</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span>

    <span class="nd">@validate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default value of this formatoption&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">rc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The key of this formatoption in the :attr:`psyplot.rcParams`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">rc</span><span class="o">.</span><span class="n">_get_val_and_base</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shared_by</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;None if the formatoption is not controlled by another formatoption</span>
<span class="sd">        of another plotter, otherwise the corresponding :class:`Formatoption`</span>
<span class="sd">        instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_shared</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Value of the formatoption in the corresponding :attr:`plotter` or</span>
<span class="sd">        the shared value&quot;&quot;&quot;</span>
        <span class="n">shared_by</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_by</span>
        <span class="k">if</span> <span class="n">shared_by</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">shared_by</span><span class="o">.</span><span class="n">value2share</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :class:`bool` indicating whether the value changed compared to the</span>
<span class="sd">        default or not.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">value2share</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The value that is passed to shared formatoptions (by default, the</span>
<span class="sd">        :attr:`value` attribute)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@property</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">value2pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The value that can be used when pickling the information of the project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Formatoption&quot;</span><span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">plotter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">index_in_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">additional_children</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">additional_dependencies</span><span class="o">=</span><span class="p">[],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key: str</span>
<span class="sd">            formatoption key in the `plotter`</span>
<span class="sd">        plotter: psyplot.plotter.Plotter</span>
<span class="sd">            Plotter instance that holds this formatoption. If None, it is</span>
<span class="sd">            assumed that this instance serves as a descriptor.</span>
<span class="sd">        index_in_list: int or None</span>
<span class="sd">            The index that shall be used if the data is a</span>
<span class="sd">            :class:`psyplot.InteractiveList`</span>
<span class="sd">        additional_children: list or str</span>
<span class="sd">            Additional children to use (see the :attr:`children` attribute)</span>
<span class="sd">        additional_dependencies: list or str</span>
<span class="sd">            Additional dependencies to use (see the :attr:`dependencies`</span>
<span class="sd">            attribute)</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Further keywords may be used to specify different names for</span>
<span class="sd">            children, dependencies and connection formatoptions that match the</span>
<span class="sd">            setup of the plotter. Hence, keywords may be anything of the</span>
<span class="sd">            :attr:`children`, :attr:`dependencies` and :attr:`connections`</span>
<span class="sd">            attributes, with values being the name of the new formatoption in</span>
<span class="sd">            this plotter.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span> <span class="o">=</span> <span class="n">plotter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span> <span class="o">=</span> <span class="n">index_in_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_children</span> <span class="o">=</span> <span class="n">additional_children</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_dependencies</span> <span class="o">=</span> <span class="n">additional_dependencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">+</span> <span class="n">additional_children</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">+</span> <span class="n">additional_dependencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="o">*</span><span class="n">tee</span><span class="p">(</span>
                    <span class="n">chain</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="mi">2</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># check kwargs</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.__init__() got an unexpected keyword argument </span><span class="si">%r</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># set up child mapping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># reset the dependency lists to match the current plotter setup</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;children&quot;</span><span class="p">,</span> <span class="s2">&quot;dependencies&quot;</span><span class="p">,</span> <span class="s2">&quot;connections&quot;</span><span class="p">,</span> <span class="s2">&quot;parents&quot;</span><span class="p">]:</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">attr</span><span class="p">,</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_child_mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)],</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Formatoption</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                <span class="n">instance</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span><span class="p">,</span>
                <span class="n">additional_children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">additional_children</span><span class="p">,</span>
                <span class="n">additional_dependencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">additional_dependencies</span><span class="p">,</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">init_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">fmto</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fmto</span>

    <span class="k">def</span> <span class="fm">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">instance</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
            <span class="n">instance</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">default</span>

<div class="viewcode-block" id="Formatoption.set_value">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.set_value">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Formatoption.set_value&quot;</span><span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set (and validate) the value in the plotter. This method is called by</span>
<span class="sd">        the plotter when it attempts to change the value of the formatoption.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>
<span class="sd">            Value to set</span>
<span class="sd">        validate: bool</span>
<span class="sd">            if True, validate the `value` before it is set</span>
<span class="sd">        todefault: bool</span>
<span class="sd">            True if the value is updated to the default value&quot;&quot;&quot;</span>
        <span class="c1"># do nothing if the key is shared</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_shared</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">value</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">validate</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Formatoption.set_data">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.set_data">[docs]</a>
    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the data to plot</span>

<span class="sd">        This method may be used to replace the data that is visualized by the</span>
<span class="sd">        plotter. It changes it&#39;s behaviour depending on whether an</span>
<span class="sd">        :class:`psyplot.data.InteractiveList` is visualized or a single</span>
<span class="sd">        :class:`pysplot.data.InteractiveArray`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data: psyplot.data.InteractiveBase</span>
<span class="sd">            The data to insert</span>
<span class="sd">        i: int</span>
<span class="sd">            The position in the InteractiveList where to insert the data (if</span>
<span class="sd">            the plotter visualizes a list anyway)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method uses the :attr:`Formatoption.data` attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_in_list</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">data</span></div>


<div class="viewcode-block" id="Formatoption.set_decoder">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.set_decoder">[docs]</a>
    <span class="k">def</span> <span class="nf">set_decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the data to plot</span>

<span class="sd">        This method may be used to replace the data that is visualized by the</span>
<span class="sd">        plotter. It changes it&#39;s behaviour depending on whether an</span>
<span class="sd">        :class:`psyplot.data.InteractiveList` is visualized or a single</span>
<span class="sd">        :class:`pysplot.data.InteractiveArray`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        decoder: psyplot.data.CFDecoder</span>
<span class="sd">            The decoder to insert</span>
<span class="sd">        i: int</span>
<span class="sd">            The position in the InteractiveList where to insert the data (if</span>
<span class="sd">            the plotter visualizes a list anyway)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we do not modify the raw data but instead set it on the plotter</span>
        <span class="c1"># TODO: This is not safe for encapsulated InteractiveList instances!</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
        <span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">)</span>
            <span class="n">decoders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span> <span class="ow">or</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">decoders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decoder</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span> <span class="o">=</span> <span class="n">decoders</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decoder</span><span class="p">,</span> <span class="n">CFDecoder</span><span class="p">):</span>
                <span class="n">decoder</span> <span class="o">=</span> <span class="p">[</span><span class="n">decoder</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span> <span class="o">=</span> <span class="n">decoder</span></div>


<div class="viewcode-block" id="Formatoption.get_decoder">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.get_decoder">[docs]</a>
    <span class="k">def</span> <span class="nf">get_decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># we do not modify the raw data but instead set it on the plotter</span>
        <span class="c1"># TODO: This is not safe for encapsulated InteractiveList instances!</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">InteractiveList</span>
        <span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">)</span>
            <span class="n">decoders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data_decoder</span> <span class="ow">or</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
            <span class="k">return</span> <span class="n">decoders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">decoder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span></div>


<div class="viewcode-block" id="Formatoption.check_and_set">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.check_and_set">[docs]</a>
    <span class="k">def</span> <span class="nf">check_and_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks the value and sets the value if it changed</span>

<span class="sd">        This method checks the value and sets it only if the :meth:`diff`</span>
<span class="sd">        method result of the given `value` is True</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>
<span class="sd">            A possible value to set</span>
<span class="sd">        todefault: bool</span>
<span class="sd">            True if the value is updated to the default value</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            A boolean to indicate whether it has been set or not&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="n">todefault</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Formatoption.diff">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.diff">[docs]</a>
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks whether the given value differs from what is currently set</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>
<span class="sd">            A possible value to set (make sure that it has been validate via</span>
<span class="sd">            the :attr:`validate` attribute before)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the value differs from what is currently set&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span></div>


<div class="viewcode-block" id="Formatoption.initialize_plot">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.initialize_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">initialize_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method that is called when the plot is made the first time</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>
<span class="sd">            The value to use for the initialization&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Formatoption.update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method that is call to update the formatoption on the axes</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value</span>
<span class="sd">            Value to update&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Formatoption.get_fmt_widget">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.get_fmt_widget">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fmt_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a widget to update the formatoption in the GUI</span>

<span class="sd">        This method should return a QWidget that is loaded by the psyplot-gui</span>
<span class="sd">        when the formatoption is selected in the</span>
<span class="sd">        :attr:`psyplot_gui.main.Mainwindow.fmt_widget`. It should call the</span>
<span class="sd">        :meth:`~psyplot_gui.fmt_widget.FormatoptionWidget.insert_text` method</span>
<span class="sd">        when the update text for the formatoption should be changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent: psyplot_gui.fmt_widget.FormatoptionWidget</span>
<span class="sd">            The parent widget that contains the returned QWidget</span>
<span class="sd">        project: psyplot.project.Project</span>
<span class="sd">            The current subproject (see :func:`psyplot.project.gcp`)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PyQt5.QtWidgets.QWidget</span>
<span class="sd">            The widget to control the formatoption&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Formatoption.share">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.share">[docs]</a>
    <span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmto</span><span class="p">,</span> <span class="n">initializing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Share the settings of this formatoption with other data objects</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmto: Formatoption</span>
<span class="sd">            The :class:`Formatoption` instance to share the attributes with</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any other keyword argument that shall be passed to the update</span>
<span class="sd">            method of `fmto`&quot;&quot;&quot;</span>
        <span class="c1"># lock all  the childrens and the formatoption itself</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">fmto</span><span class="o">.</span><span class="n">_lock_children</span><span class="p">()</span>
        <span class="n">fmto</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="c1"># update the other plotter</span>
        <span class="k">if</span> <span class="n">initializing</span><span class="p">:</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">initialize_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value2share</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value2share</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
        <span class="c1"># release the locks</span>
        <span class="n">fmto</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="n">fmto</span><span class="o">.</span><span class="n">_release_children</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_lock_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;acquire the locks of the children&quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_release_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;release the locks of the children&quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

<div class="viewcode-block" id="Formatoption.finish_update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.finish_update">[docs]</a>
    <span class="k">def</span> <span class="nf">finish_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finish the update, initialization and sharing process</span>

<span class="sd">        This function is called at the end of the :meth:`Plotter.start_update`,</span>
<span class="sd">        :meth:`Plotter.initialize_plot` or the :meth:`Plotter.share` methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Formatoption.remove">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.remove">[docs]</a>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to remove the effects of this formatoption</span>

<span class="sd">        This method is called when the axes is cleared due to a</span>
<span class="sd">        formatoption with :attr:`requires_clearing` set to True. You don&#39;t</span>
<span class="sd">        necessarily have to implement this formatoption if your plot results</span>
<span class="sd">        are removed by the usual :meth:`matplotlib.axes.Axes.clear` method.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Formatoption.convert_coordinate">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Formatoption.convert_coordinate">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_extended_summary</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Formatoption.convert_coordinate&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span>
        <span class="n">base</span><span class="o">=</span><span class="s2">&quot;Formatoption.convert_coordinate&quot;</span><span class="p">,</span>
        <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Returns&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">convert_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="o">*</span><span class="n">variables</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a coordinate to units necessary for the plot.</span>

<span class="sd">        This method takes a single coordinate variable (e.g. the `bounds` of a</span>
<span class="sd">        coordinate, or the coordinate itself) and transforms the units that the</span>
<span class="sd">        plotter requires.</span>

<span class="sd">        One might also provide additional `variables` that are supposed to be</span>
<span class="sd">        on the same unit, in case the given `coord` does not specify a `units`</span>
<span class="sd">        attribute. `coord` might be a CF-conform `bounds` variable, and one of</span>
<span class="sd">        the variables might be the corresponding `coordinate`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coord: xr.Variable</span>
<span class="sd">            The variable to transform</span>
<span class="sd">        ``*variables``</span>
<span class="sd">            The variables that are on the same unit as `coord`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xr.Variable</span>
<span class="sd">            The transformed `coord`</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        By default, this method uses the :meth:`~Plotter.convert_coordinate`</span>
<span class="sd">        method of the :attr:`plotter`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">convert_coordinate</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="o">*</span><span class="n">variables</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DictFormatoption">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption">[docs]</a>
<span class="k">class</span> <span class="nc">DictFormatoption</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base formatoption class defining an alternative set_value that works for</span>
<span class="sd">    dictionaries.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="DictFormatoption.set_value">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption.set_value">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set (and validate) the value in the plotter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Formatoption.set_value.parameters)s</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - If the current value in the plotter is None, then it will be set with</span>
<span class="sd">          the given `value`, otherwise the current value in the plotter is</span>
<span class="sd">          updated</span>
<span class="sd">        - If the value is an empty dictionary, the value in the plotter is</span>
<span class="sd">          cleared&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">validate</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># if the key in the plotter is not already set (i.e. it is initialized</span>
        <span class="c1"># with None, we set it)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># in case of an empty dict, clear the value</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># otherwhise we update the dictionary</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">todefault</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PostTiming">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostTiming">[docs]</a>
<span class="k">class</span> <span class="nc">PostTiming</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine when to run the :attr:`post` formatoption</span>

<span class="sd">    This formatoption determines, whether the :attr:`post` formatoption</span>
<span class="sd">    should be run never, after replot or after every update.</span>

<span class="sd">    Possible types</span>
<span class="sd">    --------------</span>
<span class="sd">    &#39;never&#39;</span>
<span class="sd">        Never run post processing scripts</span>
<span class="sd">    &#39;always&#39;</span>
<span class="sd">        Always run post processing scripts</span>
<span class="sd">    &#39;replot&#39;</span>
<span class="sd">        Only run post processing scripts when the data changes or a replot</span>
<span class="sd">        is necessary</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    post: The post processing formatoption&quot;&quot;&quot;</span>

    <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;never&quot;</span>

    <span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="n">inf</span>

    <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;post_processing&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Timing of the post processing&quot;</span>

<div class="viewcode-block" id="PostTiming.validate">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostTiming.validate">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">possible_values</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;never&quot;</span><span class="p">,</span> <span class="s2">&quot;always&quot;</span><span class="p">,</span> <span class="s2">&quot;replot&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">possible_values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;String must be one of </span><span class="si">%s</span><span class="s2">, not </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">possible_values</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="PostTiming.update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostTiming.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="PostTiming.get_fmt_widget">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostTiming.get_fmt_widget">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fmt_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">psyplot_gui.compat.qtcompat</span> <span class="kn">import</span> <span class="n">QComboBox</span>

        <span class="n">combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s2">&quot;never&quot;</span><span class="p">,</span> <span class="s2">&quot;always&quot;</span><span class="p">,</span> <span class="s2">&quot;replot&quot;</span><span class="p">])</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span>
            <span class="nb">next</span><span class="p">((</span><span class="n">plotter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">project</span><span class="o">.</span><span class="n">plotters</span><span class="p">),</span> <span class="s2">&quot;never&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">set_obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">combo</span></div>
</div>



<div class="viewcode-block" id="PostProcDependencies">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcDependencies">[docs]</a>
<span class="k">class</span> <span class="nc">PostProcDependencies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The dependencies of this formatoption&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">instance</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">instance</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_initialized</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">instance</span><span class="o">.</span><span class="n">post_timing</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;always&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">plotter</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">instance</span><span class="o">.</span><span class="n">key</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">pass</span></div>



<div class="viewcode-block" id="PostProcessing">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcessing">[docs]</a>
<span class="k">class</span> <span class="nc">PostProcessing</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply your own postprocessing script</span>

<span class="sd">    This formatoption let&#39;s you apply your own post processing script. Just</span>
<span class="sd">    enter the script as a string and it will be executed. The formatoption</span>
<span class="sd">    will be made available via the ``self`` variable</span>

<span class="sd">    Possible types</span>
<span class="sd">    --------------</span>
<span class="sd">    None</span>
<span class="sd">        Don&#39;t do anything</span>
<span class="sd">    str</span>
<span class="sd">        The post processing script as string</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This formatoption uses the built-in :func:`exec` function to compile the</span>
<span class="sd">    script. Since this poses a security risk when loading psyplot projects,</span>
<span class="sd">    it is by default disabled through the :attr:`Plotter.enable_post`</span>
<span class="sd">    attribute. If you are sure that you can trust the script in this</span>
<span class="sd">    formatoption, set this attribute of the corresponding :class:`Plotter` to</span>
<span class="sd">    ``True``</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Assume, you want to manually add the mean of the data to the title of the</span>
<span class="sd">    matplotlib axes. You can simply do this via</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from psyplot.plotter import Plotter</span>
<span class="sd">        from xarray import DataArray</span>

<span class="sd">        plotter = Plotter(DataArray([1, 2, 3]))</span>
<span class="sd">        # enable the post formatoption</span>
<span class="sd">        plotter.enable_post = True</span>
<span class="sd">        plotter.update(post=&quot;self.ax.set_title(str(self.data.mean()))&quot;)</span>
<span class="sd">        plotter.ax.get_title()</span>
<span class="sd">        &quot;2.0&quot;</span>

<span class="sd">    By default, the ``post`` formatoption is only ran, when it is explicitly</span>
<span class="sd">    updated. However, you can use the :attr:`post_timing` formatoption, to</span>
<span class="sd">    run it automatically. E.g. for running it after every update of the</span>
<span class="sd">    plotter, you can set</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        plotter.update(post_timing=&quot;always&quot;)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    post_timing: Determine the timing of this formatoption&quot;&quot;&quot;</span>

    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;post_timing&quot;</span><span class="p">]</span>

    <span class="n">default</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="n">inf</span>

    <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;post_processing&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Custom post processing script&quot;</span>

<div class="viewcode-block" id="PostProcessing.validate">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcessing.validate">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a string, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">),))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_dependent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if the corresponding :class:`post_timing &lt;PostTiming&gt;`</span>
<span class="sd">        formatoption is set to ``&#39;replot&#39;`` to run the post processing script</span>
<span class="sd">        after every change of the data&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">post_timing</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;replot&quot;</span>

    <span class="n">dependencies</span> <span class="o">=</span> <span class="n">PostProcDependencies</span><span class="p">()</span>

<div class="viewcode-block" id="PostProcessing.update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.PostProcessing.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">enable_post</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Post processing is disabled. Set the ``enable_post`` &quot;</span>
                <span class="s2">&quot;attribute to True to run the script&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="p">})</span></div>
</div>



<div class="viewcode-block" id="Plotter">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter">[docs]</a>
<span class="k">class</span> <span class="nc">Plotter</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interactive plotting object for one or more data arrays</span>

<span class="sd">    This class is the base for the interactive plotting with the psyplot</span>
<span class="sd">    module. It capabilities are determined by it&#39;s descriptor classes that are</span>
<span class="sd">    derived from the :class:`Formatoption` class&quot;&quot;&quot;</span>

    <span class="c1">#: List of base strings in the :attr:`psyplot.rcParams` dictionary</span>
    <span class="n">_rcparams_string</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">post_timing</span> <span class="o">=</span> <span class="n">PostTiming</span><span class="p">(</span><span class="s2">&quot;post_timing&quot;</span><span class="p">)</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">PostProcessing</span><span class="p">(</span><span class="s2">&quot;post&quot;</span><span class="p">)</span>

    <span class="n">no_validation</span> <span class="o">=</span> <span class="n">_temp_bool_prop</span><span class="p">(</span>
        <span class="s2">&quot;no_validation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Temporarily disable the validation</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Although it is not recommended to set a value with disabled validation,</span>
<span class="sd">        you can disable it via::</span>

<span class="sd">            &gt;&gt;&gt; with plotter.no_validation:</span>
<span class="sd">            ...     plotter[&quot;ticksize&quot;] = &quot;x&quot;</span>
<span class="sd">            ...</span>

<span class="sd">        To permanently disable the validation, simply set</span>

<span class="sd">            &gt;&gt;&gt; plotter.no_validation = True</span>
<span class="sd">            &gt;&gt;&gt; plotter[&quot;ticksize&quot;] = &quot;x&quot;</span>
<span class="sd">            &gt;&gt;&gt; plotter.no_validation = False  # reenable validation&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">#: Temporarily include links in the key descriptions from</span>
    <span class="c1">#: :meth:`show_keys`, :meth:`show_docs` and :meth:`show_summaries`.</span>
    <span class="c1">#: Note that this is a class attribute, so each change to the value of this</span>
    <span class="c1">#: attribute will affect all instances and subclasses</span>
    <span class="n">include_links</span> <span class="o">=</span> <span class="n">_TempBool</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Axes instance of the plot&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_sample_projection</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span>

    <span class="nd">@ax</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">#: The :class:`psyplot.project.Project` instance this plotter belongs to</span>
    <span class="n">_project</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`psyplot.project.Project` instance this plotter belongs to&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span><span class="p">()</span>

    <span class="nd">@project</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_project</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">rc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default values for this plotter</span>

<span class="sd">        This :class:`~psyplot.config.rcsetup.SubDict` stores the default values</span>
<span class="sd">        for this plotter. A modification of the dictionary does not affect</span>
<span class="sd">        other plotter instances unless you set the</span>
<span class="sd">        :attr:`~psyplot.config.rcsetup.SubDict.trace` attribute to True&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rc</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_rc</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rc</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">base_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A mapping from the base_variable names to the variables&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">chain</span><span class="p">(</span>
                    <span class="o">*</span><span class="nb">map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">arr</span><span class="p">:</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base_variables</span><span class="p">),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">iter_base_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A mapping from the base_variable names to the variables&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">iter_base_variables</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">iter_base_variables</span>

    <span class="n">no_auto_update</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">_no_auto_update_getter</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="n">_no_auto_update_getter</span><span class="o">.</span><span class="vm">__doc__</span>
    <span class="p">)</span>

    <span class="nd">@no_auto_update</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">no_auto_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`dict` containing the key value pairs that are not the</span>
<span class="sd">        default&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">changed</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">figs2draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;All figures that have been manipulated through sharing and the own</span>
<span class="sd">        figure.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Using this property set will reset the figures too draw&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figs2draw</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()])</span>

    <span class="nd">@property</span>
    <span class="nd">@docstrings</span>
    <span class="k">def</span> <span class="nf">_njobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;%(InteractiveBase._njobs)s&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_fmtos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterator over the formatoptions&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_fmto_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping from group to a set of formatoptions&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fmt_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A mapping from the formatoption group to the formatoptions&quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A mapping from the group short name to the group description&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="n">groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt_groups</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The :class:`psyplot.InteractiveBase` instance of this plotter&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The data that is used for plotting&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_plot_data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@plot_data</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_data</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c1">#: The decoder to use for the formatoptions. If None, the decoder of the</span>
    <span class="c1">#: raw data is used</span>
    <span class="n">plot_data_decoder</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#: :class:`bool` that has to be ``True`` if the post processing script in</span>
    <span class="c1">#: the :attr:`post` formatoption should be enabled</span>
    <span class="n">enable_post</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_data</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`logging.Logger` of this plotter&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s2">&quot;InteractiveBase.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;auto_update&quot;</span><span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">project</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">make_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">enable_post</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data: InteractiveArray or ArrayList, optional</span>
<span class="sd">            Data object that shall be visualized. If given and `plot` is True,</span>
<span class="sd">            the :meth:`initialize_plot` method is called at the end. Otherwise</span>
<span class="sd">            you can call this method later by yourself</span>
<span class="sd">        ax: matplotlib.axes.Axes</span>
<span class="sd">            Matplotlib Axes to plot on. If None, a new one will be created as</span>
<span class="sd">            soon as the :meth:`initialize_plot` method is called</span>
<span class="sd">        %(InteractiveBase.parameters.auto_update)s</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        make_plot: bool</span>
<span class="sd">            If True, and `data` is not None, the plot is initialized. Otherwise</span>
<span class="sd">            only the framework between plotter and data is set up</span>
<span class="sd">        clear: bool</span>
<span class="sd">            If True, the axes is cleared first</span>
<span class="sd">        enable_post: bool</span>
<span class="sd">            If True, the :attr:`post` formatoption is enabled and post</span>
<span class="sd">            processing scripts are allowed</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any formatoption key from the :attr:`formatoptions` attribute that</span>
<span class="sd">            shall be used&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_post</span> <span class="o">=</span> <span class="n">enable_post</span>
        <span class="k">if</span> <span class="n">auto_update</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">auto_update</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lists.auto_update&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">auto_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figs2draw</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1">#: formatoptions that have to be updated by other plotters that share</span>
        <span class="c1">#: the given formatoption with this Plotter. :attr:`_to_update` is a</span>
        <span class="c1">#: mapping from the formatoptions in this plotter to the corresponding</span>
        <span class="c1">#: other plotter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_update</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">#: Dictionary holding the Formatoption instances of other plotters</span>
        <span class="c1">#: if their value shall be used instead of the one in this instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#: list of str. Formatoption keys that were changed during the last</span>
        <span class="c1">#: update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_update</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#: The set of formatoptions that shall be updated even if they did not</span>
        <span class="c1">#: change</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_force</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleared</span> <span class="o">=</span> <span class="n">clear</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updating</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># will be set to True when the plot is first initialized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># first we initialize all keys with None. This is necessary in order</span>
        <span class="c1"># to make the validation functioning</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">():</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>  <span class="c1"># then we set the default values</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try2set</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">default</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_rc</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># then the user values</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_plot</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="n">clear</span><span class="p">,</span> <span class="n">make_plot</span><span class="o">=</span><span class="n">make_plot</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_try2set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmto</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the value in `fmto` and gives additional informations when fail</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmto: Formatoption</span>
<span class="sd">        ``*args`` and ``**kwargs``</span>
<span class="sd">            Anything that is passed to `fmto`s :meth:`~Formatoption.set_value`</span>
<span class="sd">            method&quot;&quot;&quot;</span>
        <span class="n">fmto</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_try2set</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># prevent from setting during an update process</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="nb">dict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">default</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">delete_params</span><span class="p">(</span><span class="s2">&quot;check_key.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;possible_keys&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.check_key">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.check_key">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">check_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the key is a valid formatoption</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(check_key.parameters.no_possible_keys|name)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(check_key.returns)s</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        %(check_key.raises)s&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">check_key</span><span class="p">(</span>
            <span class="n">key</span><span class="p">,</span>
            <span class="n">possible_keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="n">raise_error</span><span class="o">=</span><span class="n">raise_error</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;formatoption keyword&quot;</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.check_data">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.check_data">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span>
        <span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter.check_data&quot;</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Returns&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">check_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">is_unstructured</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A validation method for the data shape</span>

<span class="sd">        The default method does nothing and should be subclassed to validate</span>
<span class="sd">        the results. If the plotter accepts a :class:`InteractiveList`, it</span>
<span class="sd">        should accept a list for name and dims</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: str or list of str</span>
<span class="sd">            The variable name(s) of the data</span>
<span class="sd">        dims: list of str or list of lists of str</span>
<span class="sd">            The dimension name(s) of the data</span>
<span class="sd">        is_unstructured: bool or list of bool</span>
<span class="sd">            True if the corresponding array is unstructured</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of bool or None</span>
<span class="sd">            True, if everything is okay, False in case of a serious error,</span>
<span class="sd">            None if it is intermediate. Each object in this list corresponds to</span>
<span class="sd">            one in the given `name`</span>
<span class="sd">        list of str</span>
<span class="sd">            The message giving more information on the reason. Each object in</span>
<span class="sd">            this list corresponds to one in the given `name`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">]</span>
            <span class="n">is_unstructured</span> <span class="o">=</span> <span class="p">[</span><span class="n">is_unstructured</span><span class="p">]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="n">N</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">is_unstructured</span><span class="p">)</span> <span class="o">!=</span> <span class="n">N</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="p">[</span>
                <span class="s2">&quot;Number of provided names (</span><span class="si">%i</span><span class="s2">) and dimensions &quot;</span>
                <span class="s2">&quot;(</span><span class="si">%i</span><span class="s2">) or unstructured information (</span><span class="si">%i</span><span class="s2">) are not the same&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">is_unstructured</span><span class="p">))</span>
            <span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="k">return</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span></div>


    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s2">&quot;Plotter.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="s2">&quot;make_plot&quot;</span><span class="p">,</span> <span class="s2">&quot;clear&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.initialize_plot">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.initialize_plot">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">initialize_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">make_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">priority</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the plot for a data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data: InteractiveArray or ArrayList, optional</span>
<span class="sd">            Data object that shall be visualized.</span>

<span class="sd">            - If not None and `plot` is True, the given data is visualized.</span>
<span class="sd">            - If None and the :attr:`data` attribute is not None, the data in</span>
<span class="sd">              the :attr:`data` attribute is visualized</span>
<span class="sd">            - If both are None, nothing is done.</span>
<span class="sd">        %(Plotter.parameters.ax|make_plot|clear)s</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        remove: bool</span>
<span class="sd">            If True, old effects by the formatoptions in this plotter are</span>
<span class="sd">            undone first</span>
<span class="sd">        priority: int</span>
<span class="sd">            If given, initialize only the formatoption with the given priority.</span>
<span class="sd">            This value must be out of :data:`START`, :data:`BEFOREPLOTTING` or</span>
<span class="sd">            :data:`END`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># nothing to do if no data is given</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">no_auto_update</span>
        <span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">make_plot</span><span class="p">:</span>  <span class="c1"># stop here if we shall not plot</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing plot...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">remove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;    Removing old formatoptions...&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Could not remove </span><span class="si">%s</span><span class="s2"> while initializing&quot;</span><span class="p">,</span>
                        <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                        <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;    Clearing axes...&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cleared</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># get the formatoptions. We sort them here by key to make sure that the</span>
        <span class="c1"># order always stays the same (easier for debugging)</span>
        <span class="n">fmto_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grouped_fmtos</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sorted_by_priority</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">fmto</span><span class="p">:</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updating</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">fmto_priority</span><span class="p">,</span> <span class="n">grouper</span> <span class="ow">in</span> <span class="n">fmto_groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">priority</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">fmto_priority</span> <span class="o">==</span> <span class="n">priority</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_by_priority</span><span class="p">(</span>
                    <span class="n">fmto_priority</span><span class="p">,</span> <span class="n">grouper</span><span class="p">,</span> <span class="n">initializing</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_release_all</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># finish the update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cleared</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updating</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_draw&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">draw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_show&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span>
        <span class="s2">&quot;InteractiveBase._register_update.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;force&quot;</span><span class="p">,</span> <span class="s2">&quot;todefault&quot;</span>
    <span class="p">)</span>

    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter._register_update&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_register_update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="p">{},</span> <span class="n">replot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register formatoptions for the update</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmt: dict</span>
<span class="sd">            Keys can be any valid formatoptions with the corresponding values</span>
<span class="sd">            (see the :attr:`formatoptions` attribute)</span>
<span class="sd">        replot: bool</span>
<span class="sd">            Boolean that determines whether the data specific formatoptions</span>
<span class="sd">            shall be updated in any case or not.</span>
<span class="sd">        %(InteractiveBase._register_update.parameters.force|todefault)s&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="ow">or</span> <span class="n">replot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span> <span class="ow">or</span> <span class="n">todefault</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">force</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_force</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">[</span><span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_key</span><span class="p">,</span> <span class="n">force</span> <span class="ow">or</span> <span class="p">[])]</span>
        <span class="p">)</span>
        <span class="c1"># check the keys</span>
        <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_key</span><span class="p">,</span> <span class="n">fmt</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.make_plot">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.make_plot">[docs]</a>
    <span class="k">def</span> <span class="nf">make_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for making the plot</span>

<span class="sd">        This method is called at the end of the :attr:`BEFOREPLOTTING` stage if</span>
<span class="sd">        and only if the :attr:`plot_fmt` attribute is set to ``True``&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Plotter.start_update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.start_update">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">start_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">queues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_shared</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conduct the registered plot updates</span>

<span class="sd">        This method starts the updates from what has been registered by the</span>
<span class="sd">        :meth:`update` method. You can call this method if you did not set the</span>
<span class="sd">        `auto_update` parameter to True when calling the :meth:`update` method</span>
<span class="sd">        and when the :attr:`no_auto_update` attribute is True.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(InteractiveBase.start_update.parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(InteractiveBase.start_update.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :attr:`no_auto_update`, update&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">update_the_others</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">other_fmto</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_updating</span><span class="p">:</span>
                        <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_register_update</span><span class="p">(</span>
                            <span class="n">force</span><span class="o">=</span><span class="p">[</span><span class="n">other_fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>
                        <span class="p">)</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">other_fmto</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_updating</span><span class="p">:</span>
                        <span class="n">other_draw</span> <span class="o">=</span> <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">start_update</span><span class="p">(</span>
                            <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update_shared</span><span class="o">=</span><span class="kc">False</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">other_draw</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_figs2draw</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                                <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
                            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">queues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Starting update of </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="c1"># update the formatoptions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_state</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># get the formatoptions. We sort them here by key to make sure that</span>
            <span class="c1"># the order always stays the same (easier for debugging)</span>
            <span class="n">fmtos</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_and_filter</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">fmto</span><span class="p">:</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># restore last (working) state</span>
            <span class="n">last_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_validation</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">queues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_release_all</span><span class="p">(</span><span class="n">queue</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">queues</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">queues</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># raise the error</span>
            <span class="k">raise</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fmto2</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="p">:</span>
                <span class="n">fmto2</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_to_update</span><span class="p">[</span><span class="n">fmto2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="n">queues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updating</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
            <span class="c1"># wait for the other tasks to finish</span>
            <span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">queues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">fmtos</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">fmto</span>
                <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insert_additionals</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_to_update</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">fmto</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fmtos</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_to_update</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="n">fmto_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grouped_fmtos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sorted_by_priority</span><span class="p">(</span><span class="n">fmtos</span><span class="p">[:]))</span>
        <span class="c1"># if any formatoption requires a clearing of the axes is updated,</span>
        <span class="c1"># we reinitialize the plot</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleared</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reinit</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
                <span class="n">update_the_others</span><span class="p">()</span>
                <span class="n">arr_draw</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># otherwise we update it</span>
                <span class="n">arr_draw</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">priority</span><span class="p">,</span> <span class="n">grouper</span> <span class="ow">in</span> <span class="n">fmto_groups</span><span class="p">:</span>
                    <span class="n">arr_draw</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_by_priority</span><span class="p">(</span><span class="n">priority</span><span class="p">,</span> <span class="n">grouper</span><span class="p">)</span>
                <span class="n">update_the_others</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># make sure that all locks are released</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_release_all</span><span class="p">(</span>
                <span class="n">finish</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">queues</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">queues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_draw&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">draw</span> <span class="ow">and</span> <span class="n">arr_draw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_show&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">arr_draw</span></div>


    <span class="k">def</span> <span class="nf">_release_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">finish</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># make sure that all locks are released</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">finish</span><span class="p">:</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">finish_update</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updating</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_plot_by_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="n">fmtos</span><span class="p">,</span> <span class="n">initializing</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">fmto</span><span class="p">):</span>
            <span class="n">other_fmto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_fmto</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is shared with </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                    <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">other_fmto</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">initializing</span><span class="o">=</span><span class="n">initializing</span><span class="p">)</span>
            <span class="c1"># but if not, share them</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">initializing</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">initialize_plot</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updating </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fmto</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initializing</span> <span class="o">=</span> <span class="n">initializing</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> formatoptions with priority </span><span class="si">%i</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Initializing&quot;</span> <span class="k">if</span> <span class="n">initializing</span> <span class="k">else</span> <span class="s2">&quot;Updating&quot;</span><span class="p">,</span>
            <span class="n">priority</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">START</span> <span class="ow">or</span> <span class="n">priority</span> <span class="o">==</span> <span class="n">END</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
                <span class="n">update</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">priority</span> <span class="o">==</span> <span class="n">BEFOREPLOTTING</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
                <span class="n">update</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_plot</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initializing</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Plotter.reinit">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.reinit">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">reinit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reinitializes the plot with the same data and on the same axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        clear: bool</span>
<span class="sd">            Whether to clear the axes or not</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        The axes may be cleared when calling this method (even if `clear` is</span>
<span class="sd">        set to False)!&quot;&quot;&quot;</span>
        <span class="c1"># call the initialize_plot method. Note that clear can be set to</span>
        <span class="c1"># False if any fmto has requires_clearing attribute set to True,</span>
        <span class="c1"># because this then has been cleared before</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span><span class="p">,</span>
            <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">,</span>
            <span class="n">clear</span><span class="o">=</span><span class="n">clear</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">requires_clearing</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">),</span>
            <span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.draw">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.draw">[docs]</a>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw the figures and those that are shared and have been changed&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">figs2draw</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figs2draw</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_grouped_fmtos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmtos</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">key_func</span><span class="p">(</span><span class="n">fmto</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">START</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">START</span>
            <span class="k">elif</span> <span class="n">fmto</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">BEFOREPLOTTING</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">BEFOREPLOTTING</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">END</span>

        <span class="k">return</span> <span class="n">groupby</span><span class="p">(</span><span class="n">fmtos</span><span class="p">,</span> <span class="n">key_func</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_and_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filters the registered updates and sort out what is not needed</span>

<span class="sd">        This method filters out the formatoptions that have not changed, sets</span>
<span class="sd">        the new value and returns an iterable that is sorted by the priority</span>
<span class="sd">        (highest priority comes first) and dependencies</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            list of :class:`Formatoption` objects that have to be updated&quot;&quot;&quot;</span>
        <span class="n">fmtos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_force</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span>
            <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="p">),</span>
            <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">default</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">})</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span>
            <span class="k">else</span> <span class="p">(),</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="c1"># if the key is shared, a warning will be printed as long as</span>
            <span class="c1"># this plotter is not also updating (for example due to a whole</span>
            <span class="c1"># project update)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_force</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_updating</span><span class="p">:</span>
                    <span class="n">warn</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> formatoption is shared with another plotter.&quot;</span>
                            <span class="s2">&quot; Use the unshare method to enable the updating&quot;</span>
                        <span class="p">)</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">),</span>
                        <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">changed</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">check_and_set</span><span class="p">(</span>
                        <span class="n">value</span><span class="p">,</span>
                        <span class="n">todefault</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span><span class="p">,</span>
                        <span class="n">validate</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_validation</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to set </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">e</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="n">changed</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_force</span>
            <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
                <span class="n">fmtos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
        <span class="n">fmtos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_insert_additionals</span><span class="p">(</span><span class="n">fmtos</span><span class="p">,</span> <span class="n">seen</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">:</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_todefault</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_force</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fmtos</span>

    <span class="k">def</span> <span class="nf">_insert_additionals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmtos</span><span class="p">,</span> <span class="n">seen</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert additional formatoptions into `fmtos`.</span>

<span class="sd">        This method inserts those formatoptions into `fmtos` that are required</span>
<span class="sd">        because one of the following criteria is fullfilled:</span>

<span class="sd">        1. The :attr:`replot` attribute is True</span>
<span class="sd">        2. Any formatoption with START priority is in `fmtos`</span>
<span class="sd">        3. A dependency of one formatoption is in `fmtos`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmtos: list</span>
<span class="sd">            The list of formatoptions that shall be updated</span>
<span class="sd">        seen: set</span>
<span class="sd">            The formatoption keys that shall not be included. If None, all</span>
<span class="sd">            formatoptions in `fmtos` are used</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fmtos</span>
<span class="sd">            The initial `fmtos` plus further formatoptions</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        `fmtos` and `seen` are modified in place (except that any formatoption</span>
<span class="sd">        in the initial `fmtos` has :attr:`~Formatoption.requires_clearing`</span>
<span class="sd">        attribute set to True)&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">get_dependencies</span><span class="p">(</span><span class="n">fmto</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fmto</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">return</span> <span class="n">fmto</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">chain</span><span class="p">(</span>
                    <span class="o">*</span><span class="nb">map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">get_dependencies</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
                        <span class="n">fmto</span><span class="o">.</span><span class="n">dependencies</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">seen</span> <span class="o">=</span> <span class="n">seen</span> <span class="ow">or</span> <span class="p">{</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">}</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">{</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">requires_replot</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">START</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replot</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">new_fmtos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fmtos</span> <span class="ow">and</span> <span class="n">is_data_dependent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_fmtos</span><span class="p">)</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_fmtos</span><span class="p">)</span>
            <span class="n">fmtos</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_fmtos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="c1"># insert the formatoptions that have to be updated if the plot is</span>
        <span class="c1"># changed</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">BEFOREPLOTTING</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">):</span>
            <span class="n">new_fmtos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fmtos</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">update_after_plot</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">fmtos</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_fmtos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">fmtos</span><span class="p">):</span>
            <span class="n">all_dependencies</span> <span class="o">=</span> <span class="n">get_dependencies</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">keys</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">all_dependencies</span><span class="p">):</span>
                <span class="n">fmtos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">requires_clearing</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cleared</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fmtos</span>

    <span class="k">def</span> <span class="nf">_sorted_by_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmtos</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the formatoption objects by their priority and dependency</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmtos: list</span>
<span class="sd">            list of :class:`Formatoption` instances</span>
<span class="sd">        changed: list</span>
<span class="sd">            the list of formatoption keys that have changed</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        Formatoption</span>
<span class="sd">            The next formatoption as it comes by the sorting</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        The list `fmtos` is cleared by this method!&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">pop_fmto</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">fmtos_keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">fmtos_keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">fmtos</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">get_children</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="n">parents_keys</span><span class="p">):</span>
            <span class="n">all_fmtos</span> <span class="o">=</span> <span class="n">fmtos_keys</span> <span class="o">+</span> <span class="n">parents_keys</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">children</span> <span class="o">+</span> <span class="n">fmto</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fmtos_keys</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">child_fmto</span> <span class="o">=</span> <span class="n">pop_fmto</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">childs_child</span> <span class="ow">in</span> <span class="n">get_children</span><span class="p">(</span>
                    <span class="n">child_fmto</span><span class="p">,</span> <span class="n">parents_keys</span> <span class="o">+</span> <span class="p">[</span><span class="n">child_fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="k">yield</span> <span class="n">childs_child</span>
                <span class="c1"># filter out if parent is in update list</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">all_fmtos</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">child_fmto</span><span class="o">.</span><span class="n">parents</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">child_fmto</span><span class="o">.</span><span class="n">parents</span>
                <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">yield</span> <span class="n">child_fmto</span>

        <span class="n">fmtos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">fmto</span><span class="p">:</span> <span class="n">fmto</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fmtos_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">fmtos</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_update</span> <span class="o">=</span> <span class="n">changed</span> <span class="ow">or</span> <span class="n">fmtos_keys</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Update the formatoptions </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fmtos_keys</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">fmtos</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">fmtos_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="n">fmtos</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># first update children</span>
            <span class="k">for</span> <span class="n">child_fmto</span> <span class="ow">in</span> <span class="n">get_children</span><span class="p">(</span><span class="n">fmto</span><span class="p">,</span> <span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">]):</span>
                <span class="k">yield</span> <span class="n">child_fmto</span>
            <span class="c1"># filter out if parent is in update list</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">fmtos_keys</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fmto</span><span class="o">.</span><span class="n">parents</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">fmto</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_formatoptions</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">include_bases</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterator over formatoptions</span>

<span class="sd">        This class method returns an iterator that contains all the</span>
<span class="sd">        formatoption keys that are in this class and that are defined</span>
<span class="sd">        in the base classes</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        There is absolutely no need to call this method besides the plotter</span>
<span class="sd">        initialization, since all formatoptions are in the plotter itself.</span>
<span class="sd">        Just type::</span>

<span class="sd">            &gt;&gt;&gt; list(plotter)</span>

<span class="sd">        to get the formatoptions.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _format_keys&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">base_fmtos</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="n">Formatoption</span><span class="p">),</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s2">&quot;_get_formatoptions&quot;</span><span class="p">,</span> <span class="n">empty</span><span class="p">)(</span><span class="kc">False</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>

        <span class="n">fmtos</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">attr</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Formatoption</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">include_bases</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fmtos</span>
        <span class="k">return</span> <span class="n">unique_everseen</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">fmtos</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">base_fmtos</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)))</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_types</span><span class="p">(</span>
        <span class="s2">&quot;check_key.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;``\*args,\*\*kwargs``&quot;</span>
    <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter._enhance_keys&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_enhance_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enhance the given keys by groups</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys: list of str or None</span>
<span class="sd">            If None, the all formatoptions of the given class are used. Group</span>
<span class="sd">            names from the :attr:`psyplot.plotter.groups` mapping are replaced</span>
<span class="sd">            by the formatoptions</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(check_key.parameters.kwargs)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of str</span>
<span class="sd">            The enhanced list of the formatoptions&quot;&quot;&quot;</span>
        <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">keys</span> <span class="ow">or</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_keys</span><span class="p">))</span>
        <span class="n">fmto_groups</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
            <span class="n">fmto_groups</span><span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">new_i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">[:]):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fmto_groups</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">keys</span><span class="p">[</span><span class="n">new_i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key2</span> <span class="ow">in</span> <span class="n">fmto_groups</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">key2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="n">keys</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">new_i</span><span class="p">,</span> <span class="n">key2</span><span class="p">)</span>
                        <span class="n">new_i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">valid</span><span class="p">,</span> <span class="n">similar</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">check_key</span><span class="p">(</span>
                    <span class="n">key</span><span class="p">,</span>
                    <span class="n">all_keys</span><span class="p">,</span>
                    <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;formatoption keyword&quot;</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid</span><span class="p">:</span>
                    <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">new_i</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">new_i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">keys</span>

<div class="viewcode-block" id="Plotter.show_keys">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.show_keys">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span>
        <span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter.show_keys&quot;</span><span class="p">,</span>
        <span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Returns&quot;</span><span class="p">,</span> <span class="s2">&quot;Other Parameters&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">show_keys</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">include_links</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classmethod to return a nice looking table with the given formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter._enhance_keys.parameters)s</span>
<span class="sd">        indent: int</span>
<span class="sd">            The indentation of the table</span>
<span class="sd">        grouped: bool, optional</span>
<span class="sd">            If True, the formatoptions are grouped corresponding to the</span>
<span class="sd">            :attr:`Formatoption.groupname` attribute</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        func: function or None</span>
<span class="sd">            The function the is used for returning (by default it is printed</span>
<span class="sd">            via the :func:`print` function or (when using the gui) in the</span>
<span class="sd">            help explorer). The given function must take a string as argument</span>
<span class="sd">        include_links: bool or None, optional</span>
<span class="sd">            Default False. If True, links (in restructured formats) are</span>
<span class="sd">            included in the description. If None, the behaviour is determined</span>
<span class="sd">            by the :attr:`psyplot.plotter.Plotter.include_links` attribute.</span>
<span class="sd">        %(Plotter._enhance_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        results of `func`</span>
<span class="sd">            None if `func` is the print function, otherwise anything else</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        show_summaries, show_docs&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">titled_group</span><span class="p">(</span><span class="n">groupname</span><span class="p">):</span>
            <span class="n">bars</span> <span class="o">=</span> <span class="n">str_indent</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupname</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">bars</span> <span class="o">+</span> <span class="n">str_indent</span> <span class="o">+</span> <span class="n">groupname</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">bars</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_enhance_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">str_indent</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">func</span> <span class="ow">or</span> <span class="n">default_print_func</span>
        <span class="c1"># call this function recursively when grouped is True</span>
        <span class="k">if</span> <span class="n">grouped</span><span class="p">:</span>
            <span class="n">grouped_keys</span> <span class="o">=</span> <span class="n">Defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="n">keys</span><span class="p">):</span>
                <span class="n">grouped_keys</span><span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">groupname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">grouped_keys</span><span class="p">):</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">titled_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                    <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">show_keys</span><span class="p">(</span>
                        <span class="n">keys</span><span class="p">,</span>
                        <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span>
                        <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">func</span><span class="o">=</span><span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">,</span>
                        <span class="n">include_links</span><span class="o">=</span><span class="n">include_links</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>  <span class="c1"># number of columns</span>
        <span class="c1"># The number of cells in the table is one of the following cases:</span>
        <span class="c1">#     1. The number of columns and equal to the number of keys</span>
        <span class="c1">#     2. The number of keys</span>
        <span class="c1">#     3. The number of keys plus the empty cells in the last column</span>
        <span class="n">ncells</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="p">((</span><span class="n">ncols</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">ncols</span><span class="p">))</span> <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">ncols</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_links</span> <span class="ow">or</span> <span class="p">(</span><span class="n">include_links</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">include_links</span><span class="p">):</span>
            <span class="n">long_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="s2">&quot;:attr:`~</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">`&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span>
                    <span class="n">keys</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">long_keys</span> <span class="o">=</span> <span class="n">keys</span>
        <span class="n">maxn</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">long_keys</span><span class="p">))</span>  <span class="c1"># maximal lenght of the keys</span>
        <span class="c1"># extend with empty cells</span>
        <span class="n">long_keys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">maxn</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">ncells</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">bars</span> <span class="o">=</span> <span class="p">(</span><span class="n">str_indent</span> <span class="o">+</span> <span class="s2">&quot;+-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">maxn</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;-+-&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;| </span><span class="si">%s</span><span class="s2"> |</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">key</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">maxn</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">long_keys</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">bars</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">bars</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">str_indent</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">str_indent</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">PY2</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>


    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">_show_doc</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">fmt_func</span><span class="p">,</span>
        <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">include_links</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classmethod to print the formatoptions and their documentation</span>

<span class="sd">        This function is the basis for the :meth:`show_summaries` and</span>
<span class="sd">        :meth:`show_docs` methods</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmt_func: function</span>
<span class="sd">            A function that takes the key, the key as it is printed, and the</span>
<span class="sd">            documentation of a formatoption as argument and returns what shall</span>
<span class="sd">            be printed</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        show_summaries, show_docs&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">titled_group</span><span class="p">(</span><span class="n">groupname</span><span class="p">):</span>
            <span class="n">bars</span> <span class="o">=</span> <span class="n">str_indent</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupname</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">bars</span> <span class="o">+</span> <span class="n">str_indent</span> <span class="o">+</span> <span class="n">groupname</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">bars</span>

        <span class="n">func</span> <span class="o">=</span> <span class="n">func</span> <span class="ow">or</span> <span class="n">default_print_func</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_enhance_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">str_indent</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span>
        <span class="k">if</span> <span class="n">grouped</span><span class="p">:</span>
            <span class="n">grouped_keys</span> <span class="o">=</span> <span class="n">Defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span> <span class="n">keys</span><span class="p">):</span>
                <span class="n">grouped_keys</span><span class="p">[</span><span class="n">fmto</span><span class="o">.</span><span class="n">groupname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">titled_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_show_doc</span><span class="p">(</span>
                    <span class="n">fmt_func</span><span class="p">,</span>
                    <span class="n">keys</span><span class="p">,</span>
                    <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span>
                    <span class="n">grouped</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">func</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="n">include_links</span><span class="o">=</span><span class="n">include_links</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">grouped_keys</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">include_links</span> <span class="ow">or</span> <span class="p">(</span><span class="n">include_links</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">include_links</span><span class="p">):</span>
            <span class="n">long_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="s2">&quot;:attr:`~</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">`&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">),</span>
                    <span class="n">keys</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">long_keys</span> <span class="o">=</span> <span class="n">keys</span>

        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">str_indent</span>
            <span class="o">+</span> <span class="n">long_key</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="n">fmt_func</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">long_key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">long_key</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">long_keys</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.show_summaries">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.show_summaries">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">show_summaries</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classmethod to print the summaries of the formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        show_keys, show_docs&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">find_summary</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_txt</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">doc</span><span class="p">[:</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)]))</span>

        <span class="n">str_indent</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span>
        <span class="n">wrapper</span> <span class="o">=</span> <span class="n">TextWrapper</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
            <span class="n">initial_indent</span><span class="o">=</span><span class="n">str_indent</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
            <span class="n">subsequent_indent</span><span class="o">=</span><span class="n">str_indent</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_show_doc</span><span class="p">(</span>
            <span class="n">find_summary</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.show_docs">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.show_docs">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">show_docs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classmethod to print the full documentations of the formatoptions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter.show_keys.parameters)s</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(Plotter.show_keys.other_parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Plotter.show_keys.returns)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        show_keys, show_docs&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">full_doc</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_txt</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_txt</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">doc</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_show_doc</span><span class="p">(</span>
            <span class="n">full_doc</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_rc_strings</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursive method to get the base strings in the rcParams dictionary.</span>

<span class="sd">        This method takes the :attr:`_rcparams_string` attribute from the given</span>
<span class="sd">        `class` and combines it with the :attr:`_rcparams_string` attributes</span>
<span class="sd">        from the base classes.</span>
<span class="sd">        The returned frozenset can be used as base strings for the</span>
<span class="sd">        :meth:`psyplot.config.rcsetup.RcParams.find_and_replace` method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The first entry is the :attr:`_rcparams_string` of this class,</span>
<span class="sd">            the following the :attr:`_rcparams_string` attributes of the</span>
<span class="sd">            base classes according to the method resolution order of this</span>
<span class="sd">            class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">unique_everseen</span><span class="p">(</span>
                <span class="n">chain</span><span class="p">(</span>
                    <span class="o">*</span><span class="nb">map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">base</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s2">&quot;_rcparams_string&quot;</span><span class="p">,</span> <span class="p">[]),</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_rc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to set the rcparams and defaultParams for this plotter&quot;&quot;&quot;</span>
        <span class="n">base_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_rc_strings</span><span class="p">()</span>
        <span class="c1"># to make sure that the &#39;.&#39; is not interpreted as a regex pattern,</span>
        <span class="c1"># we specify the pattern_base by ourselves</span>
        <span class="n">pattern_base</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\.&quot;</span><span class="p">),</span> <span class="n">base_str</span><span class="p">)</span>
        <span class="c1"># pattern for valid keys being all formatoptions in this plotter</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)(?=$)&quot;</span> <span class="o">%</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatoptions</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rc</span> <span class="o">=</span> <span class="n">rcParams</span><span class="o">.</span><span class="n">find_and_replace</span><span class="p">(</span>
            <span class="n">base_str</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span> <span class="n">pattern_base</span><span class="o">=</span><span class="n">pattern_base</span>
        <span class="p">)</span>
        <span class="n">user_rc</span> <span class="o">=</span> <span class="n">SubDict</span><span class="p">(</span>
            <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;plotter.user&quot;</span><span class="p">],</span>
            <span class="n">base_str</span><span class="p">,</span>
            <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
            <span class="n">pattern_base</span><span class="o">=</span><span class="n">pattern_base</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rc</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">user_rc</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultParams</span> <span class="o">=</span> <span class="n">SubDict</span><span class="p">(</span>
            <span class="n">rcParams</span><span class="o">.</span><span class="n">defaultParams</span><span class="p">,</span>
            <span class="n">base_str</span><span class="p">,</span>
            <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
            <span class="n">pattern_base</span><span class="o">=</span><span class="n">pattern_base</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">docstrings</span><span class="o">.</span><span class="n">keep_params</span><span class="p">(</span><span class="s2">&quot;InteractiveBase.update.parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;auto_update&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.update">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.update">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter.update&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">replot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">auto_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">todefault</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the formatoptions and the plot</span>

<span class="sd">        If the :attr:`data` attribute of this plotter is None, the plotter is</span>
<span class="sd">        updated like a usual dictionary (see :meth:`dict.update`). Otherwise</span>
<span class="sd">        the update is registered and the plot is updated if `auto_update` is</span>
<span class="sd">        True or if the :meth:`start_update` method is called (see below).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Plotter._register_update.parameters)s</span>
<span class="sd">        %(InteractiveBase.start_update.parameters)s</span>
<span class="sd">        %(InteractiveBase.update.parameters.auto_update)s</span>
<span class="sd">        ``**kwargs``</span>
<span class="sd">            Any other formatoption that shall be updated (additionally to those</span>
<span class="sd">            in `fmt`)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        %(InteractiveBase.update.notes)s&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># if the data is None, update like a usual dictionary (but with</span>
        <span class="c1"># validation)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">fmt</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_register_update</span><span class="p">(</span>
            <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">replot</span><span class="o">=</span><span class="n">replot</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span> <span class="n">todefault</span><span class="o">=</span><span class="n">todefault</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span> <span class="ow">or</span> <span class="n">auto_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_update</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_set_sharing_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the keys to share or unshare</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys: string or iterable of strings</span>
<span class="sd">            The iterable may contain formatoptions that shall be shared (or</span>
<span class="sd">            unshared), or group names of formatoptions to share all</span>
<span class="sd">            formatoptions of that group (see the :attr:`fmt_groups` property).</span>
<span class="sd">            If None, all formatoptions of this plotter are inserted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        set</span>
<span class="sd">            The set of formatoptions to share (or unshare)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">{</span><span class="n">keys</span><span class="p">}</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">keys</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">fmto_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmto_groups</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">chain</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span>
                    <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">fmto</span><span class="p">:</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">fmto_groups</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">fmto_groups</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">fmto_groups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">keys</span>

<div class="viewcode-block" id="Plotter.share">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.share">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter.share&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotters</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Share the formatoptions of this plotter with others</span>

<span class="sd">        This method shares the formatoptions of this :class:`Plotter` instance</span>
<span class="sd">        with others to make sure that, if the formatoption of this changes,</span>
<span class="sd">        those of the others change as well</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plotters: list of :class:`Plotter` instances or a :class:`Plotter`</span>
<span class="sd">            The plotters to share the formatoptions with</span>
<span class="sd">        keys: string or iterable of strings</span>
<span class="sd">            The formatoptions to share, or group names of formatoptions to</span>
<span class="sd">            share all formatoptions of that group (see the</span>
<span class="sd">            :attr:`fmt_groups` property). If None, all formatoptions of this</span>
<span class="sd">            plotter are unshared.</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        %(InteractiveBase.update.parameters.auto_update)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        unshare, unshare_me&quot;&quot;&quot;</span>
        <span class="n">auto_update</span> <span class="o">=</span> <span class="n">auto_update</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotters</span><span class="p">,</span> <span class="n">Plotter</span><span class="p">):</span>
            <span class="n">plotters</span> <span class="o">=</span> <span class="p">[</span><span class="n">plotters</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_sharing_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">plotters</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">fmto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">fmto</span><span class="p">:</span>
                    <span class="n">plotter</span><span class="o">.</span><span class="n">_shared</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                    <span class="n">fmto</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
        <span class="c1"># now exit if we are not initialized</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="n">auto_update</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">plotters</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">plotter</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">old_registered</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="n">auto_update</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">_registered_updates</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">old_registered</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_draw&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">draw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;auto_show&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Plotter.unshare">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.unshare">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">unshare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotters</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the sharing connection of this plotter with others</span>

<span class="sd">        This method undoes the sharing connections made by the :meth:`share`</span>
<span class="sd">        method and releases the given `plotters` again, such that the</span>
<span class="sd">        formatoptions in this plotter may be updated again to values different</span>
<span class="sd">        from this one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plotters: list of :class:`Plotter` instances or a :class:`Plotter`</span>
<span class="sd">            The plotters to release</span>
<span class="sd">        keys: string or iterable of strings</span>
<span class="sd">            The formatoptions to unshare, or group names of formatoptions to</span>
<span class="sd">            unshare all formatoptions of that group (see the</span>
<span class="sd">            :attr:`fmt_groups` property). If None, all formatoptions of this</span>
<span class="sd">            plotter are unshared.</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        %(InteractiveBase.update.parameters.auto_update)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        share, unshare_me&quot;&quot;&quot;</span>
        <span class="n">auto_update</span> <span class="o">=</span> <span class="n">auto_update</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotters</span><span class="p">,</span> <span class="n">Plotter</span><span class="p">):</span>
            <span class="n">plotters</span> <span class="o">=</span> <span class="p">[</span><span class="n">plotters</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_sharing_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">plotters</span><span class="p">:</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">unshare_me</span><span class="p">(</span>
                <span class="n">keys</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="n">auto_update</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">,</span> <span class="n">update_other</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="n">auto_update</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.unshare_me">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.unshare_me">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">get_sections</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="s2">&quot;Plotter.unshare_me&quot;</span><span class="p">)</span>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">unshare_me</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update_other</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the sharing connection of this plotter with others</span>

<span class="sd">        This method undoes the sharing connections made by the :meth:`share`</span>
<span class="sd">        method and release this plotter again.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keys: string or iterable of strings</span>
<span class="sd">            The formatoptions to unshare, or group names of formatoptions to</span>
<span class="sd">            unshare all formatoptions of that group (see the</span>
<span class="sd">            :attr:`fmt_groups` property). If None, all formatoptions of this</span>
<span class="sd">            plotter are unshared.</span>
<span class="sd">        %(InteractiveBase.start_update.parameters.draw)s</span>
<span class="sd">        %(InteractiveBase.update.parameters.auto_update)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        share, unshare&quot;&quot;&quot;</span>
        <span class="n">auto_update</span> <span class="o">=</span> <span class="n">auto_update</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_auto_update</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_sharing_keys</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">to_update</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other_fmto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_fmto</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fmto</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">update_other</span><span class="p">:</span>
                    <span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">_register_update</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="p">[</span><span class="n">other_fmto</span><span class="o">.</span><span class="n">key</span><span class="p">])</span>
                    <span class="n">to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_fmto</span><span class="o">.</span><span class="n">plotter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">,</span> <span class="n">auto_update</span><span class="o">=</span><span class="n">auto_update</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update_other</span> <span class="ow">and</span> <span class="n">auto_update</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="n">to_update</span><span class="p">:</span>
                <span class="n">plotter</span><span class="o">.</span><span class="n">start_update</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.get_vfunc">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.get_vfunc">[docs]</a>
    <span class="k">def</span> <span class="nf">get_vfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the validation function for a specified formatoption</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key: str</span>
<span class="sd">            Formatoption key in the :attr:`rc` dictionary</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        function</span>
<span class="sd">            Validation function for this formatoption&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaultParams</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span></div>


    <span class="k">def</span> <span class="nf">_save_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the current formatoptions&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="p">)</span>

<div class="viewcode-block" id="Plotter.show">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.show">[docs]</a>
    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shows all open figures&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotter.has_changed">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.has_changed">[docs]</a>
    <span class="nd">@dedent</span>
    <span class="k">def</span> <span class="nf">has_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">include_last</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine whether a formatoption changed in the last update</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key: str</span>
<span class="sd">            A formatoption key contained in this plotter</span>
<span class="sd">        include_last: bool</span>
<span class="sd">            if True and the formatoption has been included in the last update,</span>
<span class="sd">            the return value will not be None. Otherwise the return value will</span>
<span class="sd">            only be not None if it changed during the last update</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None or list</span>
<span class="sd">            - None, if the value has not been changed during the last update or</span>
<span class="sd">              `key` is not a valid formatoption key</span>
<span class="sd">            - a list of length two with the old value in the first place and</span>
<span class="sd">              the given `value` at the second&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initializing</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">fmto</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">old_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_fmt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">old_val</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">old_val</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">include_last</span> <span class="ow">and</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_update</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">old_val</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">value</span><span class="p">]</span></div>


<div class="viewcode-block" id="Plotter.get_enhanced_attrs">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.get_enhanced_attrs">[docs]</a>
    <span class="k">def</span> <span class="nf">get_enhanced_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
            <span class="n">all_attrs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">starmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_enhanced_attrs</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="n">axes</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">val</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">all_attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
                    <span class="n">key</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span>
                    <span class="k">for</span> <span class="n">attrs</span> <span class="ow">in</span> <span class="n">all_attrs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">base_variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_variables</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_variables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># multiple variables</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">base_var</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">base_variables</span><span class="p">):</span>
                    <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
                            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">base_var</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">base_var</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">base_variables</span><span class="p">))</span>
            <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">name</span>
            <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="p">{})):</span>
                <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_time</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">):</span>
                <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base</span>
            <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="n">base_var</span><span class="p">,</span> <span class="n">arr</span><span class="p">]:</span>
                    <span class="n">decoder</span> <span class="o">=</span> <span class="n">CFDecoder</span><span class="o">.</span><span class="n">get_decoder</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">decoder</span><span class="p">,</span> <span class="s2">&quot;get_&quot;</span> <span class="o">+</span> <span class="n">dim</span><span class="p">)(</span>
                        <span class="n">obj</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="s2">&quot;coords&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">coord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_time</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">attrs</span><span class="p">[</span><span class="n">dim</span> <span class="o">+</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="p">):</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="n">dim</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enhanced_attrs</span> <span class="o">=</span> <span class="n">attrs</span>
        <span class="k">return</span> <span class="n">attrs</span></div>


    <span class="k">def</span> <span class="nf">_make_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">plot_fmtos</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmto</span> <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fmtos</span> <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">plot_fmt</span><span class="p">]</span>
        <span class="n">plot_fmtos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">fmto</span><span class="p">:</span> <span class="n">fmto</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fmto</span> <span class="ow">in</span> <span class="n">plot_fmtos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Making plot with </span><span class="si">%s</span><span class="s2"> formatoption&quot;</span><span class="p">,</span> <span class="n">fmto</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="n">fmto</span><span class="o">.</span><span class="n">make_plot</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_sample_projection</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns None. May be subclassed to return a projection that</span>
<span class="sd">        can be used when creating a subplot&quot;&quot;&quot;</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="Plotter.convert_coordinate">
<a class="viewcode-back" href="../../api/psyplot.plotter.html#psyplot.plotter.Plotter.convert_coordinate">[docs]</a>
    <span class="nd">@docstrings</span><span class="o">.</span><span class="n">dedent</span>
    <span class="k">def</span> <span class="nf">convert_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="o">*</span><span class="n">variables</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a coordinate to units necessary for the plot.</span>

<span class="sd">        %(Formatoption.convert_coordinate.summary_ext)s</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        %(Formatoption.convert_coordinate.parameters)s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %(Formatoption.convert_coordinate.returns)s</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method is supposed to be implemented by subclasses. The default</span>
<span class="sd">        implementation by the :class:`Plotter` class does nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">coord</span></div>
</div>

</pre></div>

           </div>
          </div>
          <!--
SPDX-FileCopyrightText: 2021-2024 Helmholtz-Zentrum hereon GmbH

SPDX-License-Identifier: CC-BY-4.0
-->

<footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024 Helmholtz-Zentrum hereon GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  

<div class="footer">
    <span class="creativecommons">
    <a href="https://creativecommons.org/licenses/by/4.0/" >
    <img style="height: 1.5em;" src="../../_static/license_logo.png" border="0" alt="Creative Commons License"/>
    </a>
    This documentation is licensed under
    <a href="https://creativecommons.org/licenses/by/4.0/">
    CC-BY-4.0
    </a>
    </span>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>