<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to implement your own plotters and plugins &mdash; psyplot 1.4.1+1.g5e62dfc documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/psyplot.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing to psyplot" href="../contribute.html" />
    <link rel="prev" title="The psyplot framework" href="framework.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> psyplot
            <img src="../_static/psyplot.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.4.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About psyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://psyplot.github.io/examples/">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Subprojects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accessors.html">xarray Accessors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Psyplot plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_line.html">Command line usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developers guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="framework.html">The psyplot framework</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to implement your own plotters and plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-plotters">Creating plotters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#interface-for-the-plotter">Interface for the plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interface-to-the-data">Interface to the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interfacing-to-other-formatoptions">Interfacing to other formatoptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#creating-new-plugins">Creating new plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rcparams-handling-in-plugins"><code class="docutils literal notranslate"><span class="pre">rcParams</span></code> handling in plugins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing to psyplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/psyplot.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todos.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">psyplot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Developers guide</a> &raquo;</li>
      <li>How to implement your own plotters and plugins</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/develop/plugins_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-implement-your-own-plotters-and-plugins">
<span id="plugins-guide"></span><h1>How to implement your own plotters and plugins<a class="headerlink" href="#how-to-implement-your-own-plotters-and-plugins" title="Permalink to this headline"></a></h1>
<p>New plotters and plugins to the psyplot framework are highly welcomed. In this
guide, we present <a class="reference internal" href="#new-plotters"><span class="std std-ref">how to create new plotters</span></a> and explain
to you how you can <a class="reference internal" href="#new-plugins"><span class="std std-ref">include them as a plugin in psyplot</span></a>.</p>
<section id="creating-plotters">
<span id="new-plotters"></span><h2>Creating plotters<a class="headerlink" href="#creating-plotters" title="Permalink to this headline"></a></h2>
<p>Implementing new plotters can be very easy or quite an effort depending on how
sophisticated you want to do it. In principle, you only have to implement the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update" title="psyplot.plotter.Formatoption.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Formatoption.update()</span></code></a> method and a default value. I.e., one simple
formatoption would be</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">psyplot.plotter</span> <span class="kn">import</span> <span class="n">Formatoption</span><span class="p">,</span> <span class="n">Plotter</span>

<span class="gp">In [2]: </span><span class="k">class</span> <span class="nc">MyFormatoption</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
<span class="gp">   ...: </span>    <span class="n">default</span> <span class="o">=</span> <span class="s1">&#39;my text&#39;</span>
<span class="gp">   ...: </span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">   ...: </span>        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<p>together with a plotter</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="k">class</span> <span class="nc">MyPlotter</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
<span class="gp">   ...: </span>    <span class="n">my_fmt</span> <span class="o">=</span> <span class="n">MyFormatoption</span><span class="p">(</span><span class="s1">&#39;my_fmt&#39;</span><span class="p">)</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<p>and your done. Now you can make a simple plot</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">psyplot</span> <span class="kn">import</span> <span class="n">open_dataset</span>

<span class="gp">In [5]: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;demo.nc&#39;</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">MyPlotter</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t2m</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/docs_demo_MyPlotter_simple.png"><img alt="../_images/docs_demo_MyPlotter_simple.png" src="../_images/docs_demo_MyPlotter_simple.png" style="width: 4in;" /></a>
<p>However, if you’re using the psyplot framework, you probably will be a bit more
advanced so let’s talk about attributes and methods of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption" title="psyplot.plotter.Formatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption</span></code></a>
class.</p>
<p>If you look into the documentation of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption" title="psyplot.plotter.Formatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption</span></code></a> class, you find
quite a lot of attributes and methods which probably is a bit depressing and
confusing. But in principle, we can group them into 4 categories, the interface
to the data, to the plotter and to other formatoptions. Plus an additional
category for some Formatoption internals you definitely have to care about.</p>
<section id="interface-for-the-plotter">
<h3>Interface for the plotter<a class="headerlink" href="#interface-for-the-plotter" title="Permalink to this headline"></a></h3>
<p>The first interface is the one, that interfaces to the plotter. The most
important attributes in this group are the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.key" title="psyplot.plotter.Formatoption.key"><code class="xref py py-attr docutils literal notranslate"><span class="pre">key</span></code></a>,
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.priority" title="psyplot.plotter.Formatoption.priority"><code class="xref py py-attr docutils literal notranslate"><span class="pre">priority</span></code></a>, <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.plot_fmt" title="psyplot.plotter.Formatoption.plot_fmt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plot_fmt</span></code></a>,
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.initialize_plot" title="psyplot.plotter.Formatoption.initialize_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize_plot()</span></code></a> and most important the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update" title="psyplot.plotter.Formatoption.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> method.</p>
<p>The <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.key" title="psyplot.plotter.Formatoption.key"><code class="xref py py-attr docutils literal notranslate"><span class="pre">key</span></code></a> is the unique key for the formatoption inside the
plotter. In our example above, we assign the <code class="docutils literal notranslate"><span class="pre">'my_fmt'</span></code> key to the
<code class="docutils literal notranslate"><span class="pre">MyFormatoption</span></code> class in <code class="docutils literal notranslate"><span class="pre">MyPlotter</span></code>. Hence, this key is defined when the
plotter class is defined and will be automatically assigned to the formatoption.</p>
<p>The next important attribute is the <code class="xref py py-attr docutils literal notranslate"><span class="pre">priority</span></code> attribute. There are three
stages in the update of a plotter:</p>
<ol class="arabic simple">
<li><p>The stage with data manipulation. If formatoptions manipulate the data that
shall be visualized (the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.data" title="psyplot.plotter.Formatoption.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> attribute), those
formatoptions are updated first. They have the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.START" title="psyplot.plotter.START"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.plotter.START</span></code></a>
priority</p></li>
<li><p>The stage of the plot. Formatoptions that influence how the data is
visualized are updated here (e.g. the colormap or formatoptions that do the
plotting). They have the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.BEFOREPLOTTING" title="psyplot.plotter.BEFOREPLOTTING"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.plotter.BEFOREPLOTTING</span></code></a> priority.</p></li>
<li><p>The stage of the plot where additional informations are inserted. Here all
the labels are updated, e.g. the title, xlabel, etc.. This is the default
priority of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.priority" title="psyplot.plotter.Formatoption.priority"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption.priority</span></code></a> attribute, the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.END" title="psyplot.plotter.END"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.plotter.END</span></code></a> priority.</p></li>
</ol>
<p>If there is any formatoption updated within the first two groups, the plot of
the plotter is updated. This brings us to the third important attribute, the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.plot_fmt" title="psyplot.plotter.Formatoption.plot_fmt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plot_fmt</span></code></a>. This boolean tells the plotter, whether the
corresponding formatoption is assumed to make a plot at the end of the second
stage (the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.BEFOREPLOTTING" title="psyplot.plotter.BEFOREPLOTTING"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BEFOREPLOTTING</span></code></a> stage). If this attribute is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, then the plotter will call the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Formatoption.make_plot()</span></code> method
of the formatoption instance.</p>
<p>Finally, the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.initialize_plot" title="psyplot.plotter.Formatoption.initialize_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize_plot()</span></code></a> and
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update" title="psyplot.plotter.Formatoption.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> methods, this is were your contribution really is
required. The <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.initialize_plot" title="psyplot.plotter.Formatoption.initialize_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize_plot()</span></code></a> method is called when the
plot is created for the first time, the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update" title="psyplot.plotter.Formatoption.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> method
when it is updated (the default implementation of the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.initialize_plot" title="psyplot.plotter.Formatoption.initialize_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize_plot()</span></code></a> simply calls the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.update" title="psyplot.plotter.Formatoption.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> method). Implement these methods in your
formatoption and thereby make use of the interface to the
<a class="reference internal" href="#fmt-data-interface"><span class="std std-ref">data</span></a> and other
<a class="reference internal" href="#fmt-fmt-interface"><span class="std std-ref">formatoptions</span></a>.</p>
</section>
<section id="interface-to-the-data">
<span id="fmt-data-interface"></span><h3>Interface to the data<a class="headerlink" href="#interface-to-the-data" title="Permalink to this headline"></a></h3>
<p>The next set of attributes help you to interface to the data. There are two
important parts in this section the interface to the data and the
interpretation of the data.</p>
<p>The first part is mainly represented to the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.data" title="psyplot.plotter.Formatoption.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.data</span></code></a> and
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.raw_data" title="psyplot.plotter.Formatoption.raw_data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.raw_data</span></code></a> attributes. The plotter that contains the
formatoption often creates a copy of the data because the data for
the visualization might be modified (see for example the
<code class="xref py py-class docutils literal notranslate"><span class="pre">psy_reg.plotter.LinRegPlotter</span></code>). This modified data can be accessed
through the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.data" title="psyplot.plotter.Formatoption.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.data</span></code></a> and should be the standard approach to
access the data within a formatoption. Nevertheless, the original data can be
accessed through the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.raw_data" title="psyplot.plotter.Formatoption.raw_data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.raw_data</span></code></a> attribute. However, it only
makes sense to access this data for formatoption with <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.START" title="psyplot.plotter.START"><code class="xref py py-attr docutils literal notranslate"><span class="pre">START</span></code></a>
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.priority" title="psyplot.plotter.Formatoption.priority"><code class="xref py py-attr docutils literal notranslate"><span class="pre">priority</span></code></a>.</p>
<p>The result of these two attributes depend on the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.index_in_list" title="psyplot.plotter.Formatoption.index_in_list"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.index_in_list</span></code></a> attribute. The data objects in the psyplot
framework are either a <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v0.21.2.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> or a list of those in a
<a class="reference internal" href="../api/psyplot.data.html#psyplot.data.InteractiveList" title="psyplot.data.InteractiveList"><code class="xref py py-class docutils literal notranslate"><span class="pre">psyplot.data.InteractiveList</span></code></a>. If the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.index_in_list" title="psyplot.plotter.Formatoption.index_in_list"><code class="xref py py-attr docutils literal notranslate"><span class="pre">index_in_list</span></code></a> attribute is not None, and the data object
is an <a class="reference internal" href="../api/psyplot.data.html#psyplot.data.InteractiveList" title="psyplot.data.InteractiveList"><code class="xref py py-class docutils literal notranslate"><span class="pre">InteractiveList</span></code></a>, then only the array at the
specified position is returned. To completely avoid this issue, you might also
use the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.iter_data" title="psyplot.plotter.Formatoption.iter_data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_data</span></code></a> or <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.iter_raw_data" title="psyplot.plotter.Formatoption.iter_raw_data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iter_raw_data</span></code></a>
attributes.</p>
<p>The second part in this section is the interpretation of the data and here,
the formatoption can use the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.decoder" title="psyplot.plotter.Formatoption.decoder"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Formatoption.decoder</span></code></a> attribute. This
subclass of the <a class="reference internal" href="../api/psyplot.data.html#psyplot.data.CFDecoder" title="psyplot.data.CFDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">psyplot.data.CFDecoder</span></code></a> helps you to identify the
x- and y-variables in the data.</p>
</section>
<section id="interfacing-to-other-formatoptions">
<span id="fmt-fmt-interface"></span><h3>Interfacing to other formatoptions<a class="headerlink" href="#interfacing-to-other-formatoptions" title="Permalink to this headline"></a></h3>
<p>A formatoption is the lowest level in the psyplot framework. It is represented
at multiple levels:</p>
<ol class="arabic simple">
<li><p>at the lowest level through the subclass of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption" title="psyplot.plotter.Formatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption</span></code></a> class</p></li>
<li><p>at the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Plotter" title="psyplot.plotter.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a> class level which includes the formatoption class
as a descriptor (in our example above it’s <code class="docutils literal notranslate"><span class="pre">MyPlotter.my_fmt</span></code>)</p></li>
<li><p>at the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Plotter" title="psyplot.plotter.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a> instance level through</p>
<ol class="lowerroman simple">
<li><p>a personalized instance of the corresponding <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption" title="psyplot.plotter.Formatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption</span></code></a> class
(i.e. <code class="docutils literal notranslate"><span class="pre">plotter</span> <span class="pre">=</span> <span class="pre">MyPlotter();</span> <span class="pre">plotter.my_fmt</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">MyPlotter.my_fmt</span></code>)</p></li>
<li><p>an item in the plotter (i.e. <code class="docutils literal notranslate"><span class="pre">plotter</span> <span class="pre">=</span> <span class="pre">MyPlotter();</span> <span class="pre">plotter['my_fmt']</span></code>)</p></li>
</ol>
</li>
<li><p>In the update methods of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Plotter" title="psyplot.plotter.Plotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plotter</span></code></a>,
<a class="reference internal" href="../api/psyplot.data.html#psyplot.data.InteractiveBase" title="psyplot.data.InteractiveBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">psyplot.data.InteractiveBase</span></code></a> and <a class="reference internal" href="../api/psyplot.data.html#psyplot.data.ArrayList" title="psyplot.data.ArrayList"><code class="xref py py-class docutils literal notranslate"><span class="pre">psyplot.data.ArrayList</span></code></a>
as a keyword (i.e.
<code class="docutils literal notranslate"><span class="pre">plotter</span> <span class="pre">=</span> <span class="pre">MyPlotter();</span> <span class="pre">plotter.update(my_fmt='new</span> <span class="pre">value')</span></code>)</p></li>
</ol>
<p>Hence, there is one big to the entire framework, that is: the functionality
of a new formatoption has to be completely defined through exactly one argument,
i.e. it must be possible to assign a value to the formatoption in the plotter.</p>
<p>For complex formatoption, this might indeed be quite a challenge for the
developer and there are two solutions to it:</p>
<ol class="arabic simple">
<li><p>The simple solution for the developer: Allow a dictionary as a formatoption,
here we also have the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption" title="psyplot.plotter.DictFormatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">psyplot.plotter.DictFormatoption</span></code></a> to help you.</p></li>
<li><p>Interface to other formatoptions</p></li>
</ol>
<section id="first-solution-use-a-dict">
<h4>First solution: Use a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><a class="headerlink" href="#first-solution-use-a-dict" title="Permalink to this headline"></a></h4>
<p>That said, to implement a formatoption that inserts a custom text and let the
user define the size of the text, you either create a formatoption that accepts
a text via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomText</span><span class="p">(</span><span class="n">DictFormatoption</span><span class="p">):</span>

    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>

    <span class="n">text</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">initialize_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">],</span>
                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">MyPlotter</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>

    <span class="n">my_fmt</span> <span class="o">=</span> <span class="n">CustomText</span><span class="p">(</span><span class="s1">&#39;my_fmt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and then you could create and update a plotter via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MyPlotter</span><span class="p">(</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([]))</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmt</span><span class="o">=</span><span class="s1">&#39;my text&#39;</span><span class="p">)</span>  <span class="c1"># updates the text</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>  <span class="c1"># updates the size</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;Something&#39;</span><span class="p">})</span>  <span class="c1"># updates text and size</span>
</pre></div>
</div>
<p>This solution has the several advantages:</p>
<ul class="simple">
<li><p>The user does not get confused through too many formatoptions</p></li>
<li><p>It is easy to allow more keywords for this formatoption</p></li>
</ul>
<p>Indeed, the <code class="xref py py-class docutils literal notranslate"><span class="pre">psy_simple.plotter.Legend</span></code> formatoption uses this framework
since the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="(in Matplotlib v3.5.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.legend()</span></code></a> function accepts that many keywords
that it would be not informative to create a formatoption for each of them.</p>
<p>Otherwise you could of course avoid the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption" title="psyplot.plotter.DictFormatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictFormatoption</span></code></a> and just
force the user to always provide a new dictionary.</p>
</section>
<section id="second-solution-interact-with-other-formatoptions">
<h4>Second solution: Interact with other formatoptions<a class="headerlink" href="#second-solution-interact-with-other-formatoptions" title="Permalink to this headline"></a></h4>
<p>Another possibility is to implement a second formatoption for the size of the
text. And here, the psyplot framework helps you with several attributes of the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption" title="psyplot.plotter.Formatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatoption</span></code></a> class:</p>
<dl class="simple">
<dt>the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.children" title="psyplot.plotter.Formatoption.children"><code class="xref py py-attr docutils literal notranslate"><span class="pre">children</span></code></a> attribute</dt><dd><p>Forces the listed formatoptions in this list to be updated before the
current formatoption is updated</p>
</dd>
<dt>the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.dependencies" title="psyplot.plotter.Formatoption.dependencies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dependencies</span></code></a> attributes</dt><dd><p>Same as <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.children" title="psyplot.plotter.Formatoption.children"><code class="xref py py-attr docutils literal notranslate"><span class="pre">children</span></code></a> but also forces an update if one
of the named formatoptions are updated</p>
</dd>
<dt>the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.parents" title="psyplot.plotter.Formatoption.parents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parents</span></code></a> attribute</dt><dd><p>Skip the update if one of the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.parents" title="psyplot.plotter.Formatoption.parents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parents</span></code></a> is updated</p>
</dd>
<dt>the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.connections" title="psyplot.plotter.Formatoption.connections"><code class="xref py py-attr docutils literal notranslate"><span class="pre">connections</span></code></a> attribute</dt><dd><p>just provides connections to the listed formatoptions</p>
</dd>
</dl>
<p>Each of those attributes accept a list of strings that represent the
formatoption keys of other formatoptions. Those formatoptions are then
accessible within the formatoption via the usual <a class="reference external" href="https://docs.python.org/3/library/functions.html#getattr" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a>. I.e. if you
list a formatoption in the <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.children" title="psyplot.plotter.Formatoption.children"><code class="xref py py-attr docutils literal notranslate"><span class="pre">children</span></code></a> attribute, you can
access it inside the formatoption (<code class="docutils literal notranslate"><span class="pre">self</span></code>) via <code class="docutils literal notranslate"><span class="pre">self.other_formatoption</span></code>.</p>
<p>In our example of the <code class="docutils literal notranslate"><span class="pre">CustomText</span></code>, this could be implemented via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomTextSize</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the fontsize of the custom text</span>

<span class="sd">    Possible types</span>
<span class="sd">    --------------</span>
<span class="sd">    int</span>
<span class="sd">        The fontsize of the text</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">default</span> <span class="o">=</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># this text has not to be updated if the custom text is updated</span>
    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CustomText</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Place a text</span>

<span class="sd">    Possible types</span>
<span class="sd">    --------------</span>
<span class="sd">    str</span>
<span class="sd">        The text to display&quot;&quot;&quot;</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">initialize_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MyPlotter</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>

    <span class="n">my_fmt</span> <span class="o">=</span> <span class="n">CustomText</span><span class="p">(</span><span class="s1">&#39;my_fmt&#39;</span><span class="p">)</span>
    <span class="n">my_fmtsize</span> <span class="o">=</span> <span class="n">CustomTextSize</span><span class="p">(</span><span class="s1">&#39;my_fmtsize&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;my_fmt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>the update in that sense would be like</p>
<p>and then you could create and update a plotter via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MyPlotter</span><span class="p">(</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([]))</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmt</span><span class="o">=</span><span class="s1">&#39;my text&#39;</span><span class="p">)</span>  <span class="c1"># updates the text</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmtsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># updates the size</span>
<span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">my_fmt</span><span class="o">=</span><span class="s1">&#39;Something&#39;</span><span class="p">,</span> <span class="n">my_fmtsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># updates text and size</span>
</pre></div>
</div>
<p>The advantages of this methodology are basically:</p>
<ul>
<li><p>The user straight away sees two formatoptions that can be interpreted
easiliy</p></li>
<li><p>The formatoption that controls the font size could easily be subclassed and
replaced in a subclass of <code class="docutils literal notranslate"><span class="pre">MyPlotter</span></code>. In the first framework using the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.DictFormatoption" title="psyplot.plotter.DictFormatoption"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictFormatoption</span></code></a>, this would mean that the entire process has to be
rewritten.</p>
<p>As you see in the above definition
<code class="docutils literal notranslate"><span class="pre">my_fmtsize</span> <span class="pre">=</span> <span class="pre">CustomTextSize('my_fmtsize',</span> <span class="pre">text='my_fmt')</span></code>, we provide an
additional <code class="docutils literal notranslate"><span class="pre">text</span></code> keyword. That is because we explicitly named the
<code class="docutils literal notranslate"><span class="pre">text</span></code> key in the <code class="docutils literal notranslate"><span class="pre">children</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">CustomTextSize</span></code>
formatoption. In that way we can tell the <code class="docutils literal notranslate"><span class="pre">my_fmtsize</span></code> formatoption how to
find the necessary formatoption. That works for all keys listed in the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.children" title="psyplot.plotter.Formatoption.children"><code class="xref py py-attr docutils literal notranslate"><span class="pre">children</span></code></a>, <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.dependencies" title="psyplot.plotter.Formatoption.dependencies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dependencies</span></code></a>,
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.parents" title="psyplot.plotter.Formatoption.parents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parents</span></code></a> and <a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.connections" title="psyplot.plotter.Formatoption.connections"><code class="xref py py-attr docutils literal notranslate"><span class="pre">connections</span></code></a>
attributes.</p>
</li>
</ul>
</section>
</section>
</section>
<section id="creating-new-plugins">
<span id="new-plugins"></span><h2>Creating new plugins<a class="headerlink" href="#creating-new-plugins" title="Permalink to this headline"></a></h2>
<p>Now that you have created your plotter, you may want to include it in the
plot methods of the <a class="reference internal" href="../api/psyplot.project.html#psyplot.project.Project" title="psyplot.project.Project"><code class="xref py py-class docutils literal notranslate"><span class="pre">Project</span></code></a> class such that you can
do something like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psyplot.project</span> <span class="k">as</span> <span class="nn">psy</span>
<span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">my_plotter</span><span class="p">(</span><span class="s1">&#39;netcdf-file.nc&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;varname&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There are three possibilities how you can do this:</p>
<ol class="arabic simple">
<li><p>The easy and fast solution for one session: register the plotter using the
<a class="reference internal" href="../api/psyplot.project.html#psyplot.project.register_plotter" title="psyplot.project.register_plotter"><code class="xref py py-func docutils literal notranslate"><span class="pre">psyplot.project.register_plotter()</span></code></a> function</p></li>
<li><p>The easy and steady solution: Save the calls you used in step 1 in the
<code class="docutils literal notranslate"><span class="pre">'project.plotter.user'</span></code> key of the
<a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.rcParams" title="psyplot.config.rcsetup.rcParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rcParams</span></code></a></p></li>
<li><p>The steady and shareable solution: Create a new plugin</p></li>
</ol>
<p>The third solution has been used for the <a class="reference external" href="https://psyplot.github.io/psy-maps/">psy-maps</a> and <a class="reference external" href="https://psyplot.github.io/psy-simple/">psy-simple</a> plugins. To
create a skeleton for your plugin, you can use the <code class="docutils literal notranslate"><span class="pre">psyplot-plugin</span></code> command
that is installed when you install psyplot.</p>
<p>For our demonstration, let’s create a plugin named my-plugin. This is simply
done via</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="o">!</span>psyplot-plugin my-plugin

<span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">glob</span>

<span class="gp">In [9]: </span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;my-plugin/**&#39;</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">[&#39;my-plugin/&#39;,</span>
<span class="go"> &#39;my-plugin/README.md&#39;,</span>
<span class="go"> &#39;my-plugin/COPYING&#39;,</span>
<span class="go"> &#39;my-plugin/COPYING.LESSER&#39;,</span>
<span class="go"> &#39;my-plugin/setup.py&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/__init__.py&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/plugin.py&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/plotters.py&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/__pycache__&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/__pycache__/plugin.cpython-38.pyc&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/__pycache__/plotters.cpython-38.pyc&#39;,</span>
<span class="go"> &#39;my-plugin/my_plugin/__pycache__/__init__.cpython-38.pyc&#39;,</span>
<span class="go"> &#39;my-plugin/MANIFEST.in&#39;,</span>
<span class="go"> &#39;my-plugin/__pycache__&#39;,</span>
<span class="go"> &#39;my-plugin/__pycache__/setup.cpython-38.pyc&#39;]</span>
</pre></div>
</div>
<p>The following files are created in a directory named <code class="docutils literal notranslate"><span class="pre">'my-plugin'</span></code>:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'setup.py'</span></code></dt><dd><p>The installation script</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'my_plugin/plugin.py'</span></code></dt><dd><p>The file that sets up the configuration of our plugin. This file should
define the <code class="docutils literal notranslate"><span class="pre">rcParams</span></code> for the plugin (see also <a class="reference internal" href="#plugins-rcparams"><span class="std std-ref">rcParams handling in plugins</span></a>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'my_plugin/plotters.py'</span></code></dt><dd><p>The file in which we define the plotters. This file should define the
plotters and formatoptions.</p>
</dd>
</dl>
<p>If you want to see more, look into the comments in the created files.</p>
</section>
<section id="rcparams-handling-in-plugins">
<span id="plugins-rcparams"></span><h2><code class="docutils literal notranslate"><span class="pre">rcParams</span></code> handling in plugins<a class="headerlink" href="#rcparams-handling-in-plugins" title="Permalink to this headline"></a></h2>
<p>Every formatoption does have default values. In
<a class="reference internal" href="#new-plotters"><span class="std std-ref">our example above</span></a>, we simply set it via the
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.default" title="psyplot.plotter.Formatoption.default"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default</span></code></a> attribute. This is a hard-coded,
but easy, stable and quick solution.</p>
<p>However, your formatoption could also be used in different plotters, each
requiring a different default value. Or you want to give the user the
possibility to set his own default value. For this, we implemented the</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">psyplot.plotter.Plotter._rcparams_string</span></code></p></td>
<td><p>List of base strings in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.rcParams</span></code> dictionary</p></td>
</tr>
</tbody>
</table>
<p>attribute. Here you can specify a string for this plotter which is used to
get the default value of the formatoptions in this plotter from the
<a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.rcParams" title="psyplot.config.rcsetup.rcParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rcParams</span></code></a>. The expected
<a class="reference internal" href="../api/psyplot.plotter.html#psyplot.plotter.Formatoption.default_key" title="psyplot.plotter.Formatoption.default_key"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default_key</span></code></a> for one formatoption would
then be <code class="docutils literal notranslate"><span class="pre">the_chosen_string</span> <span class="pre">+</span> <span class="pre">fmt_key</span></code>.</p>
<p>The following example illustrates this:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="kn">from</span> <span class="nn">psyplot.config.rcsetup</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="gp">   ....: </span><span class="kn">from</span> <span class="nn">psyplot.plotter</span> <span class="kn">import</span> <span class="n">Plotter</span><span class="p">,</span> <span class="n">Formatoption</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>First we define our defaultParams, a mapping from default key to the
default value, a validation function, and a description (see the
<a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.defaultParams" title="psyplot.config.rcsetup.defaultParams"><code class="xref py py-data docutils literal notranslate"><span class="pre">psyplot.config.rcsetup.defaultParams</span></code></a> dictionary).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">defaultParams</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s1">&#39;plotter.example_plotter.fmt1&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   ....: </span>        <span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">val</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="s1">&#39;Example formatoption&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="p">}</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>Then we update the <a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.RcParams.defaultParams" title="psyplot.config.rcsetup.RcParams.defaultParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">defaultParams</span></code></a> of
the <a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.rcParams" title="psyplot.config.rcsetup.rcParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.rcParams</span></code></a> and set the
value</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">rcParams</span><span class="o">.</span><span class="n">defaultParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">defaultParams</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">rcParams</span><span class="o">.</span><span class="n">update_from_defaultParams</span><span class="p">(</span><span class="n">defaultParams</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="nb">print</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;plotter.example_plotter.fmt1&#39;</span><span class="p">])</span>
<span class="gp">   ....: </span>
<span class="go">1</span>
</pre></div>
</div>
<p>Now we define a formatoption for our new plotter class and implement it in a
new plotter object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="k">class</span> <span class="nc">ExampleFmt</span><span class="p">(</span><span class="n">Formatoption</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">   ....: </span>        <span class="k">pass</span>
<span class="gp">   ....: </span>

<span class="gp">In [15]: </span><span class="k">class</span> <span class="nc">ExamplePlotter</span><span class="p">(</span><span class="n">Plotter</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="c1"># we use our base string, &#39;plotter.example_plotter.&#39;</span>
<span class="gp">   ....: </span>    <span class="n">_rcparams_string</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;plotter.example_plotter.&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="c1"># and register a formatoption for the plotter</span>
<span class="gp">   ....: </span>    <span class="n">fmt1</span> <span class="o">=</span> <span class="n">ExampleFmt</span><span class="p">(</span><span class="s1">&#39;fmt1&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>If we now create a new instance of this <code class="docutils literal notranslate"><span class="pre">ExamplePlotter</span></code>, the <code class="docutils literal notranslate"><span class="pre">fmt1</span></code>
formatoption will have a value of <code class="docutils literal notranslate"><span class="pre">1</span></code>, as we defined it in the above
<code class="docutils literal notranslate"><span class="pre">defaultParams</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">ExamplePlotter</span><span class="p">()</span>

<span class="gp">In [17]: </span><span class="nb">print</span><span class="p">(</span><span class="n">plotter</span><span class="p">[</span><span class="s1">&#39;fmt1&#39;</span><span class="p">])</span>
<span class="go">1</span>

<span class="go"># and the default_key is our string in the defaultParams, a combination</span>
<span class="go"># of the _rcparams_string and the formatoption key</span>
<span class="gp">In [18]: </span><span class="nb">print</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">fmt1</span><span class="o">.</span><span class="n">default_key</span><span class="p">)</span>
<span class="go">plotter.example_plotter.fmt1</span>

<span class="gp">In [19]: </span><span class="nb">print</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">fmt1</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Changing the value in the <a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.rcParams" title="psyplot.config.rcsetup.rcParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rcParams</span></code></a>, also
changes the default value for the plotter</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;plotter.example_plotter.fmt1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="gp">In [21]: </span><span class="nb">print</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">fmt1</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Also, if we subclass this plotter, the default_key will not change</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="k">class</span> <span class="nc">SecondPlotter</span><span class="p">(</span><span class="n">ExamplePlotter</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="c1"># we set a new _rcparams_string</span>
<span class="gp">   ....: </span>    <span class="n">_rcparams_string</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;plotter.another_plotter.&#39;</span><span class="p">]</span>
<span class="gp">   ....: </span>

<span class="gp">In [23]: </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">SecondPlotter</span><span class="p">()</span>

<span class="go"># still the same key, although we defined a different _rcparams_string</span>
<span class="gp">In [24]: </span><span class="nb">print</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">fmt1</span><span class="o">.</span><span class="n">default_key</span><span class="p">)</span>
<span class="go">plotter.example_plotter.fmt1</span>
</pre></div>
</div>
<p>If you’re developing a new plugin you would then have to define the
<code class="docutils literal notranslate"><span class="pre">rcParams</span></code> and <code class="docutils literal notranslate"><span class="pre">defaultParams</span></code> in the <code class="docutils literal notranslate"><span class="pre">plugin.py</span></code> script (see
<a class="reference internal" href="#new-plugins"><span class="std std-ref">Creating new plugins</span></a>) and they will then be automatically implemented in
<a class="reference internal" href="../api/psyplot.config.rcsetup.html#psyplot.config.rcsetup.rcParams" title="psyplot.config.rcsetup.rcParams"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psyplot.rcParams</span></code></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="framework.html" class="btn btn-neutral float-left" title="The psyplot framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../contribute.html" class="btn btn-neutral float-right" title="Contributing to psyplot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 Helmholtz-Zentrum Hereon, 2020-2021 Helmholtz-Zentrum Geesthacht, 2016-2021 University of Lausanne.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>